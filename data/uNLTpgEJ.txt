"""
WOTD percentage thingy
by KKosty4ka
version 1

Idea 100% stolen from Bzuki
"""

from colour import Color
import re

# ratings go here
ratings = """â”† ğŸ‘  55  / ğŸ‘  136 â”†
â”† ğŸ‘  46  / ğŸ‘  30  â”†
â”† ğŸ‘  49  / ğŸ‘  27  â”†
â”† ğŸ‘  29  / ğŸ‘  25  â”†
â”† ğŸ‘  29  / ğŸ‘  35  â”†
â”† ğŸ‘  24  / ğŸ‘  32  â”†
â”† ğŸ‘  21  / ğŸ‘  30  â”†
â”† ğŸ‘  24  / ğŸ‘  32  â”†
â”† ğŸ‘  32  / ğŸ‘  27  â”†
â”† ğŸ‘  40  / ğŸ‘  23  â”†
â”† ğŸ‘  11  / ğŸ‘  11  â”†
â”† ğŸ‘  8   / ğŸ‘  5   â”†"""


# utils
def get_suffix(num: int) -> str:
    num = str(num)

    if num.endswith("1"): return "st"
    elif num.endswith("2"): return "nd"
    elif num.endswith("3"): return "rd"

    return "th"


# get the like/dislike ratios
ratios = []
matches = re.finditer(r"^â”† ğŸ‘  (\d+?) +?\/ ğŸ‘  (\d+?) +?â”†$", ratings, re.MULTILINE | re.UNICODE)

for match in matches:
    likes = int(match.group(1) )
    dislikes = int(match.group(2) )

    ratios.append(likes / (likes + dislikes) * 100)


# prepare the color gradient
red = Color("red")
green = Color("green")
colors = list(green.range_to(red, len(ratios) ) )


# generate the output
top = sorted(ratios, reverse=True)
print("How close is your world is to being nominated:")

for i in ratios:
    top_pos = top.index(i)
    hexcolor = colors[top_pos].hex_l[1::]

    print(f"\x1bF{hexcolor}{top_pos + 1}{get_suffix(top_pos)} ({round(i, 2)}%)")

print(f"Average: {round(sum(ratios) / len(ratios), 2)}%")