[deckhouse] root@f5365cd164aa / # dhctl bootstrap --ssh-user=cpicb --ssh-host=cpicb-t-k8s-m01.ahml1.ru --ssh-agent-private-keys=/tmp/ansible --config=/config.yml
ssh-add: Identity added: /tmp/ansible (ansible_msdp_key)

========================================================================================
 _____             _     _                                ______                _ _____
(____ \           | |   | |                              / _____)              | (_____)
 _   \ \ ____ ____| |  _| | _   ___  _   _  ___  ____   | /      ____ ____   _ | |  _
| |   | / _  ) ___) | / ) || \ / _ \| | | |/___)/ _  )  | |     / _  |  _ \ / || | | |
| |__/ ( (/ ( (___| |< (| | | | |_| | |_| |___ ( (/ /   | \____( ( | | | | ( (_| |_| |_
|_____/ \____)____)_| \_)_| |_|\___/ \____(___/ \____)   \______)_||_|_| |_|\____(_____)
========================================================================================
â”Œ â›µ ~ Bootstrap: Cluster UUID
â”‚ Generated cluster UUID: 46e41c1e-b1c6-4e9b-a5af-ad5e21997213
â”” â›µ ~ Bootstrap: Cluster UUID (0.00 seconds)

â”Œ â›µ ~ Bootstrap: Wait for SSH on Master become Ready
â”‚ â”Œ Connection string
â”‚ â”‚ ssh cpicb@cpicb-t-k8s-m01.ahml1.ru
â”‚ â”” Connection string (0.00 seconds)
â”‚ 
â”‚ â”Œ Waiting for SSH connection
â”‚ â”‚ Try to connect to cpicb-t-k8s-m01.ahml1.ru host
â”‚ â”‚ ğŸ‰ Succeeded!
â”‚ â”” Waiting for SSH connection (0.46 seconds)
â”” â›µ ~ Bootstrap: Wait for SSH on Master become Ready (1.46 seconds)

â”Œ â›µ ~ Bootstrap: Detect Bashible Bundle
â”‚ Detected bundle: debian
â”” â›µ ~ Bootstrap: Detect Bashible Bundle (0.44 seconds)

â”Œ â›µ ~ Bootstrap: Rendered templates directory
â”‚ /tmp/candi-bundle-263483295
â”” â›µ ~ Bootstrap: Rendered templates directory (0.00 seconds)

â”Œ â›µ ~ Bootstrap: Initial bootstrap
â”‚ â”Œ Render bootstrap templates
â”‚ â”‚ From "/deckhouse/candi/bashible/bundles/debian" to "/bootstrap"
â”‚ â”‚ From "/deckhouse/candi/cloud-providers/bashible/bundles/debian" to "/bootstrap"
â”‚ â”‚ Templates directory "/deckhouse/candi/cloud-providers/bashible/bundles/debian" does not exist. Skipping...
â”‚ â”‚ From "/deckhouse/candi/cloud-providers/bashible/common-steps" to "/bootstrap"
â”‚ â”‚ Templates directory "/deckhouse/candi/cloud-providers/bashible/common-steps" does not exist. Skipping...
â”‚ â”” Render bootstrap templates (0.00 seconds)
â”‚ 
â”‚ â”Œ bootstrap.sh
â”‚ â”‚ Ign:1 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64 InRelease
â”‚ â”‚ Hit:2 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64 InRelease
â”‚ â”‚ Hit:3 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-base 1.7_x86-64 InRelease
â”‚ â”‚ Hit:4 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-extended 1.7_x86-64 InRelease
â”‚ â”‚ Hit:5 https://l-repo-dom.ahml1.ru/repository/pbis-deb pbiso InRelease
â”‚ â”‚ Get:6 https://l-repo-dom.ahml1.ru/repository/zabbix-60-debian10 buster InRelease [7096 B]
â”‚ â”‚ Hit:7 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64 Release
â”‚ â”‚ Get:9 https://l-repo-dom.ahml1.ru/repository/zabbix-60-debian10 buster/main amd64 Packages [5106 B]
â”‚ â”‚ Fetched 12.2 kB in 1s (9657 B/s)    
â”‚ â”‚ Reading package lists... Done
â”‚ â”‚ Building dependency tree       
â”‚ â”‚ Reading state information... Done
â”‚ â”‚ 1 package can be upgraded. Run 'apt list --upgradable' to see it.
â”‚ â”‚ Reading package lists... Done
â”‚ â”‚ Building dependency tree       
â”‚ â”‚ Reading state information... Done
â”‚ â”‚ curl is already the newest version (7.64.0-4+deb10u2+astra1).
â”‚ â”‚ The following additional packages will be installed:
â”‚ â”‚   libjq1 libonig5
â”‚ â”‚ The following NEW packages will be installed:
â”‚ â”‚   jq libjq1 libonig5 netcat-openbsd
â”‚ â”‚ 0 upgraded, 4 newly installed, 0 to remove and 1 not upgraded.
â”‚ â”‚ Need to get 394 kB of archives.
â”‚ â”‚ After this operation, 1178 kB of additional disk space will be used.
â”‚ â”‚ Get:1 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64/main amd64 libonig5 amd64 6.9.1-1 [171 kB]
â”‚ â”‚ Get:2 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64/main amd64 libjq1 amd64 1.5+dfsg-2 [124 kB]
â”‚ â”‚ Get:3 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64/main amd64 jq amd64 1.5+dfsg-2 [58.6 kB]
â”‚ â”‚ Get:4 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-base 1.7_x86-64/main amd64 netcat-openbsd amd64 1.195-2 [40.9 kB]
â”‚ â”‚ Fetched 394 kB in 0s (869 kB/s)           
â”‚ â”‚ Selecting previously unselected package libonig5:amd64.
â”‚ â”‚ (Reading database ... 108361 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack .../libonig5_6.9.1-1_amd64.deb ...
â”‚ â”‚ Unpacking libonig5:amd64 (6.9.1-1) ...
â”‚ â”‚ Selecting previously unselected package libjq1:amd64.
â”‚ â”‚ Preparing to unpack .../libjq1_1.5+dfsg-2_amd64.deb ...
â”‚ â”‚ Unpacking libjq1:amd64 (1.5+dfsg-2) ...
â”‚ â”‚ Selecting previously unselected package jq.
â”‚ â”‚ Preparing to unpack .../jq_1.5+dfsg-2_amd64.deb ...
â”‚ â”‚ Unpacking jq (1.5+dfsg-2) ...
â”‚ â”‚ Selecting previously unselected package netcat-openbsd.
â”‚ â”‚ Preparing to unpack .../netcat-openbsd_1.195-2_amd64.deb ...
â”‚ â”‚ Unpacking netcat-openbsd (1.195-2) ...
â”‚ â”‚ Setting up netcat-openbsd (1.195-2) ...
â”‚ â”‚ update-alternatives: using /bin/nc.openbsd to provide /bin/nc (nc) in auto mode
â”‚ â”‚ Setting up libonig5:amd64 (6.9.1-1) ...
â”‚ â”‚ Setting up libjq1:amd64 (1.5+dfsg-2) ...
â”‚ â”‚ Setting up jq (1.5+dfsg-2) ...
â”‚ â”‚ Processing triggers for man-db (2.8.5-2) ...
â”‚ â”‚ Processing triggers for libc-bin (2.28-10+deb10u1+ci202207192202+astra4) ...
â”‚ â”” bootstrap.sh (4.32 seconds)
â”‚ 
â”‚ â”Œ bootstrap-networks.sh
â”‚ â”‚ Script /tmp/candi-bundle-263483295/bootstrap/bootstrap-networks.sh doesn't found
â”‚ â”” bootstrap-networks.sh (0.00 seconds)
â”” â›µ ~ Bootstrap: Initial bootstrap (4.33 seconds)

â”Œ â›µ ~ Bootstrap: Check Bashible
â”‚ Bashible is not ready! Let's try to install it ...
â”‚       Reason: bash: /var/lib/bashible/bashible.sh: No such file or directory
â”” â›µ ~ Bootstrap: Check Bashible (0.26 seconds)

â”Œ â›µ ~ Bootstrap: Prepare Bashible Bundle
â”‚ â”Œ kubeadm data
â”‚ â”‚ bashible: <hidden>
â”‚ â”‚ clusterConfiguration:
â”‚ â”‚   apiVersion: deckhouse.io/v1
â”‚ â”‚   clusterDomain: cluster.local
â”‚ â”‚   clusterType: Static
â”‚ â”‚   defaultCRI: Containerd
â”‚ â”‚   kind: ClusterConfiguration
â”‚ â”‚   kubernetesVersion: "1.24"
â”‚ â”‚   podSubnetCIDR: 192.168.0.0/16
â”‚ â”‚   podSubnetNodeCIDRPrefix: "24"
â”‚ â”‚   serviceSubnetCIDR: 10.96.0.0/16
â”‚ â”‚ extraArgs: {}
â”‚ â”‚ images: <hidden>
â”‚ â”‚ k8s: <hidden>
â”‚ â”‚ nodeIP: $MY_IP
â”‚ â”‚ registry:
â”‚ â”‚   address: nexus.ahml.ru:5010
â”‚ â”‚   auth: 
â”‚ â”‚   ca: ""
â”‚ â”‚   dockerCfg: 
â”‚ â”‚   path: /deckhouse/ce
â”‚ â”‚   scheme: http
â”‚ â”‚ runType: ClusterBootstrap
â”‚ â”” kubeadm data (0.00 seconds)
â”‚ 
â”‚ â”Œ bashible data
â”‚ â”‚ bashible: <hidden>
â”‚ â”‚ bundle: debian
â”‚ â”‚ clusterBootstrap:
â”‚ â”‚   clusterDNSAddress: 10.96.0.10
â”‚ â”‚   clusterDomain: cluster.local
â”‚ â”‚ cri: Containerd
â”‚ â”‚ images: <hidden>
â”‚ â”‚ k8s: <hidden>
â”‚ â”‚ kubernetesVersion: "1.24"
â”‚ â”‚ nodeGroup:
â”‚ â”‚   cloudInstances:
â”‚ â”‚     classReference:
â”‚ â”‚       name: master
â”‚ â”‚   name: master
â”‚ â”‚   nodeType: Static
â”‚ â”‚   static:
â”‚ â”‚     internalNetworkCIDRs:
â”‚ â”‚     - 10.208.14.0/24
â”‚ â”‚     - 10.209.14.0/24
â”‚ â”‚     - 10.80.142.0/24
â”‚ â”‚ packagesProxy: {}
â”‚ â”‚ registry:
â”‚ â”‚   address: nexus.ahml.ru:5010
â”‚ â”‚   auth: 
â”‚ â”‚   ca: ""
â”‚ â”‚   dockerCfg: 
â”‚ â”‚   path: /deckhouse/ce
â”‚ â”‚   scheme: http
â”‚ â”‚ runType: ClusterBootstrap
â”‚ â”” bashible data (0.00 seconds)
â”‚ 
â”‚ â”Œ Render bashible bundle templates
â”‚ â”‚ From "/deckhouse/candi/bashible" to "/var/lib/bashible"
â”‚ â”‚ From "/deckhouse/candi/bashible/common-steps/all" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ From "/deckhouse/candi/bashible/common-steps/cluster-bootstrap" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ From "/deckhouse/candi/bashible/common-steps/node-group" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ From "/deckhouse/candi/bashible/bundles/debian/all" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ From "/deckhouse/candi/bashible/bundles/debian/cluster-bootstrap" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ From "/deckhouse/candi/bashible/bundles/debian/node-group" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ From "/deckhouse/candi/cloud-providers/bashible/common-steps/all" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ Templates directory "/deckhouse/candi/cloud-providers/bashible/common-steps/all" does not exist. Skipping...
â”‚ â”‚ From "/deckhouse/candi/cloud-providers/bashible/common-steps/cluster-bootstrap" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ Templates directory "/deckhouse/candi/cloud-providers/bashible/common-steps/cluster-bootstrap" does not exist. Skipping...
â”‚ â”‚ From "/deckhouse/candi/cloud-providers/bashible/common-steps/node-group" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ Templates directory "/deckhouse/candi/cloud-providers/bashible/common-steps/node-group" does not exist. Skipping...
â”‚ â”‚ From "/deckhouse/candi/cloud-providers/bashible/bundles/debian/all" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ Templates directory "/deckhouse/candi/cloud-providers/bashible/bundles/debian/all" does not exist. Skipping...
â”‚ â”‚ From "/deckhouse/candi/cloud-providers/bashible/bundles/debian/cluster-bootstrap" to "/var/lib/bashible/bundle_steps"
â”‚ â”‚ Templates directory "/deckhouse/candi/cloud-providers/bashible/bundles/debian/cluster-bootstrap" does not exist. Skipping...
â”‚ â”‚ Create "/tmp/candi-bundle-263483295/var/lib/bashible/first_run"
â”‚ â”‚ Create "/tmp/candi-bundle-263483295/var/lib/bashible/kubernetes_data_device_path"
â”‚ â”‚ From "/deckhouse/candi/control-plane-kubeadm" to "/var/lib/bashible/kubeadm"
â”‚ â”‚ From "/deckhouse/candi/control-plane-kubeadm/patches" to "/var/lib/bashible/kubeadm/patches"
â”‚ â”‚ From "/deckhouse/candi/bashible/bashbooster" to "/var/lib/bashible"
â”‚ â”” Render bashible bundle templates (0.07 seconds)
â”” â›µ ~ Bootstrap: Prepare Bashible Bundle (0.08 seconds)

â”Œ â›µ ~ Bootstrap: Execute Bashible Bundle
â”‚ â”Œ Run step 000_add_apt_proxy_conf.sh
â”‚ â”” Run step 000_add_apt_proxy_conf.sh (0.04 seconds)
â”‚ 
â”‚ â”Œ Run step 000_install_ca_certificates.sh
â”‚ â”‚ bb-apt [INFO] Updating apt cache
â”‚ â”‚ Ign:1 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64 InRelease
â”‚ â”‚ Hit:2 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64 InRelease
â”‚ â”‚ Hit:3 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-base 1.7_x86-64 InRelease
â”‚ â”‚ Hit:4 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-extended 1.7_x86-64 InRelease
â”‚ â”‚ Hit:5 https://l-repo-dom.ahml1.ru/repository/pbis-deb pbiso InRelease
â”‚ â”‚ Hit:6 https://l-repo-dom.ahml1.ru/repository/zabbix-60-debian10 buster InRelease
â”‚ â”‚ Hit:7 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64 Release
â”‚ â”‚ Reading package lists... Done
â”‚ â”‚ bb-apt [INFO] Installing packages 'ca-certificates'
â”‚ â”‚ Reading package lists... Done
â”‚ â”‚ Building dependency tree       
â”‚ â”‚ Reading state information... Done
â”‚ â”‚ ca-certificates is already the newest version (20220331+astra3).
â”‚ â”‚ ca-certificates set to manually installed.
â”‚ â”‚ 0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
â”‚ â”‚ ca-certificates set on hold.
â”‚ â”‚ Clearing symlinks in /etc/ssl/certs...
â”‚ â”‚ done.
â”‚ â”‚ Updating certificates in /etc/ssl/certs...
â”‚ â”‚ 134 added, 0 removed; done.
â”‚ â”‚ Running hooks in /etc/ca-certificates/update.d...
â”‚ â”‚ done.
â”‚ â”” Run step 000_install_ca_certificates.sh (2.84 seconds)
â”‚ 
â”‚ â”Œ Run step 000_migrate_containerd_to_cgroupfs.sh
â”‚ â”” Run step 000_migrate_containerd_to_cgroupfs.sh (0.06 seconds)
â”‚ 
â”‚ â”Œ Run step 001_disable_rp_filter.sh
â”‚ â”” Run step 001_disable_rp_filter.sh (0.09 seconds)
â”‚ 
â”‚ â”Œ Run step 001_disable_swap.sh
â”‚ â”” Run step 001_disable_swap.sh (0.10 seconds)
â”‚ 
â”‚ â”Œ Run step 001_install_mandatory_packages.sh
â”‚ â”‚ bb-rp [INFO] Installing package 'virt-what'
â”‚ â”‚ Selecting previously unselected package virt-what.
â”‚ â”‚ (Reading database ... 108403 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack virt-what_amd64.deb ...
â”‚ â”‚ Unpacking virt-what (1.15-1+deb9u1) ...
â”‚ â”‚ Setting up virt-what (1.15-1+deb9u1) ...
â”‚ â”‚ Processing triggers for man-db (2.8.5-2) ...
â”‚ â”‚ virt-what set on hold.
â”‚ â”‚ bb-rp [INFO] Installing package 'conntrack'
â”‚ â”‚ Selecting previously unselected package conntrack.
â”‚ â”‚ (Reading database ... 108409 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack conntrack_amd64.deb ...
â”‚ â”‚ Unpacking conntrack (1:1.4.6-2) ...
â”‚ â”‚ Setting up conntrack (1:1.4.6-2) ...
â”‚ â”‚ Processing triggers for man-db (2.8.5-2) ...
â”‚ â”‚ conntrack set on hold.
â”‚ â”‚ bb-apt [INFO] Installing packages 'inotify-tools parted nfs-common socat ebtables'
â”‚ â”‚ Reading package lists... Done
â”‚ â”‚ Building dependency tree       
â”‚ â”‚ Reading state information... Done
â”‚ â”‚ The following packages were automatically installed and are no longer required:
â”‚ â”‚   exim4-config libgnutls-dane0 libip6tc2 libipc-signal-perl liblockfile-bin
â”‚ â”‚   liblockfile1 libmime-types-perl libproc-waitstat-perl libunbound8
â”‚ â”‚   lockfile-progs logtail mime-construct
â”‚ â”‚ Use 'sudo apt autoremove' to remove them.
â”‚ â”‚ The following additional packages will be installed:
â”‚ â”‚   keyutils libinotifytools0 libnfsidmap2 libparted2 libpython-stdlib
â”‚ â”‚   libpython2-stdlib libpython2.7-minimal libpython2.7-stdlib python
â”‚ â”‚   python-minimal python2 python2-minimal python2.7 python2.7-minimal rpcbind
â”‚ â”‚ Suggested packages:
â”‚ â”‚   libparted-dev libparted-i18n open-iscsi watchdog parted-doc python-doc
â”‚ â”‚   python-tk python2-doc python2.7-doc binutils binfmt-support
â”‚ â”‚ Recommended packages:
â”‚ â”‚   iptables
â”‚ â”‚ The following packages will be REMOVED:
â”‚ â”‚   exim4-base exim4-daemon-light iptables logcheck netbase telnet ufw
â”‚ â”‚ The following NEW packages will be installed:
â”‚ â”‚   ebtables inotify-tools keyutils libinotifytools0 libnfsidmap2 libparted2
â”‚ â”‚   libpython-stdlib libpython2-stdlib libpython2.7-minimal libpython2.7-stdlib
â”‚ â”‚   nfs-common parted python python-minimal python2 python2-minimal python2.7
â”‚ â”‚   python2.7-minimal rpcbind socat
â”‚ â”‚ 0 upgraded, 20 newly installed, 7 to remove and 2 not upgraded.
â”‚ â”‚ Need to get 5399 kB of archives.
â”‚ â”‚ After this operation, 13.2 MB of additional disk space will be used.
â”‚ â”‚ Get:1 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64/main amd64 libpython2.7-minimal amd64                       â†µ
â”‚ â”‚ 2.7.16-2+deb10u1+ci202206301820+astra2 [395 kB]
â”‚ â”‚ Get:2 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64/main amd64 python2.7-minimal amd64                          â†µ
â”‚ â”‚ 2.7.16-2+deb10u1+ci202206301820+astra2 [1304 kB]
â”‚ â”‚ Get:3 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 python2-minimal amd64 2.7.16-1 [41.3 kB]
â”‚ â”‚ Get:4 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 python-minimal amd64 2.7.16-1 [20.9 kB]
â”‚ â”‚ Get:5 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64/main amd64 libpython2.7-stdlib amd64                        â†µ
â”‚ â”‚ 2.7.16-2+deb10u1+ci202206301820+astra2 [1919 kB]
â”‚ â”‚ Get:6 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64/main amd64 python2.7 amd64                                  â†µ
â”‚ â”‚ 2.7.16-2+deb10u1+ci202206301820+astra2 [305 kB]
â”‚ â”‚ Get:7 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 libpython2-stdlib amd64 2.7.16-1 [20.8 kB]
â”‚ â”‚ Get:8 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 libpython-stdlib amd64 2.7.16-1 [20.8 kB]
â”‚ â”‚ Get:9 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 python2 amd64 2.7.16-1 [41.6 kB]
â”‚ â”‚ Get:10 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 python amd64 2.7.16-1 [22.9 kB]
â”‚ â”‚ Get:11 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 libnfsidmap2 amd64 0.25-5.1 [33.1 kB]
â”‚ â”‚ Get:12 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-update 1.7_x86-64/main amd64 ebtables amd64 2.0.10.4+snapshot20181205-3      â†µ
â”‚ â”‚ [86.3 kB]
â”‚ â”‚ Get:13 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 libinotifytools0 amd64 3.14-7 [18.8 kB]
â”‚ â”‚ Get:14 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 inotify-tools amd64 3.14-7 [25.2 kB]
â”‚ â”‚ Get:15 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 keyutils amd64 1.6-6 [51.0 kB]
â”‚ â”‚ Get:16 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 libparted2 amd64 3.2-25 [277 kB]
â”‚ â”‚ Get:17 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 rpcbind amd64 1.2.5-0.3+deb10u1 [46.5 kB]
â”‚ â”‚ Get:18 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 nfs-common amd64 1:1.3.4-2.5+deb10u1 [227 kB]
â”‚ â”‚ Get:19 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 parted amd64 3.2-25 [195 kB]
â”‚ â”‚ Get:20 https://l-repo-dom.ahml1.ru/repository/astraSE-1.7-main 1.7_x86-64/main amd64 socat amd64 1.7.3.2-2 [348 kB]
â”‚ â”‚ Fetched 5399 kB in 1s (7204 kB/s)
â”‚ â”‚ (Reading database ... 108414 files and directories currently installed.)
â”‚ â”‚ Removing logcheck (1.3.20) ...
â”‚ â”‚ Removing exim4-daemon-light (4.92-8+deb10u6.astra.se19) ...
â”‚ â”‚ Removing exim4-base (4.92-8+deb10u6.astra.se19) ...
â”‚ â”‚ Removing ufw (0.36-1.astra.se8) ...
â”‚ â”‚ Skip stopping firewall: ufw (not enabled)
â”‚ â”‚ Removing iptables (1.8.5-3~bpo10+1) ...
â”‚ â”‚ Removing telnet (0.17-41.2) ...
â”‚ â”‚ Removing netbase (6.1~bpo10+1) ...
â”‚ â”‚ Selecting previously unselected package libpython2.7-minimal:amd64.
â”‚ â”‚ (Reading database ... 107975 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack .../0-libpython2.7-minimal_2.7.16-2+deb10u1+ci202206301820+astra2_amd64.deb ...
â”‚ â”‚ Unpacking libpython2.7-minimal:amd64 (2.7.16-2+deb10u1+ci202206301820+astra2) ...
â”‚ â”‚ Selecting previously unselected package python2.7-minimal.
â”‚ â”‚ Preparing to unpack .../1-python2.7-minimal_2.7.16-2+deb10u1+ci202206301820+astra2_amd64.deb ...
â”‚ â”‚ Unpacking python2.7-minimal (2.7.16-2+deb10u1+ci202206301820+astra2) ...
â”‚ â”‚ Selecting previously unselected package python2-minimal.
â”‚ â”‚ Preparing to unpack .../2-python2-minimal_2.7.16-1_amd64.deb ...
â”‚ â”‚ Unpacking python2-minimal (2.7.16-1) ...
â”‚ â”‚ Selecting previously unselected package python-minimal.
â”‚ â”‚ Preparing to unpack .../3-python-minimal_2.7.16-1_amd64.deb ...
â”‚ â”‚ Unpacking python-minimal (2.7.16-1) ...
â”‚ â”‚ Selecting previously unselected package libpython2.7-stdlib:amd64.
â”‚ â”‚ Preparing to unpack .../4-libpython2.7-stdlib_2.7.16-2+deb10u1+ci202206301820+astra2_amd64.deb ...
â”‚ â”‚ Unpacking libpython2.7-stdlib:amd64 (2.7.16-2+deb10u1+ci202206301820+astra2) ...
â”‚ â”‚ Selecting previously unselected package python2.7.
â”‚ â”‚ Preparing to unpack .../5-python2.7_2.7.16-2+deb10u1+ci202206301820+astra2_amd64.deb ...
â”‚ â”‚ Unpacking python2.7 (2.7.16-2+deb10u1+ci202206301820+astra2) ...
â”‚ â”‚ Selecting previously unselected package libpython2-stdlib:amd64.
â”‚ â”‚ Preparing to unpack .../6-libpython2-stdlib_2.7.16-1_amd64.deb ...
â”‚ â”‚ Unpacking libpython2-stdlib:amd64 (2.7.16-1) ...
â”‚ â”‚ Selecting previously unselected package libpython-stdlib:amd64.
â”‚ â”‚ Preparing to unpack .../7-libpython-stdlib_2.7.16-1_amd64.deb ...
â”‚ â”‚ Unpacking libpython-stdlib:amd64 (2.7.16-1) ...
â”‚ â”‚ Setting up libpython2.7-minimal:amd64 (2.7.16-2+deb10u1+ci202206301820+astra2) ...
â”‚ â”‚ Setting up python2.7-minimal (2.7.16-2+deb10u1+ci202206301820+astra2) ...
â”‚ â”‚ Setting up python2-minimal (2.7.16-1) ...
â”‚ â”‚ Selecting previously unselected package python2.
â”‚ â”‚ (Reading database ... 108732 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack .../python2_2.7.16-1_amd64.deb ...
â”‚ â”‚ Unpacking python2 (2.7.16-1) ...
â”‚ â”‚ Setting up python-minimal (2.7.16-1) ...
â”‚ â”‚ Selecting previously unselected package python.
â”‚ â”‚ (Reading database ... 108762 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack .../00-python_2.7.16-1_amd64.deb ...
â”‚ â”‚ Unpacking python (2.7.16-1) ...
â”‚ â”‚ Selecting previously unselected package libnfsidmap2:amd64.
â”‚ â”‚ Preparing to unpack .../01-libnfsidmap2_0.25-5.1_amd64.deb ...
â”‚ â”‚ Unpacking libnfsidmap2:amd64 (0.25-5.1) ...
â”‚ â”‚ Selecting previously unselected package ebtables.
â”‚ â”‚ Preparing to unpack .../02-ebtables_2.0.10.4+snapshot20181205-3_amd64.deb ...
â”‚ â”‚ Unpacking ebtables (2.0.10.4+snapshot20181205-3) ...
â”‚ â”‚ Selecting previously unselected package libinotifytools0:amd64.
â”‚ â”‚ Preparing to unpack .../03-libinotifytools0_3.14-7_amd64.deb ...
â”‚ â”‚ Unpacking libinotifytools0:amd64 (3.14-7) ...
â”‚ â”‚ Selecting previously unselected package inotify-tools.
â”‚ â”‚ Preparing to unpack .../04-inotify-tools_3.14-7_amd64.deb ...
â”‚ â”‚ Unpacking inotify-tools (3.14-7) ...
â”‚ â”‚ Selecting previously unselected package keyutils.
â”‚ â”‚ Preparing to unpack .../05-keyutils_1.6-6_amd64.deb ...
â”‚ â”‚ Unpacking keyutils (1.6-6) ...
â”‚ â”‚ Selecting previously unselected package libparted2:amd64.
â”‚ â”‚ Preparing to unpack .../06-libparted2_3.2-25_amd64.deb ...
â”‚ â”‚ Unpacking libparted2:amd64 (3.2-25) ...
â”‚ â”‚ Selecting previously unselected package rpcbind.
â”‚ â”‚ Preparing to unpack .../07-rpcbind_1.2.5-0.3+deb10u1_amd64.deb ...
â”‚ â”‚ Unpacking rpcbind (1.2.5-0.3+deb10u1) ...
â”‚ â”‚ Selecting previously unselected package nfs-common.
â”‚ â”‚ Preparing to unpack .../08-nfs-common_1%3a1.3.4-2.5+deb10u1_amd64.deb ...
â”‚ â”‚ Unpacking nfs-common (1:1.3.4-2.5+deb10u1) ...
â”‚ â”‚ Selecting previously unselected package parted.
â”‚ â”‚ Preparing to unpack .../09-parted_3.2-25_amd64.deb ...
â”‚ â”‚ Unpacking parted (3.2-25) ...
â”‚ â”‚ Selecting previously unselected package socat.
â”‚ â”‚ Preparing to unpack .../10-socat_1.7.3.2-2_amd64.deb ...
â”‚ â”‚ Unpacking socat (1.7.3.2-2) ...
â”‚ â”‚ Setting up libinotifytools0:amd64 (3.14-7) ...
â”‚ â”‚ Setting up rpcbind (1.2.5-0.3+deb10u1) ...
â”‚ â”‚ Created symlink /etc/systemd/system/multi-user.target.wants/rpcbind.service -> /lib/systemd/system/rpcbind.service.
â”‚ â”‚ Created symlink /etc/systemd/system/sockets.target.wants/rpcbind.socket -> /lib/systemd/system/rpcbind.socket.
â”‚ â”‚ Setting up libpython2.7-stdlib:amd64 (2.7.16-2+deb10u1+ci202206301820+astra2) ...
â”‚ â”‚ Setting up ebtables (2.0.10.4+snapshot20181205-3) ...
â”‚ â”‚ Installing new version of config file /etc/ethertypes ...
â”‚ â”‚ update-alternatives: using /usr/sbin/ebtables-legacy to provide /usr/sbin/ebtables (ebtables) in auto mode
â”‚ â”‚ Setting up socat (1.7.3.2-2) ...
â”‚ â”‚ Setting up inotify-tools (3.14-7) ...
â”‚ â”‚ Setting up libparted2:amd64 (3.2-25) ...
â”‚ â”‚ Setting up keyutils (1.6-6) ...
â”‚ â”‚ Setting up libnfsidmap2:amd64 (0.25-5.1) ...
â”‚ â”‚ Setting up python2.7 (2.7.16-2+deb10u1+ci202206301820+astra2) ...
â”‚ â”‚ Setting up libpython2-stdlib:amd64 (2.7.16-1) ...
â”‚ â”‚ Setting up parted (3.2-25) ...
â”‚ â”‚ Setting up python2 (2.7.16-1) ...
â”‚ â”‚ Setting up nfs-common (1:1.3.4-2.5+deb10u1) ...
â”‚ â”‚ 
â”‚ â”‚ Creating config file /etc/idmapd.conf with new version
â”‚ â”‚ Adding system user `statd' (UID 111) ...
â”‚ â”‚ Adding new user `statd' (UID 111) with group `nogroup' ...
â”‚ â”‚ Not creating home directory `/var/lib/nfs'.
â”‚ â”‚ Created symlink /etc/systemd/system/multi-user.target.wants/nfs-client.target -> /lib/systemd/system/nfs-client.target.
â”‚ â”‚ Created symlink /etc/systemd/system/remote-fs.target.wants/nfs-client.target -> /lib/systemd/system/nfs-client.target.
â”‚ â”‚ nfs-utils.service is a disabled or a static unit, not starting it.
â”‚ â”‚ Setting up libpython-stdlib:amd64 (2.7.16-1) ...
â”‚ â”‚ Setting up python (2.7.16-1) ...
â”‚ â”‚ Processing triggers for libc-bin (2.28-10+deb10u1+ci202207192202+astra4) ...
â”‚ â”‚ Processing triggers for systemd (241-7~deb10u8astra.se28) ...
â”‚ â”‚ Processing triggers for man-db (2.8.5-2) ...
â”‚ â”‚ Processing triggers for mime-support (3.62) ...
â”‚ â”‚ inotify-tools set on hold.
â”‚ â”‚ parted set on hold.
â”‚ â”‚ nfs-common set on hold.
â”‚ â”‚ socat set on hold.
â”‚ â”‚ ebtables set on hold.
â”‚ â”‚ bb-rp [INFO] Installing package 'jq'
â”‚ â”‚ bb-rp [INFO] Installing package 'curl'
â”‚ â”” Run step 001_install_mandatory_packages.sh (54.28 seconds)
â”‚ 
â”‚ â”Œ Run step 001_install_mandatory_packages_for_cloud_nodes.sh
â”‚ â”” Run step 001_install_mandatory_packages_for_cloud_nodes.sh (0.05 seconds)
â”‚ 
â”‚ â”Œ Run step 001_iptables_legacy.sh
â”‚ â”” Run step 001_iptables_legacy.sh (0.05 seconds)
â”‚ 
â”‚ â”Œ Run step 001_set_short_hostname.sh
â”‚ â”” Run step 001_set_short_hostname.sh (0.16 seconds)
â”‚ 
â”‚ â”Œ Run step 002_integrate_kubernetes_data_device.sh
â”‚ â”” Run step 002_integrate_kubernetes_data_device.sh (0.07 seconds)
â”‚ 
â”‚ â”Œ Run step 002_load_mandatory_modules.sh
â”‚ â”” Run step 002_load_mandatory_modules.sh (0.10 seconds)
â”‚ 
â”‚ â”Œ Run step 003_discover_node_ip.sh
â”‚ â”” Run step 003_discover_node_ip.sh (0.06 seconds)
â”‚ 
â”‚ â”Œ Run step 004_resize_partitions.sh
â”‚ â”” Run step 004_resize_partitions.sh (0.05 seconds)
â”‚ 
â”‚ â”Œ Run step 010_disable_unattended_upgrades.sh
â”‚ â”” Run step 010_disable_unattended_upgrades.sh (0.08 seconds)
â”‚ 
â”‚ â”Œ Run step 011_disable_floppy_drive.sh
â”‚ â”” Run step 011_disable_floppy_drive.sh (0.06 seconds)
â”‚ 
â”‚ â”Œ Run step 012_security.sh
â”‚ â”‚ Removed /etc/systemd/system/sockets.target.wants/rpcbind.socket.
â”‚ â”” Run step 012_security.sh (0.53 seconds)
â”‚ 
â”‚ â”Œ Run step 030_dist_upgrade.sh
â”‚ â”” Run step 030_dist_upgrade.sh (0.05 seconds)
â”‚ 
â”‚ â”Œ Run step 031_install_containerd.sh
â”‚ â”‚ bb-rp [INFO] Installing package 'containerd-io'
â”‚ â”‚ Selecting previously unselected package containerd.io.
â”‚ â”‚ (Reading database ... 108989 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack containerd.io_amd64.deb ...
â”‚ â”‚ Unpacking containerd.io (1.5.11-1) ...
â”‚ â”‚ Setting up containerd.io (1.5.11-1) ...
â”‚ â”‚ Created symlink /etc/systemd/system/multi-user.target.wants/containerd.service -> /lib/systemd/system/containerd.service.
â”‚ â”‚ Processing triggers for man-db (2.8.5-2) ...
â”‚ â”‚ containerd.io set on hold.
â”‚ â”‚ bb-rp [INFO] Installing package 'crictl'
â”‚ â”‚ bb-rp [INFO] Installing package 'containerd-flant-edition'
â”‚ â”” Run step 031_install_containerd.sh (38.73 seconds)
â”‚ 
â”‚ â”Œ Run step 031_install_docker.sh
â”‚ â”” Run step 031_install_docker.sh (0.04 seconds)
â”‚ 
â”‚ â”Œ Run step 032_install_linux_kernel.sh
â”‚ â”‚ bb-apt [INFO] Removing packages 'linux-astra-modules-5.4.0-81-generic linux-headers-5.4-generic linux-headers-5.4.0-81                 â†µ
â”‚ â”‚ linux-headers-5.4.0-81-generic linux-image-5.4-generic linux-image-5.4.0-81-generic'
â”‚ â”‚ Reading package lists... Done
â”‚ â”‚ Building dependency tree       
â”‚ â”‚ Reading state information... Done
â”‚ â”‚ The following packages were automatically installed and are no longer required:
â”‚ â”‚   exim4-config libgnutls-dane0 libip6tc2 libipc-signal-perl liblockfile-bin
â”‚ â”‚   liblockfile1 libmime-types-perl libproc-waitstat-perl libunbound8
â”‚ â”‚   lockfile-progs logtail mime-construct
â”‚ â”‚ Use 'sudo apt autoremove' to remove them.
â”‚ â”‚ The following packages will be REMOVED:
â”‚ â”‚   linux-astra-modules-5.4.0-81-generic linux-headers-5.4-generic
â”‚ â”‚   linux-headers-5.4.0-81 linux-headers-5.4.0-81-generic
â”‚ â”‚   linux-image-5.4-generic linux-image-5.4.0-81-generic
â”‚ â”‚ 0 upgraded, 0 newly installed, 6 to remove and 2 not upgraded.
â”‚ â”‚ After this operation, 370 MB disk space will be freed.
â”‚ â”‚ (Reading database ... 109005 files and directories currently installed.)
â”‚ â”‚ Removing linux-astra-modules-5.4.0-81-generic (5.4.0-34.astra34+ci17) ...
â”‚ â”‚ update-initramfs: Generating /boot/initrd.img-5.4.0-81-generic
â”‚ â”‚ Removing linux-image-5.4-generic (5.4.0-54astra7+ci41) ...
â”‚ â”‚ Removing linux-headers-5.4-generic (5.4.0-54astra7+ci41) ...
â”‚ â”‚ Removing linux-headers-5.4.0-81-generic (5.4.0-81.astra34+ci17) ...
â”‚ â”‚ Removing linux-headers-5.4.0-81 (5.4.0-81.astra34+ci17) ...
â”‚ â”‚ Removing linux-image-5.4.0-81-generic (5.4.0-81.astra34+ci17) ...
â”‚ â”‚ I: /vmlinuz.old is now a symlink to boot/vmlinuz-5.4.0-110-generic
â”‚ â”‚ I: /initrd.img.old is now a symlink to boot/initrd.img-5.4.0-110-generic
â”‚ â”‚ /etc/kernel/postrm.d/initramfs-tools:
â”‚ â”‚ update-initramfs: Deleting /boot/initrd.img-5.4.0-81-generic
â”‚ â”‚ /etc/kernel/postrm.d/zz-update-grub:
â”‚ â”‚ Generating grub configuration file ...
â”‚ â”‚ Found linux image: /boot/vmlinuz-5.4.0-110-generic
â”‚ â”‚ Found initrd image: /boot/initrd.img-5.4.0-110-generic
â”‚ â”‚ done
â”‚ â”” Run step 032_install_linux_kernel.sh (26.05 seconds)
â”‚ 
â”‚ â”Œ Run step 034_install_kubelet_and_his_friends.sh
â”‚ â”‚ bb-rp [INFO] Installing package 'kubernetes-cni'
â”‚ â”‚ Selecting previously unselected package kubernetes-cni.
â”‚ â”‚ (Reading database ... 72688 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack kubernetes-cni_amd64.deb ...
â”‚ â”‚ Unpacking kubernetes-cni (0.8.7-00) ...
â”‚ â”‚ Setting up kubernetes-cni (0.8.7-00) ...
â”‚ â”‚ kubernetes-cni set on hold.
â”‚ â”‚ bb-rp [INFO] Installing package 'kubectl'
â”‚ â”‚ Selecting previously unselected package kubectl.
â”‚ â”‚ (Reading database ... 72706 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack kubectl_amd64.deb ...
â”‚ â”‚ Unpacking kubectl (1.24.3-00) ...
â”‚ â”‚ Setting up kubectl (1.24.3-00) ...
â”‚ â”‚ kubectl set on hold.
â”‚ â”‚ bb-rp [INFO] Installing package 'kubelet'
â”‚ â”‚ Selecting previously unselected package kubelet.
â”‚ â”‚ (Reading database ... 72707 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack kubelet_amd64.deb ...
â”‚ â”‚ Unpacking kubelet (1.24.3-00) ...
â”‚ â”‚ dpkg: dependency problems prevent configuration of kubelet:
â”‚ â”‚  kubelet depends on iptables (>= 1.4.21); however:
â”‚ â”‚   Package iptables is not installed.
â”‚ â”‚ 
â”‚ â”‚ dpkg: error processing package kubelet (--install):
â”‚ â”‚  dependency problems - leaving unconfigured
â”‚ â”‚ Errors were encountered while processing:
â”‚ â”‚  kubelet
â”‚ â”‚ Failed to execute step /var/lib/bashible/bundle_steps/034_install_kubelet_and_his_friends.sh ... retry in 10 seconds.
â”‚ â”” Run step 034_install_kubelet_and_his_friends.sh (53.74 seconds) FAILED
â”‚ 
â”‚ â”Œ Run step 034_install_kubelet_and_his_friends.sh, retry attempt #1 of 10
â”‚ â”‚ bb-rp [INFO] Installing package 'kubelet'
â”‚ â”‚ dpkg: version 1.24.3-00 of kubelet already installed, skipping
â”‚ â”‚ kubelet set on hold.
â”‚ â”” Run step 034_install_kubelet_and_his_friends.sh, retry attempt #1 of 10 (9.64 seconds)
â”‚ 
â”‚ â”Œ Run step 035_install_kubeadm.sh
â”‚ â”‚ bb-rp [INFO] Installing package 'kubeadm'
â”‚ â”‚ Selecting previously unselected package cri-tools.
â”‚ â”‚ (Reading database ... 72709 files and directories currently installed.)
â”‚ â”‚ Preparing to unpack cri-tools_amd64.deb ...
â”‚ â”‚ Unpacking cri-tools (1.24.2-00) ...
â”‚ â”‚ Selecting previously unselected package kubeadm.
â”‚ â”‚ Preparing to unpack kubeadm_amd64.deb ...
â”‚ â”‚ Unpacking kubeadm (1.24.3-00) ...
â”‚ â”‚ Setting up cri-tools (1.24.2-00) ...
â”‚ â”‚ dpkg: dependency problems prevent configuration of kubeadm:
â”‚ â”‚  kubeadm depends on kubelet (>= 1.19.0); however:
â”‚ â”‚   Package kubelet is not configured yet.
â”‚ â”‚ 
â”‚ â”‚ dpkg: error processing package kubeadm (--install):
â”‚ â”‚  dependency problems - leaving unconfigured
â”‚ â”‚ Errors were encountered while processing:
â”‚ â”‚  kubeadm
â”‚ â”‚ Failed to execute step /var/lib/bashible/bundle_steps/035_install_kubeadm.sh ... retry in 10 seconds.
â”‚ â”” Run step 035_install_kubeadm.sh (26.98 seconds) FAILED
â”‚ 
â”‚ â”Œ Run step 035_install_kubeadm.sh, retry attempt #1 of 10
â”‚ â”‚ bb-rp [INFO] Installing package 'kubeadm'
â”‚ â”‚ dpkg: version 1.24.2-00 of cri-tools already installed, skipping
â”‚ â”‚ dpkg: version 1.24.3-00 of kubeadm already installed, skipping
â”‚ â”‚ kubeadm set on hold.
â”‚ â”‚ cri-tools set on hold.
â”‚ â”” Run step 035_install_kubeadm.sh, retry attempt #1 of 10 (8.36 seconds)
â”‚ 
â”‚ â”Œ Run step 039_add_kubectl_completion.sh
â”‚ â”” Run step 039_add_kubectl_completion.sh (0.17 seconds)
â”‚ 
â”‚ â”Œ Run step 041_configure_sysctl_tuner.sh
â”‚ â”‚ Created symlink /etc/systemd/system/multi-user.target.wants/sysctl-tuner.timer -> /etc/systemd/system/sysctl-tuner.timer.
â”‚ â”” Run step 041_configure_sysctl_tuner.sh (1.00 seconds)
â”‚ 
â”‚ â”Œ Run step 042_configure_systemd_slices_cleaner.sh
â”‚ â”” Run step 042_configure_systemd_slices_cleaner.sh (0.06 seconds)
â”‚ 
â”‚ â”Œ Run step 043_configure_kubectl_passwordless_sudo_for_flant.sh
â”‚ â”” Run step 043_configure_kubectl_passwordless_sudo_for_flant.sh (0.07 seconds)
â”‚ 
â”‚ â”Œ Run step 050_configure_and_start_containerd.sh
â”‚ â”” Run step 050_configure_and_start_containerd.sh (0.33 seconds)
â”‚ 
â”‚ â”Œ Run step 050_configure_and_start_docker.sh
â”‚ â”” Run step 050_configure_and_start_docker.sh (0.05 seconds)
â”‚ 
â”‚ â”Œ Run step 050_reset_control_plane_on_configuration_change.sh
â”‚ â”” Run step 050_reset_control_plane_on_configuration_change.sh (0.05 seconds)
â”‚ 
â”‚ â”Œ Run step 051_pull_kubernetes_api_proxy.sh
â”‚ â”‚ Image is up to date for sha256:047a52f279bb249025aa8f4e3b1459cfc1be2d667a292af3833048b8a4a21d5b
â”‚ â”” Run step 051_pull_kubernetes_api_proxy.sh (20.97 seconds)
â”‚ 
â”‚ â”Œ Run step 052_configure_kubernetes_api_proxy.sh
â”‚ â”” Run step 052_configure_kubernetes_api_proxy.sh (0.08 seconds)
â”‚ 
â”‚ â”Œ Run step 060_bootstrap_kubernetes_pki.sh
â”‚ â”‚ W1115 15:46:17.426523   14502 initconfiguration.go:332] [config] WARNING: Ignored YAML document with GroupVersionKind                  â†µ
â”‚ â”‚ kubeadm.k8s.io/v1beta3, Kind=JoinConfiguration
â”‚ â”‚ [certs] Generating "ca" certificate and key
â”‚ â”” Run step 060_bootstrap_kubernetes_pki.sh (0.36 seconds)
â”‚ 
â”‚ â”Œ Run step 060_install_kubernetes_ca.sh
â”‚ â”” Run step 060_install_kubernetes_ca.sh (0.05 seconds)
â”‚ 
â”‚ â”Œ Run step 061_generate_bootstrap_kubeconfig_for_kubelet.sh
â”‚ â”” Run step 061_generate_bootstrap_kubeconfig_for_kubelet.sh (0.05 seconds)
â”‚ 
â”‚ â”Œ Run step 062_generate_kubeconfig_for_kubelet.sh
â”‚ â”‚ W1115 15:46:17.852998   14595 initconfiguration.go:332] [config] WARNING: Ignored YAML document with GroupVersionKind                  â†µ
â”‚ â”‚ kubeadm.k8s.io/v1beta3, Kind=JoinConfiguration
â”‚ â”‚ W1115 15:46:17.874278   14595 endpoint.go:57] [endpoint] WARNING: port specified in controlPlaneEndpoint overrides bindPort in the     â†µ
â”‚ â”‚ controlplane address
â”‚ â”‚ [kubeconfig] Writing "kubelet.conf" kubeconfig file
â”‚ â”” Run step 062_generate_kubeconfig_for_kubelet.sh (0.38 seconds)
â”‚ 
â”‚ â”Œ Run step 063_install_kubelet_forker.sh
â”‚ â”” Run step 063_install_kubelet_forker.sh (0.06 seconds)
â”‚ 
â”‚ â”Œ Run step 064_configure_kubelet.sh
â”‚ â”” Run step 064_configure_kubelet.sh (0.14 seconds)
â”‚ 
â”‚ â”Œ Run step 065_configure_kubelet_conf_to_api_proxy.sh
â”‚ â”” Run step 065_configure_kubelet_conf_to_api_proxy.sh (0.04 seconds)
â”‚ 
â”‚ â”Œ Run step 068_configure_kubelet_systemd_unit.sh
â”‚ â”‚ Created symlink /etc/systemd/system/multi-user.target.wants/kubelet.service -> /lib/systemd/system/kubelet.service.
â”‚ â”” Run step 068_configure_kubelet_systemd_unit.sh (0.82 seconds)
â”‚ 
â”‚ â”Œ Run step 069_start_kubelet.sh
â”‚ â”‚ bash [WARNING] 'kubelet-need-restart' flag was set. Kubelet should be restarted!
â”‚ â”‚ bash [INFO] Restart kubelet service...
â”‚ â”‚ bash [INFO] Kubelet service was restarted.
â”‚ â”” Run step 069_start_kubelet.sh (1.39 seconds)
â”‚ 
â”‚ â”Œ Run step 070_install_control_plane.sh
â”‚ â”‚ W1115 15:46:20.691992   15009 initconfiguration.go:332] [config] WARNING: Ignored YAML document with GroupVersionKind                  â†µ
â”‚ â”‚ kubeadm.k8s.io/v1beta3, Kind=JoinConfiguration
â”‚ â”‚ [certs] Using certificateDir folder "/etc/kubernetes/pki"
â”‚ â”‚ [certs] Using existing ca certificate authority
â”‚ â”‚ [certs] Generating "apiserver" certificate and key
â”‚ â”‚ [certs] apiserver serving cert is signed for DNS names [cpicb-t-k8s-m01 kubernetes kubernetes.default kubernetes.default.svc           â†µ
â”‚ â”‚ kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 10.208.14.30 127.0.0.1]
â”‚ â”‚ [certs] Generating "apiserver-kubelet-client" certificate and key
â”‚ â”‚ [certs] Generating "front-proxy-ca" certificate and key
â”‚ â”‚ [certs] Generating "front-proxy-client" certificate and key
â”‚ â”‚ [certs] Generating "etcd/ca" certificate and key
â”‚ â”‚ [certs] Generating "etcd/server" certificate and key
â”‚ â”‚ [certs] etcd/server serving cert is signed for DNS names [cpicb-t-k8s-m01 localhost] and IPs [10.208.14.30 127.0.0.1 ::1]
â”‚ â”‚ [certs] Generating "etcd/peer" certificate and key
â”‚ â”‚ [certs] etcd/peer serving cert is signed for DNS names [cpicb-t-k8s-m01 localhost] and IPs [10.208.14.30 127.0.0.1 ::1]
â”‚ â”‚ [certs] Generating "etcd/healthcheck-client" certificate and key
â”‚ â”‚ [certs] Generating "apiserver-etcd-client" certificate and key
â”‚ â”‚ [certs] Generating "sa" key and public key
â”‚ â”‚ W1115 15:46:23.821481   15015 initconfiguration.go:332] [config] WARNING: Ignored YAML document with GroupVersionKind                  â†µ
â”‚ â”‚ kubeadm.k8s.io/v1beta3, Kind=JoinConfiguration
â”‚ â”‚ [kubeconfig] Using kubeconfig folder "/etc/kubernetes"
â”‚ â”‚ W1115 15:46:23.837818   15015 endpoint.go:57] [endpoint] WARNING: port specified in controlPlaneEndpoint overrides bindPort in the     â†µ
â”‚ â”‚ controlplane address
â”‚ â”‚ [kubeconfig] Writing "admin.conf" kubeconfig file
â”‚ â”‚ W1115 15:46:23.927604   15015 endpoint.go:57] [endpoint] WARNING: port specified in controlPlaneEndpoint overrides bindPort in the     â†µ
â”‚ â”‚ controlplane address
â”‚ â”‚ [kubeconfig] Using existing kubeconfig file: "/etc/kubernetes/kubelet.conf"
â”‚ â”‚ W1115 15:46:24.449462   15015 endpoint.go:57] [endpoint] WARNING: port specified in controlPlaneEndpoint overrides bindPort in the     â†µ
â”‚ â”‚ controlplane address
â”‚ â”‚ [kubeconfig] Writing "controller-manager.conf" kubeconfig file
â”‚ â”‚ W1115 15:46:24.739514   15015 endpoint.go:57] [endpoint] WARNING: port specified in controlPlaneEndpoint overrides bindPort in the     â†µ
â”‚ â”‚ controlplane address
â”‚ â”‚ [kubeconfig] Writing "scheduler.conf" kubeconfig file
â”‚ â”‚ W1115 15:46:24.913525   15021 initconfiguration.go:332] [config] WARNING: Ignored YAML document with GroupVersionKind                  â†µ
â”‚ â”‚ kubeadm.k8s.io/v1beta3, Kind=JoinConfiguration
â”‚ â”‚ [etcd] Creating static Pod manifest for local etcd in "/etc/kubernetes/manifests"
â”‚ â”‚ [patches] Reading patches from path "/etc/kubernetes/deckhouse/kubeadm/patches/"
â”‚ â”‚ [patches] Found the following patch files: [etcd.yaml kube-apiserver.yaml kube-controller-manager.yaml kube-scheduler.yaml]
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "etcd"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "etcd"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "etcd"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "etcd"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "etcd"
â”‚ â”‚ W1115 15:46:24.999849   15027 initconfiguration.go:332] [config] WARNING: Ignored YAML document with GroupVersionKind                  â†µ
â”‚ â”‚ kubeadm.k8s.io/v1beta3, Kind=JoinConfiguration
â”‚ â”‚ [control-plane] Using manifest folder "/etc/kubernetes/manifests"
â”‚ â”‚ [control-plane] Creating static Pod manifest for "kube-apiserver"
â”‚ â”‚ [patches] Reading patches from path "/etc/kubernetes/deckhouse/kubeadm/patches/"
â”‚ â”‚ [patches] Found the following patch files: [etcd.yaml kube-apiserver.yaml kube-controller-manager.yaml kube-scheduler.yaml]
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-apiserver"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-apiserver"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-apiserver"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-apiserver"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-apiserver"
â”‚ â”‚ [control-plane] Creating static Pod manifest for "kube-controller-manager"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-controller-manager"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-controller-manager"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-controller-manager"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-controller-manager"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-controller-manager"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-controller-manager"
â”‚ â”‚ [control-plane] Creating static Pod manifest for "kube-scheduler"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-scheduler"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-scheduler"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-scheduler"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-scheduler"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-scheduler"
â”‚ â”‚ [patches] Applied patch of type "application/strategic-merge-patch+json" to target "kube-scheduler"
â”‚ â”‚ W1115 15:46:25.128798   15034 initconfiguration.go:332] [config] WARNING: Ignored YAML document with GroupVersionKind                  â†µ
â”‚ â”‚ kubeadm.k8s.io/v1beta3, Kind=JoinConfiguration
â”‚ â”‚ [mark-control-plane] Marking the node cpicb-t-k8s-m01 as control-plane by adding the labels: [node-role.kubernetes.io/control-plane    â†µ
â”‚ â”‚ node.kubernetes.io/exclude-from-external-load-balancers]
â”‚ â”‚ [mark-control-plane] Marking the node cpicb-t-k8s-m01 as control-plane by adding the taints                                            â†µ
â”‚ â”‚ [node-role.kubernetes.io/master:NoSchedule node-role.kubernetes.io/control-plane:NoSchedule]
â”‚ â”‚ node/cpicb-t-k8s-m01 unlabeled
â”‚ â”‚ Error from server (NotFound): secrets "d8-pki" not found
â”‚ â”‚ secret/d8-pki created
â”‚ â”” Run step 070_install_control_plane.sh (125.23 seconds)
â”‚ 
â”‚ â”Œ Run step 070_start_sysctl_tuner.sh
â”‚ â”” Run step 070_start_sysctl_tuner.sh (0.09 seconds)
â”‚ 
â”‚ â”Œ Run step 080_setup_timer_to_run_bashible.sh
â”‚ â”‚ Created symlink /etc/systemd/system/multi-user.target.wants/bashible.timer -> /etc/systemd/system/bashible.timer.
â”‚ â”” Run step 080_setup_timer_to_run_bashible.sh (1.06 seconds)
â”‚ 
â”‚ â”Œ Run step 082_disable_logrotate_for_docker.sh
â”‚ â”” Run step 082_disable_logrotate_for_docker.sh (0.05 seconds)
â”‚ 
â”‚ â”Œ Run step 083_disable_rsyslog_for_docker_and_kubelet.sh
â”‚ â”” Run step 083_disable_rsyslog_for_docker_and_kubelet.sh (0.10 seconds)
â”‚ 
â”‚ â”Œ Run step 084_configure_journald_retention.sh
â”‚ â”” Run step 084_configure_journald_retention.sh (0.11 seconds)
â”‚ 
â”‚ â”Œ Run step 089_setup_timer_to_run_docker_stuck_containers_cleaner.sh
â”‚ â”” Run step 089_setup_timer_to_run_docker_stuck_containers_cleaner.sh (0.04 seconds)
â”‚ 
â”‚ â”Œ Run step 090_node_users.sh
â”‚ â”” Run step 090_node_users.sh (0.03 seconds)
â”‚ 
â”‚ â”Œ Run step 091_set_virtualization_type.sh
â”‚ â”” Run step 091_set_virtualization_type.sh (0.03 seconds)
â”‚ 
â”‚ â”Œ Run step 098_cleanup.sh
â”‚ â”” Run step 098_cleanup.sh (0.03 seconds)
â”‚ 
â”‚ â”Œ Run step 098_cleanup_after_cluster_bootstrap.sh
â”‚ â”‚ bb-rp [INFO] Removing package 'kubeadm'
â”‚ â”‚ Canceled hold on kubeadm.
â”‚ â”‚ Canceled hold on cri-tools.
â”‚ â”‚ (Reading database ... 72713 files and directories currently installed.)
â”‚ â”‚ Removing kubeadm (1.24.3-00) ...
â”‚ â”‚ Removing cri-tools (1.24.2-00) ...
â”‚ â”” Run step 098_cleanup_after_cluster_bootstrap.sh (0.26 seconds)
â”‚ 
â”‚ â”Œ Run step 099_reboot.sh
â”‚ â”‚ c8d7cfe1ab6d1e577cc7f9e0fda9b3d2abb37b4cac7f277add39f4ab66a06f42
â”‚ â”‚ 82b48b59c58566b8be7b394d9b2ea7b1ed4605e7a23db28ade0f682a8e7198f1
â”‚ â”‚ 0196e4464a746681a871f0c2fd4aeb057ea99a1bbf6a2741e163aeb3364a02ed
â”‚ â”‚ 5b70731deb0cda316be9d90d819f806d6c7a52847537e06c5556c93648247338
â”‚ â”‚ 311f6cdf040eba5a2623435114951ff0d673007566260682e38e016c9a7ef081
â”‚ â”‚ d536ed770228c2b7b2b5a3bbb71ae6c636ed853251a5979056794363d7c0716d
â”‚ â”” Run step 099_reboot.sh (0.61 seconds)
â”” â›µ ~ Bootstrap: Execute Bashible Bundle (376.35 seconds)

â”Œ â›µ ~ Bootstrap: Reboot Masterï¸
â”” â›µ ~ Bootstrap: Reboot Masterï¸ (0.48 seconds)

â”Œ ğŸˆ ~ Common: Connect to Kubernetes API
â”‚ â”Œ Waiting for SSH connection
â”‚ â”‚ Try to connect to cpicb-t-k8s-m01.ahml1.ru host
â”‚ â”‚ ssh: connect to host cpicb-t-k8s-m01.ahml1.ru port 22: Connection refused
â”‚ â”‚ ï¸â›±ï¸ï¸ Attempt #1 of 50 |
â”‚ â”‚     Waiting for SSH connection failed, next attempt will be in 5s"
â”‚ â”‚     Error: host 'cpicb-t-k8s-m01.ahml1.ru' is not available
â”‚ â”‚ 
â”‚ â”‚ Try to connect to cpicb-t-k8s-m01.ahml1.ru host
â”‚ â”‚ ssh: connect to host cpicb-t-k8s-m01.ahml1.ru port 22: Connection refused
â”‚ â”‚ ï¸â›±ï¸ï¸ Attempt #2 of 50 |
â”‚ â”‚     Waiting for SSH connection failed, next attempt will be in 5s"
â”‚ â”‚     Error: host 'cpicb-t-k8s-m01.ahml1.ru' is not available
â”‚ â”‚ 
â”‚ â”‚ Try to connect to cpicb-t-k8s-m01.ahml1.ru host
â”‚ â”‚ ssh: connect to host cpicb-t-k8s-m01.ahml1.ru port 22: Operation timed out
â”‚ â”‚ ï¸â›±ï¸ï¸ Attempt #3 of 50 |
â”‚ â”‚     Waiting for SSH connection failed, next attempt will be in 5s"
â”‚ â”‚     Error: host 'cpicb-t-k8s-m01.ahml1.ru' is not available
â”‚ â”‚ 
â”‚ â”‚ Try to connect to cpicb-t-k8s-m01.ahml1.ru host
â”‚ â”‚ ssh: connect to host cpicb-t-k8s-m01.ahml1.ru port 22: Connection refused
â”‚ â”‚ ï¸â›±ï¸ï¸ Attempt #4 of 50 |
â”‚ â”‚     Waiting for SSH connection failed, next attempt will be in 5s"
â”‚ â”‚     Error: host 'cpicb-t-k8s-m01.ahml1.ru' is not available
â”‚ â”‚ 
â”‚ â”‚ Try to connect to cpicb-t-k8s-m01.ahml1.ru host
â”‚ â”‚ ğŸ‰ Succeeded!
â”‚ â”” Waiting for SSH connection (28.71 seconds)
â”‚ 
â”‚ â”Œ Get Kubernetes API client
â”‚ â”‚ â”Œ Starting kube proxy
â”‚ â”‚ â”‚ Using host cpicb-t-k8s-m01.ahml1.ru
â”‚ â”‚ â”‚ Got proxy port = 18441 on host cpicb-t-k8s-m01.ahml1.ru
â”‚ â”‚ â”‚ ğŸ‰ Succeeded!
â”‚ â”‚ â”” Starting kube proxy (0.72 seconds)
â”‚ â”‚ 
â”‚ â”‚ Proxy started on port 22322
â”‚ â”‚ ğŸ‰ Succeeded!
â”‚ â”” Get Kubernetes API client (0.73 seconds)
â”‚ 
â”‚ â”Œ Waiting for Kubernetes API to become Ready
â”‚ â”‚ ğŸ‰ Succeeded!
â”‚ â”” Waiting for Kubernetes API to become Ready (1.12 seconds)
â”” ğŸˆ ~ Common: Connect to Kubernetes API (31.61 seconds)

â”Œ â›µ ~ Bootstrap: Install Deckhouse
â”‚ â”Œ Create Manifests
â”‚ â”‚ Manifest for Namespace "d8-system"
â”‚ â”‚ Manifest for Admin ClusterRole "cluster-admin"
â”‚ â”‚ Admin ClusterRole "cluster-admin" already exists. Trying to update ... OK!
â”‚ â”‚ Manifest for ClusterRoleBinding "deckhouse"
â”‚ â”‚ Manifest for ServiceAccount "deckhouse"
â”‚ â”‚ Manifest for ConfigMap "deckhouse"
â”‚ â”‚ Manifest for Secret "deckhouse-registry"
â”‚ â”‚ Manifest for Secret "d8-cluster-configuration"
â”‚ â”‚ Manifest for Secret "d8-static-cluster-configuration"
â”‚ â”‚ Manifest for ConfigMap "d8-cluster-uuid"
â”‚ â”‚ Manifest for Service "kube-dns"
â”‚ â”‚ Manifest for Deployment "deckhouse"
â”‚ â”” Create Manifests (0.58 seconds)
â”‚ 
â”‚ â”Œ Waiting for Deckhouse to become Ready
â”‚ â”‚ No Deckhouse pod found.
â”‚ â”‚ No Deckhouse pod found.
â”‚ â”‚ No Deckhouse pod found.
â”‚ â”‚ No Deckhouse pod found.
â”‚ â”‚ No Deckhouse pod found.
â”‚ â”‚ No Deckhouse pod found.
â”‚ â”‚ No Deckhouse pod found.
â”‚ â”‚ Deckhouse pod found: deckhouse-78585b568d-8vgpf (Pending)
â”‚ â”‚ Deckhouse pod found: deckhouse-78585b568d-8vgpf (Pending)
â”‚ â”‚ Deckhouse pod found: deckhouse-78585b568d-8vgpf (Pending)
â”‚ â”‚ Deckhouse pod found: deckhouse-78585b568d-8vgpf (Pending)
â”‚ â”‚ Deckhouse pod found: deckhouse-78585b568d-8vgpf (Pending)
â”‚ â”‚ Deckhouse pod found: deckhouse-78585b568d-8vgpf (Pending)
â”‚ â”‚ Deckhouse pod found: deckhouse-78585b568d-8vgpf (Running)
â”‚ â”‚ Running pod found! Checking logs...
â”‚ â”‚ Request failed. Probably pod was restarted during installation.
â”‚ â”‚ Deckhouse pod found: deckhouse-9877c4d54-qc682 (Pending)
â”‚ â”‚ Deckhouse pod found: deckhouse-9877c4d54-qc682 (Running)
â”‚ â”‚ Running pod found! Checking logs...
â”‚ â”‚     Module "priority-class" run successfully
â”‚ â”‚     Module "operator-prometheus-crd" run successfully
â”‚ â”‚     Module "prometheus-crd" run successfully
â”‚ â”‚     Module "cni-cilium" run successfully
â”‚ â”‚     node-manager/: ModuleRun failed in phase 'Startup'. Requeue task to retry after delay. Failed count is 1. Error: 1 error occurred:
â”‚ â”‚     * Create object: deckhouse.io/v1/NodeGroup//master: apiVersion 'deckhouse.io/v1', kind 'NodeGroup' is not supported by cluster
â”‚ â”‚ 
â”‚ â”‚ 
â”‚ â”‚     node-manager/: ModuleRun failed in phase 'QueueSynchronizationTasks'. Requeue task to retry after delay. Failed count is 2. Error:    â†µ
â”‚ â”‚ run monitor: apiVersion 'deckhouse.io/v1alpha1', kind 'NodeGroupConfiguration' is not supported by cluster
â”‚ â”‚     Module "node-manager" run successfully
â”‚ â”‚     Module "kube-dns" run successfully
â”‚ â”‚ No more converge tasks found in Deckhouse queue.
â”‚ â”‚ Deckhouse pod is Ready!
â”‚ â”” Waiting for Deckhouse to become Ready (124.73 seconds)
â”” â›µ ~ Bootstrap: Install Deckhouse (125.35 seconds)

â”Œ â›µ ~ Bootstrap: Clear cache
â”‚ â— ~ Next run of "dhctl bootstrap" will create a new Kubernetes cluster.
â”” â›µ ~ Bootstrap: Clear cache (0.00 seconds)