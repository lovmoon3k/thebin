CREATE TABLE XPANSE_AMT AS 
SELECT tgt.msdin 
,cast(tgt.event_date AS VARCHAR) AS event_date 
,cast('scoring' AS VARCHAR) AS partition_val 
,cast(0 AS DOUBLE) AS score 
,cast(0 AS DOUBLE) AS score_percentile 
,coalesce(imp_cdr_j_14_days.var2307, 0) AS var2307 
,coalesce(imp_cdr_j_180_days.var811, 0) AS var811 
,coalesce(imp_cdr_j_180_days.var871, 0) AS var871 
,coalesce(imp_cdr_j_180_days.var895, 0) AS var895 
,coalesce(imp_cdr_j_180_days.var1015, 0) AS var1015 
,coalesce(imp_cdr_j_180_days.var812, 0) AS var812 
,coalesce(imp_cdr_j_180_days.var872, 0) AS var872 
,coalesce(imp_cdr_j_180_days.var896, 0) AS var896 
,coalesce(imp_cdr_j_180_days.var920, 0) AS var920 
,coalesce(imp_cdr_j_180_days.var1016, 0) AS var1016 
,coalesce(imp_cdr_j_180_days.var756, 0) AS var756 
,coalesce(imp_cdr_j_180_days.var840, 0) AS var840 
,coalesce(imp_cdr_j_180_days.var912, 0) AS var912 
,coalesce(imp_cdr_j_180_days.var1013, 0) AS var1013 
,coalesce(imp_cdr_j_180_days.var774, 0) AS var774 
,coalesce(imp_cdr_j_180_days.var930, 0) AS var930 
,coalesce(imp_cdr_j_180_days.var954, 0) AS var954 
,coalesce(imp_cdr_j_180_days.var966, 0) AS var966 
,coalesce(imp_cdr_j_180_days.var1014, 0) AS var1014 
,coalesce(imp_cdr_j_180_days.var1026, 0) AS var1026 
,coalesce(imp_cdr_j_180_days.var1038, 0) AS var1038 
,coalesce(imp_cdr_j_180_days.var771, 0) AS var771 
,coalesce(imp_cdr_j_180_days.var855, 0) AS var855 
,coalesce(imp_cdr_j_180_days.var951, 0) AS var951 
,coalesce(imp_cdr_j_180_days.var963, 0) AS var963 
,coalesce(imp_cdr_j_180_days.var1011, 0) AS var1011 
,coalesce(imp_cdr_j_180_days.var755, 0) AS var755 
,coalesce(imp_cdr_j_180_days.var827, 0) AS var827 
,coalesce(imp_cdr_j_180_days.var839, 0) AS var839 
,coalesce(imp_cdr_j_180_days.var911, 0) AS var911 
,coalesce(imp_cdr_j_180_days.var753, 0) AS var753 
,coalesce(imp_cdr_j_180_days.var765, 0) AS var765 
,coalesce(imp_cdr_j_180_days.var806, 0) AS var806 
,coalesce(imp_cdr_j_180_days.var825, 0) AS var825 
,coalesce(imp_cdr_j_180_days.var837, 0) AS var837 
,coalesce(imp_cdr_j_180_days.var878, 0) AS var878 
,coalesce(imp_cdr_j_180_days.var909, 0) AS var909 
,coalesce(imp_cdr_j_1_day.var3367, 0) AS var3367 
,coalesce(imp_cdr_j_1_day.var3415, 0) AS var3415 
,coalesce(imp_cdr_j_1_day.var3439, 0) AS var3439 
,coalesce(imp_cdr_j_1_day.var3523, 0) AS var3523 
,coalesce(imp_cdr_j_1_day.var3535, 0) AS var3535 
,coalesce(imp_cdr_j_1_day.var3547, 0) AS var3547 
,coalesce(imp_cdr_j_1_day.var3559, 0) AS var3559 
,coalesce(imp_cdr_j_1_day.var3595, 0) AS var3595 
,coalesce(imp_cdr_j_1_day.var3619, 0) AS var3619 
,coalesce(imp_cdr_j_1_day.var3368, 0) AS var3368 
,coalesce(imp_cdr_j_1_day.var3416, 0) AS var3416 
,coalesce(imp_cdr_j_1_day.var3428, 0) AS var3428 
,coalesce(imp_cdr_j_1_day.var3440, 0) AS var3440 
,coalesce(imp_cdr_j_1_day.var3512, 0) AS var3512 
,coalesce(imp_cdr_j_1_day.var3524, 0) AS var3524 
,coalesce(imp_cdr_j_1_day.var3536, 0) AS var3536 
,coalesce(imp_cdr_j_1_day.var3548, 0) AS var3548 
,coalesce(imp_cdr_j_1_day.var3596, 0) AS var3596 
,coalesce(imp_cdr_j_1_day.var3620, 0) AS var3620 
,coalesce(imp_cdr_j_1_day.var3377, 0) AS var3377 
,coalesce(imp_cdr_j_1_day.var3425, 0) AS var3425 
,coalesce(imp_cdr_j_1_day.var3521, 0) AS var3521 
,coalesce(imp_cdr_j_1_day.var3545, 0) AS var3545 
,coalesce(imp_cdr_j_1_day.var3557, 0) AS var3557 
,coalesce(imp_cdr_j_1_day.var3629, 0) AS var3629 
,coalesce(imp_cdr_j_1_day.var3399, 0) AS var3399 
,coalesce(imp_cdr_j_1_day.var3423, 0) AS var3423 
,coalesce(imp_cdr_j_1_day.var3435, 0) AS var3435 
,coalesce(imp_cdr_j_1_day.var3447, 0) AS var3447 
,coalesce(imp_cdr_j_1_day.var3507, 0) AS var3507 
,coalesce(imp_cdr_j_1_day.var3519, 0) AS var3519 
,coalesce(imp_cdr_j_1_day.var3543, 0) AS var3543 
,coalesce(imp_cdr_j_1_day.var3555, 0) AS var3555 
,coalesce(imp_cdr_j_1_day.var3603, 0) AS var3603 
,coalesce(imp_cdr_j_1_day.var3627, 0) AS var3627 
,coalesce(imp_cdr_j_1_day.var3424, 0) AS var3424 
,coalesce(imp_cdr_j_1_day.var3448, 0) AS var3448 
,coalesce(imp_cdr_j_1_day.var3544, 0) AS var3544 
,coalesce(imp_cdr_j_1_day.var3556, 0) AS var3556 
,coalesce(imp_cdr_j_1_day.var3604, 0) AS var3604 
,coalesce(imp_cdr_j_1_day.var3628, 0) AS var3628 
,coalesce(imp_cdr_j_1_day.var3374, 0) AS var3374 
,coalesce(imp_cdr_j_1_day.var3422, 0) AS var3422 
,coalesce(imp_cdr_j_1_day.var3446, 0) AS var3446 
,coalesce(imp_cdr_j_1_day.var3542, 0) AS var3542 
,coalesce(imp_cdr_j_1_day.var3554, 0) AS var3554 
,coalesce(imp_cdr_j_1_day.var3602, 0) AS var3602 
,coalesce(imp_cdr_j_1_day.var3626, 0) AS var3626 
,coalesce(imp_cdr_j_28_days.var2061, 0) AS var2061 
,coalesce(imp_cdr_j_30_days.var1637, 0) AS var1637 
,coalesce(imp_cdr_j_365_days.var499, 0) AS var499 
,coalesce(imp_cdr_j_365_days.var511, 0) AS var511 
,coalesce(imp_cdr_j_365_days.var523, 0) AS var523 
,coalesce(imp_cdr_j_365_days.var535, 0) AS var535 
,coalesce(imp_cdr_j_365_days.var547, 0) AS var547 
,coalesce(imp_cdr_j_365_days.var559, 0) AS var559 
,coalesce(imp_cdr_j_365_days.var583, 0) AS var583 
,coalesce(imp_cdr_j_365_days.var595, 0) AS var595 
,coalesce(imp_cdr_j_365_days.var607, 0) AS var607 
,coalesce(imp_cdr_j_365_days.var679, 0) AS var679 
,coalesce(imp_cdr_j_365_days.var727, 0) AS var727 
,coalesce(imp_cdr_j_365_days.var488, 0) AS var488 
,coalesce(imp_cdr_j_365_days.var500, 0) AS var500 
,coalesce(imp_cdr_j_365_days.var512, 0) AS var512 
,coalesce(imp_cdr_j_365_days.var524, 0) AS var524 
,coalesce(imp_cdr_j_365_days.var536, 0) AS var536 
,coalesce(imp_cdr_j_365_days.var548, 0) AS var548 
,coalesce(imp_cdr_j_365_days.var584, 0) AS var584 
,coalesce(imp_cdr_j_365_days.var596, 0) AS var596 
,coalesce(imp_cdr_j_365_days.var608, 0) AS var608 
,coalesce(imp_cdr_j_365_days.var632, 0) AS var632 
,coalesce(imp_cdr_j_365_days.var656, 0) AS var656 
,coalesce(imp_cdr_j_365_days.var680, 0) AS var680 
,coalesce(imp_cdr_j_365_days.var728, 0) AS var728 
,coalesce(imp_cdr_j_365_days.var468, 0) AS var468 
,coalesce(imp_cdr_j_365_days.var480, 0) AS var480 
,coalesce(imp_cdr_j_365_days.var485, 0) AS var485 
,coalesce(imp_cdr_j_365_days.var504, 0) AS var504 
,coalesce(imp_cdr_j_365_days.var552, 0) AS var552 
,coalesce(imp_cdr_j_365_days.var557, 0) AS var557 
,coalesce(imp_cdr_j_365_days.var564, 0) AS var564 
,coalesce(imp_cdr_j_365_days.var593, 0) AS var593 
,coalesce(imp_cdr_j_365_days.var624, 0) AS var624 
,coalesce(imp_cdr_j_365_days.var749, 0) AS var749 
,coalesce(imp_cdr_j_365_days.var481, 0) AS var481 
,coalesce(imp_cdr_j_365_days.var486, 0) AS var486 
,coalesce(imp_cdr_j_365_days.var505, 0) AS var505 
,coalesce(imp_cdr_j_365_days.var522, 0) AS var522 
,coalesce(imp_cdr_j_365_days.var529, 0) AS var529 
,coalesce(imp_cdr_j_365_days.var534, 0) AS var534 
,coalesce(imp_cdr_j_365_days.var625, 0) AS var625 
,coalesce(imp_cdr_j_365_days.var642, 0) AS var642 
,coalesce(imp_cdr_j_365_days.var666, 0) AS var666 
,coalesce(imp_cdr_j_365_days.var678, 0) AS var678 
,coalesce(imp_cdr_j_365_days.var726, 0) AS var726 
,coalesce(imp_cdr_j_365_days.var738, 0) AS var738 
,coalesce(imp_cdr_j_365_days.var750, 0) AS var750 
,coalesce(imp_cdr_j_365_days.var471, 0) AS var471 
,coalesce(imp_cdr_j_365_days.var483, 0) AS var483 
,coalesce(imp_cdr_j_365_days.var519, 0) AS var519 
,coalesce(imp_cdr_j_365_days.var555, 0) AS var555 
,coalesce(imp_cdr_j_365_days.var567, 0) AS var567 
,coalesce(imp_cdr_j_365_days.var579, 0) AS var579 
,coalesce(imp_cdr_j_365_days.var627, 0) AS var627 
,coalesce(imp_cdr_j_365_days.var663, 0) AS var663 
,coalesce(imp_cdr_j_365_days.var675, 0) AS var675 
,coalesce(imp_cdr_j_365_days.var723, 0) AS var723 
,coalesce(imp_cdr_j_365_days.var467, 0) AS var467 
,coalesce(imp_cdr_j_365_days.var472, 0) AS var472 
,coalesce(imp_cdr_j_365_days.var479, 0) AS var479 
,coalesce(imp_cdr_j_365_days.var484, 0) AS var484 
,coalesce(imp_cdr_j_365_days.var503, 0) AS var503 
,coalesce(imp_cdr_j_365_days.var539, 0) AS var539 
,coalesce(imp_cdr_j_365_days.var551, 0) AS var551 
,coalesce(imp_cdr_j_365_days.var563, 0) AS var563 
,coalesce(imp_cdr_j_365_days.var580, 0) AS var580 
,coalesce(imp_cdr_j_365_days.var592, 0) AS var592 
,coalesce(imp_cdr_j_365_days.var623, 0) AS var623 
,coalesce(imp_cdr_j_365_days.var465, 0) AS var465 
,coalesce(imp_cdr_j_365_days.var470, 0) AS var470 
,coalesce(imp_cdr_j_365_days.var477, 0) AS var477 
,coalesce(imp_cdr_j_365_days.var482, 0) AS var482 
,coalesce(imp_cdr_j_365_days.var501, 0) AS var501 
,coalesce(imp_cdr_j_365_days.var518, 0) AS var518 
,coalesce(imp_cdr_j_365_days.var537, 0) AS var537 
,coalesce(imp_cdr_j_365_days.var542, 0) AS var542 
,coalesce(imp_cdr_j_365_days.var549, 0) AS var549 
,coalesce(imp_cdr_j_365_days.var554, 0) AS var554 
,coalesce(imp_cdr_j_365_days.var561, 0) AS var561 
,coalesce(imp_cdr_j_365_days.var590, 0) AS var590 
,coalesce(imp_cdr_j_365_days.var621, 0) AS var621 
,coalesce(imp_cdr_j_365_days.var633, 0) AS var633 
,coalesce(imp_cdr_j_3_days.var3079, 0) AS var3079 
,coalesce(imp_cdr_j_3_days.var3139, 0) AS var3139 
,coalesce(imp_cdr_j_3_days.var3163, 0) AS var3163 
,coalesce(imp_cdr_j_3_days.var3211, 0) AS var3211 
,coalesce(imp_cdr_j_3_days.var3259, 0) AS var3259 
,coalesce(imp_cdr_j_3_days.var3271, 0) AS var3271 
,coalesce(imp_cdr_j_3_days.var3283, 0) AS var3283 
,coalesce(imp_cdr_j_3_days.var3080, 0) AS var3080 
,coalesce(imp_cdr_j_3_days.var3140, 0) AS var3140 
,coalesce(imp_cdr_j_3_days.var3152, 0) AS var3152 
,coalesce(imp_cdr_j_3_days.var3164, 0) AS var3164 
,coalesce(imp_cdr_j_3_days.var3212, 0) AS var3212 
,coalesce(imp_cdr_j_3_days.var3236, 0) AS var3236 
,coalesce(imp_cdr_j_3_days.var3260, 0) AS var3260 
,coalesce(imp_cdr_j_3_days.var3272, 0) AS var3272 
,coalesce(imp_cdr_j_3_days.var3284, 0) AS var3284 
,coalesce(imp_cdr_j_3_days.var3161, 0) AS var3161 
,coalesce(imp_cdr_j_3_days.var3221, 0) AS var3221 
,coalesce(imp_cdr_j_3_days.var3269, 0) AS var3269 
,coalesce(imp_cdr_j_3_days.var3281, 0) AS var3281 
,coalesce(imp_cdr_j_3_days.var3111, 0) AS var3111 
,coalesce(imp_cdr_j_3_days.var3147, 0) AS var3147 
,coalesce(imp_cdr_j_3_days.var3159, 0) AS var3159 
,coalesce(imp_cdr_j_3_days.var3171, 0) AS var3171 
,coalesce(imp_cdr_j_3_days.var3219, 0) AS var3219 
,coalesce(imp_cdr_j_3_days.var3267, 0) AS var3267 
,coalesce(imp_cdr_j_3_days.var3315, 0) AS var3315 
,coalesce(imp_cdr_j_3_days.var3112, 0) AS var3112 
,coalesce(imp_cdr_j_3_days.var3220, 0) AS var3220 
,coalesce(imp_cdr_j_3_days.var3268, 0) AS var3268 
,coalesce(imp_cdr_j_3_days.var3146, 0) AS var3146 
,coalesce(imp_cdr_j_3_days.var3218, 0) AS var3218 
,coalesce(imp_cdr_j_3_days.var3266, 0) AS var3266 
,coalesce(imp_cdr_j_3_days.var3278, 0) AS var3278 
,coalesce(imp_cdr_j_3_days.var3290, 0) AS var3290 
,coalesce(imp_cdr_j_5_days.var2851, 0) AS var2851 
,coalesce(imp_cdr_j_5_days.var2875, 0) AS var2875 
,coalesce(imp_cdr_j_5_days.var2923, 0) AS var2923 
,coalesce(imp_cdr_j_5_days.var2947, 0) AS var2947 
,coalesce(imp_cdr_j_5_days.var2971, 0) AS var2971 
,coalesce(imp_cdr_j_5_days.var2983, 0) AS var2983 
,coalesce(imp_cdr_j_5_days.var2995, 0) AS var2995 
,coalesce(imp_cdr_j_5_days.var2924, 0) AS var2924 
,coalesce(imp_cdr_j_5_days.var2972, 0) AS var2972 
,coalesce(imp_cdr_j_5_days.var2984, 0) AS var2984 
,coalesce(imp_cdr_j_5_days.var2996, 0) AS var2996 
,coalesce(imp_cdr_j_5_days.var2933, 0) AS var2933 
,coalesce(imp_cdr_j_5_days.var2981, 0) AS var2981 
,coalesce(imp_cdr_j_5_days.var2993, 0) AS var2993 
,coalesce(imp_cdr_j_5_days.var3005, 0) AS var3005 
,coalesce(imp_cdr_j_5_days.var2859, 0) AS var2859 
,coalesce(imp_cdr_j_5_days.var2883, 0) AS var2883 
,coalesce(imp_cdr_j_5_days.var2931, 0) AS var2931 
,coalesce(imp_cdr_j_5_days.var2979, 0) AS var2979 
,coalesce(imp_cdr_j_5_days.var2991, 0) AS var2991 
,coalesce(imp_cdr_j_5_days.var3003, 0) AS var3003 
,coalesce(imp_cdr_j_5_days.var2884, 0) AS var2884 
,coalesce(imp_cdr_j_5_days.var2932, 0) AS var2932 
,coalesce(imp_cdr_j_5_days.var2980, 0) AS var2980 
,coalesce(imp_cdr_j_5_days.var2992, 0) AS var2992 
,coalesce(imp_cdr_j_5_days.var2882, 0) AS var2882 
,coalesce(imp_cdr_j_5_days.var2930, 0) AS var2930 
,coalesce(imp_cdr_j_5_days.var2978, 0) AS var2978 
,coalesce(imp_cdr_j_5_days.var2990, 0) AS var2990 
,coalesce(imp_cdr_j_5_days.var3002, 0) AS var3002 
,coalesce(imp_cdr_j_60_days.var1332, 0) AS var1332 
,coalesce(imp_cdr_j_60_days.var1344, 0) AS var1344 
,coalesce(imp_cdr_j_60_days.var1349, 0) AS var1349 
,coalesce(imp_cdr_j_60_days.var1500, 0) AS var1500 
,coalesce(imp_cdr_j_60_days.var1383, 0) AS var1383 
,coalesce(imp_cdr_j_60_days.var1503, 0) AS var1503 
,coalesce(imp_cdr_j_60_days.var1527, 0) AS var1527 
,coalesce(imp_cdr_j_60_days.var1587, 0) AS var1587 
,coalesce(imp_cdr_j_60_days.var1611, 0) AS var1611 
,coalesce(imp_cdr_j_60_days.var1331, 0) AS var1331 
,coalesce(imp_cdr_j_60_days.var1343, 0) AS var1343 
,coalesce(imp_cdr_j_60_days.var1499, 0) AS var1499 
,coalesce(imp_cdr_j_60_days.var1329, 0) AS var1329 
,coalesce(imp_cdr_j_60_days.var1341, 0) AS var1341 
,coalesce(imp_cdr_j_60_days.var1365, 0) AS var1365 
,coalesce(imp_cdr_j_60_days.var1497, 0) AS var1497 
,coalesce(imp_cdr_j_7_days.var2695, 0) AS var2695 
,coalesce(imp_cdr_j_7_days.var2564, 0) AS var2564 
,coalesce(imp_cdr_j_7_days.var2588, 0) AS var2588 
,coalesce(imp_cdr_j_7_days.var2696, 0) AS var2696 
,coalesce(imp_cdr_j_7_days.var2708, 0) AS var2708 
,coalesce(imp_cdr_j_7_days.var2705, 0) AS var2705 
,coalesce(imp_cdr_j_7_days.var2559, 0) AS var2559 
,coalesce(imp_cdr_j_7_days.var2691, 0) AS var2691 
,coalesce(imp_cdr_j_7_days.var2596, 0) AS var2596 
,coalesce(imp_cdr_j_7_days.var2594, 0) AS var2594 
,coalesce(imp_cdr_j_90_days.var1039, 0) AS var1039 
,coalesce(imp_cdr_j_90_days.var1051, 0) AS var1051 
,coalesce(imp_cdr_j_90_days.var1099, 0) AS var1099 
,coalesce(imp_cdr_j_90_days.var1159, 0) AS var1159 
,coalesce(imp_cdr_j_90_days.var1171, 0) AS var1171 
,coalesce(imp_cdr_j_90_days.var1183, 0) AS var1183 
,coalesce(imp_cdr_j_90_days.var1303, 0) AS var1303 
,coalesce(imp_cdr_j_90_days.var1052, 0) AS var1052 
,coalesce(imp_cdr_j_90_days.var1100, 0) AS var1100 
,coalesce(imp_cdr_j_90_days.var1148, 0) AS var1148 
,coalesce(imp_cdr_j_90_days.var1160, 0) AS var1160 
,coalesce(imp_cdr_j_90_days.var1184, 0) AS var1184 
,coalesce(imp_cdr_j_90_days.var1196, 0) AS var1196 
,coalesce(imp_cdr_j_90_days.var1208, 0) AS var1208 
,coalesce(imp_cdr_j_90_days.var1304, 0) AS var1304 
,coalesce(imp_cdr_j_90_days.var1061, 0) AS var1061 
,coalesce(imp_cdr_j_90_days.var1116, 0) AS var1116 
,coalesce(imp_cdr_j_90_days.var1140, 0) AS var1140 
,coalesce(imp_cdr_j_90_days.var1200, 0) AS var1200 
,coalesce(imp_cdr_j_90_days.var1212, 0) AS var1212 
,coalesce(imp_cdr_j_90_days.var1217, 0) AS var1217 
,coalesce(imp_cdr_j_90_days.var1301, 0) AS var1301 
,coalesce(imp_cdr_j_90_days.var1059, 0) AS var1059 
,coalesce(imp_cdr_j_90_days.var1095, 0) AS var1095 
,coalesce(imp_cdr_j_90_days.var1131, 0) AS var1131 
,coalesce(imp_cdr_j_90_days.var1215, 0) AS var1215 
,coalesce(imp_cdr_j_90_days.var1239, 0) AS var1239 
,coalesce(imp_cdr_j_90_days.var1251, 0) AS var1251 
,coalesce(imp_cdr_j_90_days.var1299, 0) AS var1299 
,coalesce(imp_cdr_j_90_days.var1323, 0) AS var1323 
,coalesce(imp_cdr_j_90_days.var1060, 0) AS var1060 
,coalesce(imp_cdr_j_90_days.var1079, 0) AS var1079 
,coalesce(imp_cdr_j_90_days.var1115, 0) AS var1115 
,coalesce(imp_cdr_j_90_days.var1139, 0) AS var1139 
,coalesce(imp_cdr_j_90_days.var1144, 0) AS var1144 
,coalesce(imp_cdr_j_90_days.var1199, 0) AS var1199 
,coalesce(imp_cdr_j_90_days.var1211, 0) AS var1211 
,coalesce(imp_cdr_j_90_days.var1077, 0) AS var1077 
,coalesce(imp_cdr_j_90_days.var1113, 0) AS var1113 
,coalesce(imp_cdr_j_90_days.var1137, 0) AS var1137 
,coalesce(imp_cdr_j_90_days.var1142, 0) AS var1142 
,coalesce(imp_cdr_j_90_days.var1149, 0) AS var1149 
,coalesce(imp_cdr_j_90_days.var1197, 0) AS var1197 
,coalesce(imp_cdr_j_90_days.var1209, 0) AS var1209 
,coalesce(imp_cdr_j_90_days.var1245, 0) AS var1245 
,coalesce(imp_data_sessions_j_14_days.var127, 0) AS var127 
,coalesce(imp_data_sessions_j_14_days.var134, 0) AS var134 
,coalesce(imp_data_sessions_j_14_days.var141, 0) AS var141 
,coalesce(imp_data_sessions_j_14_days.var135, 0) AS var135 
,coalesce(imp_data_sessions_j_14_days.var142, 0) AS var142 
,coalesce(imp_data_sessions_j_14_days.var139, 0) AS var139 
,coalesce(imp_data_sessions_j_14_days.var146, 0) AS var146 
,coalesce(imp_data_sessions_j_14_days.var130, 0) AS var130 
,coalesce(imp_data_sessions_j_14_days.var137, 0) AS var137 
,coalesce(imp_data_sessions_j_14_days.var144, 0) AS var144 
,coalesce(imp_data_sessions_j_14_days.var131, 0) AS var131 
,coalesce(imp_data_sessions_j_14_days.var138, 0) AS var138 
,coalesce(imp_data_sessions_j_14_days.var145, 0) AS var145 
,coalesce(imp_data_sessions_j_14_days.var129, 0) AS var129 
,coalesce(imp_data_sessions_j_14_days.var136, 0) AS var136 
,coalesce(imp_data_sessions_j_14_days.var143, 0) AS var143 
,coalesce(imp_data_sessions_j_180_days.var29, 0) AS var29 
,coalesce(imp_data_sessions_j_180_days.var30, 0) AS var30 
,coalesce(imp_data_sessions_j_180_days.var27, 0) AS var27 
,coalesce(imp_data_sessions_j_180_days.var25, 0) AS var25 
,coalesce(imp_data_sessions_j_180_days.var26, 0) AS var26 
,coalesce(imp_data_sessions_j_180_days.var24, 0) AS var24 
,coalesce(imp_data_sessions_j_1_day.var211, 0) AS var211 
,coalesce(imp_data_sessions_j_1_day.var218, 0) AS var218 
,coalesce(imp_data_sessions_j_1_day.var225, 0) AS var225 
,coalesce(imp_data_sessions_j_1_day.var219, 0) AS var219 
,coalesce(imp_data_sessions_j_1_day.var226, 0) AS var226 
,coalesce(imp_data_sessions_j_1_day.var216, 0) AS var216 
,coalesce(imp_data_sessions_j_1_day.var223, 0) AS var223 
,coalesce(imp_data_sessions_j_1_day.var230, 0) AS var230 
,coalesce(imp_data_sessions_j_1_day.var214, 0) AS var214 
,coalesce(imp_data_sessions_j_1_day.var221, 0) AS var221 
,coalesce(imp_data_sessions_j_1_day.var228, 0) AS var228 
,coalesce(imp_data_sessions_j_1_day.var215, 0) AS var215 
,coalesce(imp_data_sessions_j_1_day.var222, 0) AS var222 
,coalesce(imp_data_sessions_j_1_day.var229, 0) AS var229 
,coalesce(imp_data_sessions_j_1_day.var213, 0) AS var213 
,coalesce(imp_data_sessions_j_1_day.var220, 0) AS var220 
,coalesce(imp_data_sessions_j_1_day.var227, 0) AS var227 
,coalesce(imp_data_sessions_j_28_days.var106, 0) AS var106 
,coalesce(imp_data_sessions_j_28_days.var113, 0) AS var113 
,coalesce(imp_data_sessions_j_28_days.var120, 0) AS var120 
,coalesce(imp_data_sessions_j_28_days.var114, 0) AS var114 
,coalesce(imp_data_sessions_j_28_days.var121, 0) AS var121 
,coalesce(imp_data_sessions_j_28_days.var111, 0) AS var111 
,coalesce(imp_data_sessions_j_28_days.var125, 0) AS var125 
,coalesce(imp_data_sessions_j_28_days.var109, 0) AS var109 
,coalesce(imp_data_sessions_j_28_days.var116, 0) AS var116 
,coalesce(imp_data_sessions_j_28_days.var123, 0) AS var123 
,coalesce(imp_data_sessions_j_28_days.var124, 0) AS var124 
,coalesce(imp_data_sessions_j_28_days.var108, 0) AS var108 
,coalesce(imp_data_sessions_j_28_days.var115, 0) AS var115 
,coalesce(imp_data_sessions_j_28_days.var122, 0) AS var122 
,coalesce(imp_data_sessions_j_30_days.var85, 0) AS var85 
,coalesce(imp_data_sessions_j_30_days.var92, 0) AS var92 
,coalesce(imp_data_sessions_j_30_days.var99, 0) AS var99 
,coalesce(imp_data_sessions_j_30_days.var93, 0) AS var93 
,coalesce(imp_data_sessions_j_30_days.var100, 0) AS var100 
,coalesce(imp_data_sessions_j_30_days.var90, 0) AS var90 
,coalesce(imp_data_sessions_j_30_days.var97, 0) AS var97 
,coalesce(imp_data_sessions_j_30_days.var104, 0) AS var104 
,coalesce(imp_data_sessions_j_30_days.var88, 0) AS var88 
,coalesce(imp_data_sessions_j_30_days.var95, 0) AS var95 
,coalesce(imp_data_sessions_j_30_days.var102, 0) AS var102 
,coalesce(imp_data_sessions_j_30_days.var96, 0) AS var96 
,coalesce(imp_data_sessions_j_30_days.var103, 0) AS var103 
,coalesce(imp_data_sessions_j_30_days.var87, 0) AS var87 
,coalesce(imp_data_sessions_j_30_days.var94, 0) AS var94 
,coalesce(imp_data_sessions_j_30_days.var101, 0) AS var101 
,coalesce(imp_data_sessions_j_365_days.var1, 0) AS var1 
,coalesce(imp_data_sessions_j_365_days.var15, 0) AS var15 
,coalesce(imp_data_sessions_j_365_days.var9, 0) AS var9 
,coalesce(imp_data_sessions_j_365_days.var16, 0) AS var16 
,coalesce(imp_data_sessions_j_365_days.var13, 0) AS var13 
,coalesce(imp_data_sessions_j_365_days.var20, 0) AS var20 
,coalesce(imp_data_sessions_j_365_days.var14, 0) AS var14 
,coalesce(imp_data_sessions_j_365_days.var4, 0) AS var4 
,coalesce(imp_data_sessions_j_365_days.var11, 0) AS var11 
,coalesce(imp_data_sessions_j_365_days.var18, 0) AS var18 
,coalesce(imp_data_sessions_j_365_days.var12, 0) AS var12 
,coalesce(imp_data_sessions_j_365_days.var19, 0) AS var19 
,coalesce(imp_data_sessions_j_365_days.var3, 0) AS var3 
,coalesce(imp_data_sessions_j_365_days.var10, 0) AS var10 
,coalesce(imp_data_sessions_j_365_days.var17, 0) AS var17 
,coalesce(imp_data_sessions_j_3_days.var190, 0) AS var190 
,coalesce(imp_data_sessions_j_3_days.var197, 0) AS var197 
,coalesce(imp_data_sessions_j_3_days.var204, 0) AS var204 
,coalesce(imp_data_sessions_j_3_days.var198, 0) AS var198 
,coalesce(imp_data_sessions_j_3_days.var205, 0) AS var205 
,coalesce(imp_data_sessions_j_3_days.var195, 0) AS var195 
,coalesce(imp_data_sessions_j_3_days.var209, 0) AS var209 
,coalesce(imp_data_sessions_j_3_days.var193, 0) AS var193 
,coalesce(imp_data_sessions_j_3_days.var200, 0) AS var200 
,coalesce(imp_data_sessions_j_3_days.var207, 0) AS var207 
,coalesce(imp_data_sessions_j_3_days.var194, 0) AS var194 
,coalesce(imp_data_sessions_j_3_days.var208, 0) AS var208 
,coalesce(imp_data_sessions_j_3_days.var192, 0) AS var192 
,coalesce(imp_data_sessions_j_3_days.var199, 0) AS var199 
,coalesce(imp_data_sessions_j_3_days.var206, 0) AS var206 
,coalesce(imp_data_sessions_j_5_days.var169, 0) AS var169 
,coalesce(imp_data_sessions_j_5_days.var176, 0) AS var176 
,coalesce(imp_data_sessions_j_5_days.var183, 0) AS var183 
,coalesce(imp_data_sessions_j_5_days.var177, 0) AS var177 
,coalesce(imp_data_sessions_j_5_days.var184, 0) AS var184 
,coalesce(imp_data_sessions_j_5_days.var174, 0) AS var174 
,coalesce(imp_data_sessions_j_5_days.var181, 0) AS var181 
,coalesce(imp_data_sessions_j_5_days.var188, 0) AS var188 
,coalesce(imp_data_sessions_j_5_days.var172, 0) AS var172 
,coalesce(imp_data_sessions_j_5_days.var179, 0) AS var179 
,coalesce(imp_data_sessions_j_5_days.var186, 0) AS var186 
,coalesce(imp_data_sessions_j_5_days.var173, 0) AS var173 
,coalesce(imp_data_sessions_j_5_days.var180, 0) AS var180 
,coalesce(imp_data_sessions_j_5_days.var187, 0) AS var187 
,coalesce(imp_data_sessions_j_5_days.var171, 0) AS var171 
,coalesce(imp_data_sessions_j_5_days.var178, 0) AS var178 
,coalesce(imp_data_sessions_j_5_days.var185, 0) AS var185 
,coalesce(imp_data_sessions_j_60_days.var64, 0) AS var64 
,coalesce(imp_data_sessions_j_60_days.var71, 0) AS var71 
,coalesce(imp_data_sessions_j_60_days.var78, 0) AS var78 
,coalesce(imp_data_sessions_j_60_days.var72, 0) AS var72 
,coalesce(imp_data_sessions_j_60_days.var79, 0) AS var79 
,coalesce(imp_data_sessions_j_60_days.var69, 0) AS var69 
,coalesce(imp_data_sessions_j_60_days.var76, 0) AS var76 
,coalesce(imp_data_sessions_j_60_days.var83, 0) AS var83 
,coalesce(imp_data_sessions_j_60_days.var67, 0) AS var67 
,coalesce(imp_data_sessions_j_60_days.var74, 0) AS var74 
,coalesce(imp_data_sessions_j_60_days.var81, 0) AS var81 
,coalesce(imp_data_sessions_j_60_days.var68, 0) AS var68 
,coalesce(imp_data_sessions_j_60_days.var75, 0) AS var75 
,coalesce(imp_data_sessions_j_60_days.var82, 0) AS var82 
,coalesce(imp_data_sessions_j_60_days.var66, 0) AS var66 
,coalesce(imp_data_sessions_j_60_days.var73, 0) AS var73 
,coalesce(imp_data_sessions_j_60_days.var80, 0) AS var80 
,coalesce(imp_data_sessions_j_7_days.var148, 0) AS var148 
,coalesce(imp_data_sessions_j_7_days.var155, 0) AS var155 
,coalesce(imp_data_sessions_j_7_days.var162, 0) AS var162 
,coalesce(imp_data_sessions_j_7_days.var156, 0) AS var156 
,coalesce(imp_data_sessions_j_7_days.var163, 0) AS var163 
,coalesce(imp_data_sessions_j_7_days.var153, 0) AS var153 
,coalesce(imp_data_sessions_j_7_days.var160, 0) AS var160 
,coalesce(imp_data_sessions_j_7_days.var167, 0) AS var167 
,coalesce(imp_data_sessions_j_7_days.var151, 0) AS var151 
,coalesce(imp_data_sessions_j_7_days.var158, 0) AS var158 
,coalesce(imp_data_sessions_j_7_days.var165, 0) AS var165 
,coalesce(imp_data_sessions_j_7_days.var152, 0) AS var152 
,coalesce(imp_data_sessions_j_7_days.var159, 0) AS var159 
,coalesce(imp_data_sessions_j_7_days.var166, 0) AS var166 
,coalesce(imp_data_sessions_j_7_days.var150, 0) AS var150 
,coalesce(imp_data_sessions_j_7_days.var157, 0) AS var157 
,coalesce(imp_data_sessions_j_7_days.var164, 0) AS var164 
,coalesce(imp_data_sessions_j_90_days.var43, 0) AS var43 
,coalesce(imp_data_sessions_j_90_days.var50, 0) AS var50 
,coalesce(imp_data_sessions_j_90_days.var57, 0) AS var57 
,coalesce(imp_data_sessions_j_90_days.var51, 0) AS var51 
,coalesce(imp_data_sessions_j_90_days.var58, 0) AS var58 
,coalesce(imp_data_sessions_j_90_days.var48, 0) AS var48 
,coalesce(imp_data_sessions_j_90_days.var55, 0) AS var55 
,coalesce(imp_data_sessions_j_90_days.var62, 0) AS var62 
,coalesce(imp_data_sessions_j_90_days.var46, 0) AS var46 
,coalesce(imp_data_sessions_j_90_days.var53, 0) AS var53 
,coalesce(imp_data_sessions_j_90_days.var60, 0) AS var60 
,coalesce(imp_data_sessions_j_90_days.var47, 0) AS var47 
,coalesce(imp_data_sessions_j_90_days.var54, 0) AS var54 
,coalesce(imp_data_sessions_j_90_days.var61, 0) AS var61 
,coalesce(imp_data_sessions_j_90_days.var45, 0) AS var45 
,coalesce(imp_data_sessions_j_90_days.var52, 0) AS var52 
,coalesce(imp_data_sessions_j_90_days.var59, 0) AS var59 
,coalesce(imp_telco_cust_demographics_j_1_day.var3631, 0) AS var3631 
,imp_telco_cust_demographics_j_1_day.var3632 AS var3632 
,imp_telco_cust_demographics_j_1_day.var3633 AS var3633 
,imp_telco_cust_demographics_j_1_day.var3634 AS var3634 
,imp_telco_cust_demographics_j_1_day.var3635 AS var3635 
,imp_telco_cust_demographics_j_1_day.var3636 AS var3636 
,imp_telco_cust_demographics_j_1_day.var3637 AS var3637 
,imp_telco_cust_demographics_j_1_day.var3638 AS var3638 
,coalesce(imp_top_ups_j_14_days.var358, 0) AS var358 
,coalesce(imp_top_ups_j_14_days.var372, 0) AS var372 
,coalesce(imp_top_ups_j_14_days.var366, 0) AS var366 
,coalesce(imp_top_ups_j_14_days.var373, 0) AS var373 
,coalesce(imp_top_ups_j_14_days.var363, 0) AS var363 
,coalesce(imp_top_ups_j_14_days.var370, 0) AS var370 
,coalesce(imp_top_ups_j_14_days.var377, 0) AS var377 
,coalesce(imp_top_ups_j_14_days.var361, 0) AS var361 
,coalesce(imp_top_ups_j_14_days.var368, 0) AS var368 
,coalesce(imp_top_ups_j_14_days.var375, 0) AS var375 
,coalesce(imp_top_ups_j_14_days.var362, 0) AS var362 
,coalesce(imp_top_ups_j_14_days.var369, 0) AS var369 
,coalesce(imp_top_ups_j_14_days.var376, 0) AS var376 
,coalesce(imp_top_ups_j_14_days.var360, 0) AS var360 
,coalesce(imp_top_ups_j_14_days.var367, 0) AS var367 
,coalesce(imp_top_ups_j_14_days.var374, 0) AS var374 
,coalesce(imp_top_ups_j_180_days.var268, 0) AS var268 
,coalesce(imp_top_ups_j_180_days.var256, 0) AS var256 
,coalesce(imp_top_ups_j_1_day.var442, 0) AS var442 
,coalesce(imp_top_ups_j_1_day.var449, 0) AS var449 
,coalesce(imp_top_ups_j_1_day.var456, 0) AS var456 
,coalesce(imp_top_ups_j_1_day.var450, 0) AS var450 
,coalesce(imp_top_ups_j_1_day.var457, 0) AS var457 
,coalesce(imp_top_ups_j_1_day.var447, 0) AS var447 
,coalesce(imp_top_ups_j_1_day.var454, 0) AS var454 
,coalesce(imp_top_ups_j_1_day.var461, 0) AS var461 
,coalesce(imp_top_ups_j_1_day.var445, 0) AS var445 
,coalesce(imp_top_ups_j_1_day.var452, 0) AS var452 
,coalesce(imp_top_ups_j_1_day.var459, 0) AS var459 
,coalesce(imp_top_ups_j_1_day.var446, 0) AS var446 
,coalesce(imp_top_ups_j_1_day.var453, 0) AS var453 
,coalesce(imp_top_ups_j_1_day.var460, 0) AS var460 
,coalesce(imp_top_ups_j_1_day.var444, 0) AS var444 
,coalesce(imp_top_ups_j_1_day.var451, 0) AS var451 
,coalesce(imp_top_ups_j_1_day.var458, 0) AS var458 
,coalesce(imp_top_ups_j_28_days.var344, 0) AS var344 
,coalesce(imp_top_ups_j_28_days.var342, 0) AS var342 
,coalesce(imp_top_ups_j_28_days.var355, 0) AS var355 
,coalesce(imp_top_ups_j_28_days.var346, 0) AS var346 
,coalesce(imp_top_ups_j_30_days.var323, 0) AS var323 
,coalesce(imp_top_ups_j_30_days.var324, 0) AS var324 
,coalesce(imp_top_ups_j_30_days.var328, 0) AS var328 
,coalesce(imp_top_ups_j_30_days.var319, 0) AS var319 
,coalesce(imp_top_ups_j_30_days.var326, 0) AS var326 
,coalesce(imp_top_ups_j_30_days.var327, 0) AS var327 
,coalesce(imp_top_ups_j_30_days.var318, 0) AS var318 
,coalesce(imp_top_ups_j_30_days.var325, 0) AS var325 
,coalesce(imp_top_ups_j_365_days.var232, 0) AS var232 
,coalesce(imp_top_ups_j_365_days.var239, 0) AS var239 
,coalesce(imp_top_ups_j_365_days.var246, 0) AS var246 
,coalesce(imp_top_ups_j_365_days.var240, 0) AS var240 
,coalesce(imp_top_ups_j_365_days.var247, 0) AS var247 
,coalesce(imp_top_ups_j_365_days.var237, 0) AS var237 
,coalesce(imp_top_ups_j_365_days.var244, 0) AS var244 
,coalesce(imp_top_ups_j_365_days.var251, 0) AS var251 
,coalesce(imp_top_ups_j_365_days.var235, 0) AS var235 
,coalesce(imp_top_ups_j_365_days.var242, 0) AS var242 
,coalesce(imp_top_ups_j_365_days.var249, 0) AS var249 
,coalesce(imp_top_ups_j_365_days.var236, 0) AS var236 
,coalesce(imp_top_ups_j_365_days.var243, 0) AS var243 
,coalesce(imp_top_ups_j_365_days.var250, 0) AS var250 
,coalesce(imp_top_ups_j_365_days.var234, 0) AS var234 
,coalesce(imp_top_ups_j_365_days.var241, 0) AS var241 
,coalesce(imp_top_ups_j_365_days.var248, 0) AS var248 
,coalesce(imp_top_ups_j_3_days.var421, 0) AS var421 
,coalesce(imp_top_ups_j_3_days.var428, 0) AS var428 
,coalesce(imp_top_ups_j_3_days.var435, 0) AS var435 
,coalesce(imp_top_ups_j_3_days.var429, 0) AS var429 
,coalesce(imp_top_ups_j_3_days.var436, 0) AS var436 
,coalesce(imp_top_ups_j_3_days.var426, 0) AS var426 
,coalesce(imp_top_ups_j_3_days.var440, 0) AS var440 
,coalesce(imp_top_ups_j_3_days.var424, 0) AS var424 
,coalesce(imp_top_ups_j_3_days.var431, 0) AS var431 
,coalesce(imp_top_ups_j_3_days.var438, 0) AS var438 
,coalesce(imp_top_ups_j_3_days.var425, 0) AS var425 
,coalesce(imp_top_ups_j_3_days.var439, 0) AS var439 
,coalesce(imp_top_ups_j_3_days.var423, 0) AS var423 
,coalesce(imp_top_ups_j_3_days.var430, 0) AS var430 
,coalesce(imp_top_ups_j_3_days.var437, 0) AS var437 
,coalesce(imp_top_ups_j_5_days.var400, 0) AS var400 
,coalesce(imp_top_ups_j_5_days.var407, 0) AS var407 
,coalesce(imp_top_ups_j_5_days.var414, 0) AS var414 
,coalesce(imp_top_ups_j_5_days.var408, 0) AS var408 
,coalesce(imp_top_ups_j_5_days.var415, 0) AS var415 
,coalesce(imp_top_ups_j_5_days.var412, 0) AS var412 
,coalesce(imp_top_ups_j_5_days.var419, 0) AS var419 
,coalesce(imp_top_ups_j_5_days.var410, 0) AS var410 
,coalesce(imp_top_ups_j_5_days.var417, 0) AS var417 
,coalesce(imp_top_ups_j_5_days.var411, 0) AS var411 
,coalesce(imp_top_ups_j_5_days.var418, 0) AS var418 
,coalesce(imp_top_ups_j_5_days.var409, 0) AS var409 
,coalesce(imp_top_ups_j_5_days.var416, 0) AS var416 
,coalesce(imp_top_ups_j_60_days.var295, 0) AS var295 
,coalesce(imp_top_ups_j_60_days.var303, 0) AS var303 
,coalesce(imp_top_ups_j_60_days.var310, 0) AS var310 
,coalesce(imp_top_ups_j_60_days.var300, 0) AS var300 
,coalesce(imp_top_ups_j_60_days.var307, 0) AS var307 
,coalesce(imp_top_ups_j_60_days.var298, 0) AS var298 
,coalesce(imp_top_ups_j_60_days.var305, 0) AS var305 
,coalesce(imp_top_ups_j_60_days.var312, 0) AS var312 
,coalesce(imp_top_ups_j_60_days.var299, 0) AS var299 
,coalesce(imp_top_ups_j_60_days.var306, 0) AS var306 
,coalesce(imp_top_ups_j_60_days.var313, 0) AS var313 
,coalesce(imp_top_ups_j_60_days.var297, 0) AS var297 
,coalesce(imp_top_ups_j_60_days.var304, 0) AS var304 
,coalesce(imp_top_ups_j_60_days.var311, 0) AS var311 
,coalesce(imp_top_ups_j_7_days.var379, 0) AS var379 
,coalesce(imp_top_ups_j_7_days.var386, 0) AS var386 
,coalesce(imp_top_ups_j_7_days.var387, 0) AS var387 
,coalesce(imp_top_ups_j_7_days.var384, 0) AS var384 
,coalesce(imp_top_ups_j_7_days.var391, 0) AS var391 
,coalesce(imp_top_ups_j_7_days.var382, 0) AS var382 
,coalesce(imp_top_ups_j_7_days.var389, 0) AS var389 
,coalesce(imp_top_ups_j_7_days.var383, 0) AS var383 
,coalesce(imp_top_ups_j_7_days.var390, 0) AS var390 
,coalesce(imp_top_ups_j_7_days.var397, 0) AS var397 
,coalesce(imp_top_ups_j_7_days.var381, 0) AS var381 
,coalesce(imp_top_ups_j_7_days.var388, 0) AS var388 
,coalesce(imp_top_ups_j_90_days.var281, 0) AS var281 
,coalesce(imp_top_ups_j_90_days.var282, 0) AS var282 
,coalesce(imp_top_ups_j_90_days.var289, 0) AS var289 
,coalesce(imp_top_ups_j_90_days.var286, 0) AS var286 
,coalesce(imp_top_ups_j_90_days.var293, 0) AS var293 
,coalesce(imp_top_ups_j_90_days.var284, 0) AS var284 
,coalesce(imp_top_ups_j_90_days.var291, 0) AS var291 
,coalesce(imp_top_ups_j_90_days.var285, 0) AS var285 
,coalesce(imp_top_ups_j_90_days.var292, 0) AS var292 
,coalesce(imp_top_ups_j_90_days.var276, 0) AS var276 
,coalesce(imp_top_ups_j_90_days.var283, 0) AS var283 
,coalesce(imp_top_ups_j_90_days.var290, 0) AS var290 
FROM db_202104011224669309_telco.imp_target_churn tgt 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,MIN(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_duration 
ELSE NULL 
END) AS var2307 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '14' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_14_days ON tgt.msdin = imp_cdr_j_14_days.msdin 
AND tgt.event_date = imp_cdr_j_14_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var811 
,SUM(CASE 
WHEN side_a_operator = 'E' 
THEN 1 
ELSE 0 
END) AS var871 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var895 
,SUM(CASE 
WHEN side_a_operator = 'A' 
AND call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var1015 
,coalesce(SUM(CASE 
WHEN call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var812 
,coalesce(SUM(CASE 
WHEN side_a_operator = 'E' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var872 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var896 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var920 
,coalesce(SUM(CASE 
WHEN side_a_operator = 'A' 
AND call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var1016 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.call_volume 
ELSE 0 
END) AS var756 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE 0 
END) AS var840 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE 0 
END) AS var912 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE 0 
END) AS var1013 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var774 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var930 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var954 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var966 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var1014 
,coalesce(SUM(CASE 
WHEN side_a_operator = 'A' 
AND call_type = 'media' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var1026 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var1038 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE NULL 
END) AS var771 
,MIN(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var855 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var951 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var963 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var1011 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.call_volume 
ELSE NULL 
END) AS var755 
,MAX(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var827 
,MAX(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var839 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var911 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.call_volume 
ELSE NULL 
END) AS var753 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_volume 
ELSE NULL 
END) AS var765 
,AVG(CASE 
WHEN call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var806 
,AVG(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var825 
,AVG(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var837 
,AVG(CASE 
WHEN side_a_operator = 'E' 
THEN src.call_duration 
ELSE NULL 
END) AS var878 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var909 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '180' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_180_days ON tgt.msdin = imp_cdr_j_180_days.msdin 
AND tgt.event_date = imp_cdr_j_180_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var3367 
,SUM(CASE 
WHEN time_of_day = 'peak' 
THEN 1 
ELSE 0 
END) AS var3415 
,SUM(CASE 
WHEN side_b_operator = 'B' 
THEN 1 
ELSE 0 
END) AS var3439 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var3523 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN 1 
ELSE 0 
END) AS var3535 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN 1 
ELSE 0 
END) AS var3547 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var3559 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN 1 
ELSE 0 
END) AS var3595 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN 1 
ELSE 0 
END) AS var3619 
,coalesce(SUM(CASE 
WHEN call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3368 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3416 
,coalesce(SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3428 
,coalesce(SUM(CASE 
WHEN side_b_operator = 'B' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3440 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3512 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3524 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3536 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3548 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3596 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3620 
,SUM(CASE 
WHEN call_type = 'sms' 
THEN src.call_duration 
ELSE 0 
END) AS var3377 
,SUM(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_duration 
ELSE 0 
END) AS var3425 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_duration 
ELSE 0 
END) AS var3521 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE 0 
END) AS var3545 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE 0 
END) AS var3557 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE 0 
END) AS var3629 
,MIN(CASE 
WHEN call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3399 
,MIN(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3423 
,MIN(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3435 
,MIN(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3447 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3507 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3519 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3543 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3555 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3603 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3627 
,MAX(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3424 
,MAX(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3448 
,MAX(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3544 
,MAX(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3556 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3604 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3628 
,AVG(CASE 
WHEN call_type = 'sms' 
THEN src.call_duration 
ELSE NULL 
END) AS var3374 
,AVG(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3422 
,AVG(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3446 
,AVG(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3542 
,AVG(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3554 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3602 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3626 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '1' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_1_day ON tgt.msdin = imp_cdr_j_1_day.msdin 
AND tgt.event_date = imp_cdr_j_1_day.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var2061 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '28' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_28_days ON tgt.msdin = imp_cdr_j_28_days.msdin 
AND tgt.event_date = imp_cdr_j_28_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE 0 
END) AS var1637 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '30' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_30_days ON tgt.msdin = imp_cdr_j_30_days.msdin 
AND tgt.event_date = imp_cdr_j_30_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN call_type = 'g' 
THEN 1 
ELSE 0 
END) AS var499 
,SUM(CASE 
WHEN call_type = 'voice' 
THEN 1 
ELSE 0 
END) AS var511 
,SUM(CASE 
WHEN call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var523 
,SUM(CASE 
WHEN time_of_day = 'peak' 
THEN 1 
ELSE 0 
END) AS var535 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN 1 
ELSE 0 
END) AS var547 
,SUM(CASE 
WHEN side_b_operator = 'B' 
THEN 1 
ELSE 0 
END) AS var559 
,SUM(CASE 
WHEN side_a_operator = 'E' 
THEN 1 
ELSE 0 
END) AS var583 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var595 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var607 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var679 
,SUM(CASE 
WHEN side_a_operator = 'A' 
AND call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var727 
,coalesce(SUM(CASE 
WHEN call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var488 
,coalesce(SUM(CASE 
WHEN call_type = 'g' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var500 
,coalesce(SUM(CASE 
WHEN call_type = 'voice' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var512 
,coalesce(SUM(CASE 
WHEN call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var524 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var536 
,coalesce(SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var548 
,coalesce(SUM(CASE 
WHEN side_a_operator = 'E' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var584 
,coalesce(SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var596 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var608 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var632 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var656 
,coalesce(SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var680 
,coalesce(SUM(CASE 
WHEN side_a_operator = 'A' 
AND call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var728 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.call_volume 
ELSE 0 
END) AS var468 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_volume 
ELSE 0 
END) AS var480 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE 0 
END) AS var485 
,SUM(CASE 
WHEN call_type = 'g' 
THEN src.call_volume 
ELSE 0 
END) AS var504 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE 0 
END) AS var552 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE 0 
END) AS var557 
,SUM(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_volume 
ELSE 0 
END) AS var564 
,SUM(CASE 
WHEN side_a_operator = 'E' 
THEN src.call_duration 
ELSE 0 
END) AS var593 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE 0 
END) AS var624 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE 0 
END) AS var749 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_volume * 1.0000 
ELSE 0 
END) / nullif(SUM(call_volume), 0), 0) AS var481 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var486 
,coalesce(SUM(CASE 
WHEN call_type = 'g' 
THEN src.call_volume * 1.0000 
ELSE 0 
END) / nullif(SUM(call_volume), 0), 0) AS var505 
,coalesce(SUM(CASE 
WHEN call_type = 'voice' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var522 
,coalesce(SUM(CASE 
WHEN call_type = 'media' 
THEN src.call_volume * 1.0000 
ELSE 0 
END) / nullif(SUM(call_volume), 0), 0) AS var529 
,coalesce(SUM(CASE 
WHEN call_type = 'media' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var534 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume * 1.0000 
ELSE 0 
END) / nullif(SUM(call_volume), 0), 0) AS var625 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var642 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var666 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var678 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var726 
,coalesce(SUM(CASE 
WHEN side_a_operator = 'A' 
AND call_type = 'media' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var738 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration * 1.0000 
ELSE 0 
END) / nullif(SUM(call_duration), 0), 0) AS var750 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.call_duration 
ELSE NULL 
END) AS var471 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE NULL 
END) AS var483 
,MIN(CASE 
WHEN call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var519 
,MIN(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var555 
,MIN(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var567 
,MIN(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_duration 
ELSE NULL 
END) AS var579 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var627 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var663 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var675 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var723 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.call_volume 
ELSE NULL 
END) AS var467 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.call_duration 
ELSE NULL 
END) AS var472 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_volume 
ELSE NULL 
END) AS var479 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE NULL 
END) AS var484 
,MAX(CASE 
WHEN call_type = 'g' 
THEN src.call_volume 
ELSE NULL 
END) AS var503 
,MAX(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var539 
,MAX(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var551 
,MAX(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_volume 
ELSE NULL 
END) AS var563 
,MAX(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_duration 
ELSE NULL 
END) AS var580 
,MAX(CASE 
WHEN side_a_operator = 'E' 
THEN src.call_duration 
ELSE NULL 
END) AS var592 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var623 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.call_volume 
ELSE NULL 
END) AS var465 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.call_duration 
ELSE NULL 
END) AS var470 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_volume 
ELSE NULL 
END) AS var477 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE NULL 
END) AS var482 
,AVG(CASE 
WHEN call_type = 'g' 
THEN src.call_volume 
ELSE NULL 
END) AS var501 
,AVG(CASE 
WHEN call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var518 
,AVG(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var537 
,AVG(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var542 
,AVG(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var549 
,AVG(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var554 
,AVG(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_volume 
ELSE NULL 
END) AS var561 
,AVG(CASE 
WHEN side_a_operator = 'E' 
THEN src.call_duration 
ELSE NULL 
END) AS var590 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var621 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var633 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '365' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_365_days ON tgt.msdin = imp_cdr_j_365_days.msdin 
AND tgt.event_date = imp_cdr_j_365_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var3079 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN 1 
ELSE 0 
END) AS var3139 
,SUM(CASE 
WHEN side_b_operator = 'C' 
THEN 1 
ELSE 0 
END) AS var3163 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN 1 
ELSE 0 
END) AS var3211 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN 1 
ELSE 0 
END) AS var3259 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var3271 
,SUM(CASE 
WHEN side_b_operator = 'B' 
AND call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var3283 
,coalesce(SUM(CASE 
WHEN call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3080 
,coalesce(SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3140 
,coalesce(SUM(CASE 
WHEN side_b_operator = 'B' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3152 
,coalesce(SUM(CASE 
WHEN side_b_operator = 'C' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3164 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3212 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3236 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3260 
,coalesce(SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3272 
,coalesce(SUM(CASE 
WHEN side_b_operator = 'B' 
AND call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var3284 
,SUM(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_duration 
ELSE 0 
END) AS var3161 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE 0 
END) AS var3221 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE 0 
END) AS var3269 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE 0 
END) AS var3281 
,MIN(CASE 
WHEN call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3111 
,MIN(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3147 
,MIN(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3159 
,MIN(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_duration 
ELSE NULL 
END) AS var3171 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3219 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3267 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3315 
,MAX(CASE 
WHEN call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var3112 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3220 
,MAX(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3268 
,AVG(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3146 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var3218 
,AVG(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var3266 
,AVG(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE NULL 
END) AS var3278 
,AVG(CASE 
WHEN side_b_operator = 'B' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE NULL 
END) AS var3290 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '3' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_3_days ON tgt.msdin = imp_cdr_j_3_days.msdin 
AND tgt.event_date = imp_cdr_j_3_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN 1 
ELSE 0 
END) AS var2851 
,SUM(CASE 
WHEN side_b_operator = 'C' 
THEN 1 
ELSE 0 
END) AS var2875 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN 1 
ELSE 0 
END) AS var2923 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var2947 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN 1 
ELSE 0 
END) AS var2971 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var2983 
,SUM(CASE 
WHEN side_b_operator = 'B' 
AND call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var2995 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var2924 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var2972 
,coalesce(SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var2984 
,coalesce(SUM(CASE 
WHEN side_b_operator = 'B' 
AND call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var2996 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE 0 
END) AS var2933 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE 0 
END) AS var2981 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE 0 
END) AS var2993 
,SUM(CASE 
WHEN side_b_operator = 'B' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE 0 
END) AS var3005 
,MIN(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var2859 
,MIN(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_duration 
ELSE NULL 
END) AS var2883 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var2931 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var2979 
,MIN(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE NULL 
END) AS var2991 
,MIN(CASE 
WHEN side_b_operator = 'B' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE NULL 
END) AS var3003 
,MAX(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_duration 
ELSE NULL 
END) AS var2884 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var2932 
,MAX(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var2980 
,MAX(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE NULL 
END) AS var2992 
,AVG(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_duration 
ELSE NULL 
END) AS var2882 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var2930 
,AVG(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var2978 
,AVG(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE NULL 
END) AS var2990 
,AVG(CASE 
WHEN side_b_operator = 'B' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE NULL 
END) AS var3002 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '5' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_5_days ON tgt.msdin = imp_cdr_j_5_days.msdin 
AND tgt.event_date = imp_cdr_j_5_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.call_volume 
ELSE 0 
END) AS var1332 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_volume 
ELSE 0 
END) AS var1344 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE 0 
END) AS var1349 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_volume 
ELSE 0 
END) AS var1500 
,MIN(CASE 
WHEN call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var1383 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var1503 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var1527 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var1587 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var1611 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.call_volume 
ELSE NULL 
END) AS var1331 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_volume 
ELSE NULL 
END) AS var1343 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var1499 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.call_volume 
ELSE NULL 
END) AS var1329 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_volume 
ELSE NULL 
END) AS var1341 
,AVG(CASE 
WHEN call_type = 'g' 
THEN src.call_volume 
ELSE NULL 
END) AS var1365 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var1497 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '60' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_60_days ON tgt.msdin = imp_cdr_j_60_days.msdin 
AND tgt.event_date = imp_cdr_j_60_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN 1 
ELSE 0 
END) AS var2695 
,coalesce(SUM(CASE 
WHEN time_of_day = 'off-peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var2564 
,coalesce(SUM(CASE 
WHEN side_b_operator = 'C' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var2588 
,coalesce(SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var2696 
,coalesce(SUM(CASE 
WHEN side_b_operator = 'B' 
AND call_type = 'sms' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var2708 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'sms' 
THEN src.call_duration 
ELSE 0 
END) AS var2705 
,MIN(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var2559 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var2691 
,MAX(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_duration 
ELSE NULL 
END) AS var2596 
,AVG(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_duration 
ELSE NULL 
END) AS var2594 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '7' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_7_days ON tgt.msdin = imp_cdr_j_7_days.msdin 
AND tgt.event_date = imp_cdr_j_7_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var1039 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN 1 
ELSE 0 
END) AS var1051 
,SUM(CASE 
WHEN call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var1099 
,SUM(CASE 
WHEN side_a_operator = 'E' 
THEN 1 
ELSE 0 
END) AS var1159 
,SUM(CASE 
WHEN time_of_day = 'off-peak' 
AND call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var1171 
,SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var1183 
,SUM(CASE 
WHEN side_a_operator = 'A' 
AND call_type = 'media' 
THEN 1 
ELSE 0 
END) AS var1303 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var1052 
,coalesce(SUM(CASE 
WHEN call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var1100 
,coalesce(SUM(CASE 
WHEN side_b_operator = 'C' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var1148 
,coalesce(SUM(CASE 
WHEN side_a_operator = 'E' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var1160 
,coalesce(SUM(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var1184 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var1196 
,coalesce(SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var1208 
,coalesce(SUM(CASE 
WHEN side_a_operator = 'A' 
AND call_type = 'media' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var1304 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE 0 
END) AS var1061 
,SUM(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_volume 
ELSE 0 
END) AS var1116 
,SUM(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_volume 
ELSE 0 
END) AS var1140 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE 0 
END) AS var1200 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_volume 
ELSE 0 
END) AS var1212 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_duration 
ELSE 0 
END) AS var1217 
,SUM(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE 0 
END) AS var1301 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE NULL 
END) AS var1059 
,MIN(CASE 
WHEN call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var1095 
,MIN(CASE 
WHEN time_of_day = 'off-peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var1131 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_duration 
ELSE NULL 
END) AS var1215 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var1239 
,MIN(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var1251 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var1299 
,MIN(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
AND call_type = 'voice' 
THEN src.call_duration 
ELSE NULL 
END) AS var1323 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
THEN src.call_duration 
ELSE NULL 
END) AS var1060 
,MAX(CASE 
WHEN call_type = 'g' 
THEN src.call_volume 
ELSE NULL 
END) AS var1079 
,MAX(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var1115 
,MAX(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_volume 
ELSE NULL 
END) AS var1139 
,MAX(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var1144 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var1199 
,MAX(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var1211 
,AVG(CASE 
WHEN call_type = 'g' 
THEN src.call_volume 
ELSE NULL 
END) AS var1077 
,AVG(CASE 
WHEN time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var1113 
,AVG(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_volume 
ELSE NULL 
END) AS var1137 
,AVG(CASE 
WHEN side_b_operator = 'B' 
THEN src.call_duration 
ELSE NULL 
END) AS var1142 
,AVG(CASE 
WHEN side_b_operator = 'C' 
THEN src.call_volume 
ELSE NULL 
END) AS var1149 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'off-peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var1197 
,AVG(CASE 
WHEN inb_outb_indicator = 'inb' 
AND time_of_day = 'peak' 
THEN src.call_volume 
ELSE NULL 
END) AS var1209 
,AVG(CASE 
WHEN time_of_day = 'peak' 
AND side_b_operator = 'B' 
THEN src.call_volume 
ELSE NULL 
END) AS var1245 
FROM db_202104011224669309_telco.imp_cdr_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.call_dt BETWEEN (tgt.event_date - interval '90' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_cdr_j_90_days ON tgt.msdin = imp_cdr_j_90_days.msdin 
AND tgt.event_date = imp_cdr_j_90_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var127 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var134 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var141 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var135 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var142 
,SUM(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE 0 
END) AS var139 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var146 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var130 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var137 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var144 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var131 
,MAX(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var138 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var145 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var129 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var136 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var143 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '14' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_14_days ON tgt.msdin = imp_data_sessions_j_14_days.msdin 
AND tgt.event_date = imp_data_sessions_j_14_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var29 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var30 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE 0 
END) AS var27 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var25 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var26 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var24 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '180' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_180_days ON tgt.msdin = imp_data_sessions_j_180_days.msdin 
AND tgt.event_date = imp_data_sessions_j_180_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var211 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var218 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var225 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var219 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var226 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE 0 
END) AS var216 
,SUM(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE 0 
END) AS var223 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var230 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var214 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var221 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var228 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var215 
,MAX(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var222 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var229 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var213 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var220 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var227 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '1' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_1_day ON tgt.msdin = imp_data_sessions_j_1_day.msdin 
AND tgt.event_date = imp_data_sessions_j_1_day.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var106 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var113 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var120 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var114 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var121 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE 0 
END) AS var111 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var125 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var109 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var116 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var123 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var124 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var108 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var115 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var122 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '28' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_28_days ON tgt.msdin = imp_data_sessions_j_28_days.msdin 
AND tgt.event_date = imp_data_sessions_j_28_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var85 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var92 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var99 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var93 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var100 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE 0 
END) AS var90 
,SUM(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE 0 
END) AS var97 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var104 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var88 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var95 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var102 
,MAX(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var96 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var103 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var87 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var94 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var101 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '30' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_30_days ON tgt.msdin = imp_data_sessions_j_30_days.msdin 
AND tgt.event_date = imp_data_sessions_j_30_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var1 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var15 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var9 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var16 
,SUM(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE 0 
END) AS var13 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var20 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN src.data_volume * 1.0000 
ELSE 0 
END) / nullif(SUM(data_volume), 0), 0) AS var14 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var4 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var11 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var18 
,MAX(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var12 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var19 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var3 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var10 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var17 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '365' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_365_days ON tgt.msdin = imp_data_sessions_j_365_days.msdin 
AND tgt.event_date = imp_data_sessions_j_365_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var190 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var197 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var204 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var198 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var205 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE 0 
END) AS var195 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var209 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var193 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var200 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var207 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var194 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var208 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var192 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var199 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var206 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '3' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_3_days ON tgt.msdin = imp_data_sessions_j_3_days.msdin 
AND tgt.event_date = imp_data_sessions_j_3_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var169 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var176 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var183 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var177 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var184 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE 0 
END) AS var174 
,SUM(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE 0 
END) AS var181 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var188 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var172 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var179 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var186 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var173 
,MAX(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var180 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var187 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var171 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var178 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var185 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '5' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_5_days ON tgt.msdin = imp_data_sessions_j_5_days.msdin 
AND tgt.event_date = imp_data_sessions_j_5_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var64 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var71 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var78 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var72 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var79 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE 0 
END) AS var69 
,SUM(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE 0 
END) AS var76 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var83 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var67 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var74 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var81 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var68 
,MAX(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var75 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var82 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var66 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var73 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var80 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '60' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_60_days ON tgt.msdin = imp_data_sessions_j_60_days.msdin 
AND tgt.event_date = imp_data_sessions_j_60_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var148 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var155 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var162 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var156 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var163 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE 0 
END) AS var153 
,SUM(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE 0 
END) AS var160 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var167 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var151 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var158 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var165 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var152 
,MAX(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var159 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var166 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var150 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var157 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var164 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '7' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_7_days ON tgt.msdin = imp_data_sessions_j_7_days.msdin 
AND tgt.event_date = imp_data_sessions_j_7_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var43 
,SUM(CASE 
WHEN direction = 'up' 
THEN 1 
ELSE 0 
END) AS var50 
,SUM(CASE 
WHEN direction = 'down' 
THEN 1 
ELSE 0 
END) AS var57 
,coalesce(SUM(CASE 
WHEN direction = 'up' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var51 
,coalesce(SUM(CASE 
WHEN direction = 'down' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var58 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE 0 
END) AS var48 
,SUM(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE 0 
END) AS var55 
,SUM(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE 0 
END) AS var62 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var46 
,MIN(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var53 
,MIN(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var60 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var47 
,MAX(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var54 
,MAX(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var61 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.data_volume 
ELSE NULL 
END) AS var45 
,AVG(CASE 
WHEN direction = 'up' 
THEN src.data_volume 
ELSE NULL 
END) AS var52 
,AVG(CASE 
WHEN direction = 'down' 
THEN src.data_volume 
ELSE NULL 
END) AS var59 
FROM db_202104011224669309_telco.imp_data_sessions_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.session_dt BETWEEN (tgt.event_date - interval '90' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_data_sessions_j_90_days ON tgt.msdin = imp_data_sessions_j_90_days.msdin 
AND tgt.event_date = imp_data_sessions_j_90_days.event_date 
LEFT JOIN ( 
SELECT A.msdin AS msdin 
,A.event_date AS event_date 
,(B.user_online_id) AS var3631 
,(B.customer_acqusition_segment) AS var3632 
,(B.first_tariff) AS var3633 
,(B.gender) AS var3634 
,(B.region) AS var3635 
,(B.payment_method) AS var3636 
,(B.port_in_flg) AS var3637 
,(B.acquisition_channel) AS var3638 
FROM db_202104011224669309_telco.imp_target_churn A 
LEFT JOIN ( 
SELECT DISTINCT tgt.msdin AS tgt_msdin 
,tgt.event_date AS tgt_event_date 
,ROW_NUMBER() OVER ( 
PARTITION BY tgt.msdin 
,tgt.event_date ORDER BY src.record_date DESC 
) AS row_num_1 
,src.* 
FROM db_202104011224669309_telco.imp_target_churn tgt 
INNER JOIN db_202104011224669309_telco.imp_telco_cust_demographics_j src ON tgt.msdin = src.msdin 
AND src.record_date <= tgt.event_date 
) B ON A.msdin = B.tgt_msdin 
AND A.event_date = B.tgt_event_date 
AND row_num_1 = 1 
WHERE A.msdin IS NOT NULL 
) imp_telco_cust_demographics_j_1_day ON tgt.msdin = imp_telco_cust_demographics_j_1_day.msdin 
AND tgt.event_date = imp_telco_cust_demographics_j_1_day.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var358 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1 
ELSE 0 
END) AS var372 
,coalesce(SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var366 
,coalesce(SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var373 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE 0 
END) AS var363 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE 0 
END) AS var370 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE 0 
END) AS var377 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var361 
,MIN(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var368 
,MIN(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var375 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var362 
,MAX(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var369 
,MAX(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var376 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var360 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var367 
,AVG(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var374 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '14' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_14_days ON tgt.msdin = imp_top_ups_j_14_days.msdin 
AND tgt.event_date = imp_top_ups_j_14_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,coalesce(SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var268 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var256 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '180' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_180_days ON tgt.msdin = imp_top_ups_j_180_days.msdin 
AND tgt.event_date = imp_top_ups_j_180_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var442 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1 
ELSE 0 
END) AS var449 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1 
ELSE 0 
END) AS var456 
,coalesce(SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var450 
,coalesce(SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var457 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE 0 
END) AS var447 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE 0 
END) AS var454 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE 0 
END) AS var461 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var445 
,MIN(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var452 
,MIN(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var459 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var446 
,MAX(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var453 
,MAX(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var460 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var444 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var451 
,AVG(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var458 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '1' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_1_day ON tgt.msdin = imp_top_ups_j_1_day.msdin 
AND tgt.event_date = imp_top_ups_j_1_day.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1 
ELSE 0 
END) AS var344 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE 0 
END) AS var342 
,MAX(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var355 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var346 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '28' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_28_days ON tgt.msdin = imp_top_ups_j_28_days.msdin 
AND tgt.event_date = imp_top_ups_j_28_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1 
ELSE 0 
END) AS var323 
,coalesce(SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var324 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE 0 
END) AS var328 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var319 
,MIN(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var326 
,MAX(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var327 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var318 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var325 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '30' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_30_days ON tgt.msdin = imp_top_ups_j_30_days.msdin 
AND tgt.event_date = imp_top_ups_j_30_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var232 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1 
ELSE 0 
END) AS var239 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1 
ELSE 0 
END) AS var246 
,coalesce(SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var240 
,coalesce(SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var247 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE 0 
END) AS var237 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE 0 
END) AS var244 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE 0 
END) AS var251 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var235 
,MIN(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var242 
,MIN(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var249 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var236 
,MAX(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var243 
,MAX(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var250 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var234 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var241 
,AVG(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var248 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '365' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_365_days ON tgt.msdin = imp_top_ups_j_365_days.msdin 
AND tgt.event_date = imp_top_ups_j_365_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var421 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1 
ELSE 0 
END) AS var428 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1 
ELSE 0 
END) AS var435 
,coalesce(SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var429 
,coalesce(SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var436 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE 0 
END) AS var426 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE 0 
END) AS var440 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var424 
,MIN(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var431 
,MIN(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var438 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var425 
,MAX(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var439 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var423 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var430 
,AVG(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var437 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '3' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_3_days ON tgt.msdin = imp_top_ups_j_3_days.msdin 
AND tgt.event_date = imp_top_ups_j_3_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var400 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1 
ELSE 0 
END) AS var407 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1 
ELSE 0 
END) AS var414 
,coalesce(SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var408 
,coalesce(SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var415 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE 0 
END) AS var412 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE 0 
END) AS var419 
,MIN(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var410 
,MIN(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var417 
,MAX(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var411 
,MAX(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var418 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var409 
,AVG(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var416 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '5' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_5_days ON tgt.msdin = imp_top_ups_j_5_days.msdin 
AND tgt.event_date = imp_top_ups_j_5_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var295 
,coalesce(SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var303 
,coalesce(SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var310 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE 0 
END) AS var300 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE 0 
END) AS var307 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var298 
,MIN(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var305 
,MIN(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var312 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var299 
,MAX(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var306 
,MAX(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var313 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var297 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var304 
,AVG(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var311 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '60' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_60_days ON tgt.msdin = imp_top_ups_j_60_days.msdin 
AND tgt.event_date = imp_top_ups_j_60_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN 1 
ELSE 0 
END) AS var379 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1 
ELSE 0 
END) AS var386 
,coalesce(SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var387 
,SUM(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE 0 
END) AS var384 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE 0 
END) AS var391 
,MIN(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var382 
,MIN(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var389 
,MAX(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var383 
,MAX(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var390 
,MAX(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var397 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var381 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var388 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '7' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_7_days ON tgt.msdin = imp_top_ups_j_7_days.msdin 
AND tgt.event_date = imp_top_ups_j_7_days.event_date 
LEFT JOIN ( 
SELECT tgt.msdin 
,tgt.event_date 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1 
ELSE 0 
END) AS var281 
,coalesce(SUM(CASE 
WHEN topup_channel = 'store' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var282 
,coalesce(SUM(CASE 
WHEN topup_channel = 'online' 
THEN 1.0000 
ELSE 0 
END) / nullif(SUM(1), 0), 0) AS var289 
,SUM(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE 0 
END) AS var286 
,SUM(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE 0 
END) AS var293 
,MIN(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var284 
,MIN(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var291 
,MAX(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var285 
,MAX(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var292 
,AVG(CASE 
WHEN TRUE = TRUE 
THEN src.topup_amount 
ELSE NULL 
END) AS var276 
,AVG(CASE 
WHEN topup_channel = 'store' 
THEN src.topup_amount 
ELSE NULL 
END) AS var283 
,AVG(CASE 
WHEN topup_channel = 'online' 
THEN src.topup_amount 
ELSE NULL 
END) AS var290 
FROM db_202104011224669309_telco.imp_top_ups_j src 
INNER JOIN db_202104011224669309_telco.imp_target_churn tgt ON tgt.msdin = src.msdin 
WHERE src.topup_date BETWEEN (tgt.event_date - interval '90' day) 
AND (tgt.event_date) 
GROUP BY tgt.msdin 
,tgt.event_date 
) imp_top_ups_j_90_days ON tgt.msdin = imp_top_ups_j_90_days.msdin 
AND tgt.event_date = imp_top_ups_j_90_days.event_date; 