## Get services that are hosted by svchost.exe and show details of dll providing service from the registry

gcim win32_service | ? pathname -match '\\svchost\.exe\b' | % { $dll=gp "HKLM:SYSTEM\CurrentControlSet\Services\$($_.name)\Parameters" -name ServiceDll|Select -expand Servicedll ; select -InputObject $_ name,displayname,state,pathname,@{n='dll';e={ $dll }},@{n='vendor';e={ gp $dll | Select -expand versioninfo | select -expand companyname}},@{n='Signing';e={Get-AuthenticodeSignature $dll -EA 0 | Select -ExpandProperty Status }}}