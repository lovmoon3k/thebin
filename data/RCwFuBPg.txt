SELECT CONTEST AS contest_id, KIND AS kind_id,
DENSE_RANK() OVER (PARTITION BY CONTEST, KIND ORDER BY p.MARK DESC ROWS UNBOUNDED PRECEDING ) AS place, TEAM AS team
FROM POINTS p
JOIN CONTESTS c, TEAMS t ON p.CONTEST = c.ROWI AND p.TEAM = t.ROWI
ORDER BY contest_id, kind_id, place, team; 