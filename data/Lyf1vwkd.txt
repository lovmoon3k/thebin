海阔视界规则分享，当前分享的是：二级页面详情￥page_detail￥你还没有书哦～～点我进入设置@@eyJkYXRhIjoie1wiYXNzb2NpYXRlZE1vZGVsc01hcEZvckpvaW5UYWJsZVwiOnt9LFwiYXNzb2NpYXRlZE1vZGVsc01hcFdpdGhGS1wiOnt9LFwiYXNzb2NpYXRlZE1vZGVsc01hcFdpdGhvdXRGS1wiOnt9LFwiZmllbGRzVG9TZXRUb0RlZmF1bHRcIjpbXSxcImdtdE1vZGlmaWVkXCI6MCxcImlkXCI6MCxcImxhc3RfY2hhcHRlcl9ydWxlXCI6XCJcIixcImxpc3RUb0NsZWFyQXNzb2NpYXRlZEZLXCI6W10sXCJsaXN0VG9DbGVhclNlbGZGS1wiOltdLFwicGFnZUxpc3RcIjpbe1wiY29sX3R5cGVcIjpcInRleHRfMVwiLFwibmFtZVwiOlwi5rqQ55uu5b2VXCIsXCJwYXRoXCI6XCJzb3VyY2VcIixcInJ1bGVcIjpcImpzOlxcbnZhciBkID0gW107XFxudmFyIG0gPSBNWV9QQVJBTVMucnVsZXNcXG52YXIgYmFzZXVybCA9IG0uYm9va1NvdXJjZVVybFxcbmlmIChtLnJ1bGVFeHBsb3JlLmJvb2tMaXN0KSB7XFxuICAgIHZhciBydWxlID0gbS5ydWxlRXhwbG9yZVxcbn0gZWxzZSB7XFxuICAgIHZhciBydWxlID0gbS5ydWxlU2VhcmNoXFxufVxcbmQucHVzaCh7XFxuICAgIHRpdGxlOiBcXFwi5pCc57SiXFxcIixcXG4gICAgZGVzYzogXFxcIuivt+i+k+WFpeaQnOe0ouWFs+mUruivjVxcXCIsXFxuICAgIHVybDogJC50b1N0cmluZygoKSA9PiB7XFxuICAgICAgICBwdXRNeVZhcihcXFwia3dcXFwiLCBpbnB1dCk7XFxuICAgICAgICByZXR1cm4gXFxcImhpa2VyOi8vcGFnZS9zZWFyY2g/cD1meXBhZ2Uma3c9XFxcIiArIGlucHV0XFxuICAgIH0pLFxcbiAgICBjb2xfdHlwZTogXFxcImlucHV0XFxcIixcXG4gICAgZXh0cmE6IHtcXG4gICAgICAgIFxcXCJ1XFxcIjogYmFzZXVybCArIG0uc2VhcmNoVXJsLFxcbiAgICAgICAgXFxcInJ1bGVzXFxcIjogbSxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0TXlWYXIoXFxcImt3XFxcIiwgXFxcIlxcXCIpLFxcbiAgICAgICAgYm9va1NvdXJjZU5hbWU6IG0uYm9va1NvdXJjZU5hbWVcXG4gICAgfVxcbn0pXFxuaWYgKG0uZW5hYmxlZEV4cGxvcmUmJm0uZXhwbG9yZVVybCkge1xcbiAgICBKU09OLnBhcnNlKG0uZXhwbG9yZVVybCkuZm9yRWFjaChpdGVtID0+IHtcXG4gICAgICAgIGQucHVzaCh7XFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW0udGl0bGUsXFxuICAgICAgICAgICAgY29sX3R5cGU6IGl0ZW0uc3R5bGUubGF5b3V0X2ZsZXhCYXNpc1BlcmNlbnQgPT0gMSA/IFxcXCJ0ZXh0X2NlbnRlcl8xXFxcIiA6IFxcXCJ0ZXh0XzNcXFwiLFxcbiAgICAgICAgICAgIHVybDogaXRlbS51cmwgPT0gXFxcIlxcXCIgPyBcXFwiaGlrZXI6Ly9lbXB0eVxcXCIgOiBcXFwiaGlrZXI6Ly9wYWdlL2Jvb2tzP3A9ZnlwYWdlXFxcIixcXG4gICAgICAgICAgICBleHRyYToge1xcbiAgICAgICAgICAgICAgICBcXFwiYWxsXFxcIjogbSxcXG4gICAgICAgICAgICAgICAgXFxcInJ1bGVzXFxcIjogcnVsZSxcXG4gICAgICAgICAgICAgICAgXFxcInVcXFwiOiBiYXNldXJsICsgaXRlbS51cmxcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9KVxcbiAgICB9KVxcbn1cXG5zZXRSZXN1bHQoZCk7XCJ9LHtcImNvbF90eXBlXCI6XCJtb3ZpZV8zXCIsXCJuYW1lXCI6XCLkuLvpobVcIixcInBhdGhcIjpcImhvbWVcIixcInJ1bGVcIjpcInZhciBkID0gW107XFxuaWYgKGZpbGVFeGlzdChcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFwiKSAmJiBKU09OLnBhcnNlKGZldGNoKFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L2xpc3QuanNvblxcXCIpKS51cmxzLmxlbmd0aCAhPSAwKSB7XFxuICAgIGQucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuKame+4j+iuvue9rlxcXCIsXFxuICAgICAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvY29uZmlnXFxcIixcXG4gICAgICAgIGNvbF90eXBlOiBcXFwic2Nyb2xsX2J1dHRvblxcXCJcXG4gICAgfSk7XFxuICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShmZXRjaChcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFwiKSlcXG4gICAgZGF0YS51cmxzLmZvckVhY2goaXRlbSA9PiB7XFxuICAgICAgICBkLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLm5hbWUsXFxuICAgICAgICAgICAgdXJsOiAkKCkubGF6eVJ1bGUoKGkpID0+IHtcXG4gICAgICAgICAgICAgICAgcHV0TXlWYXIoXFxcInRhYlxcXCIsIGkpXFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKClcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+WIh+aNouaIkOWKn1xcXCJcXG4gICAgICAgICAgICB9LCBpdGVtLm5hbWUpLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFwic2Nyb2xsX2J1dHRvblxcXCJcXG4gICAgICAgIH0pXFxuICAgIH0pXFxuICAgIGQucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuaQnOe0olxcXCIsXFxuICAgICAgICB1cmw6ICQudG9TdHJpbmcoKCkgPT4ge1xcbiAgICAgICAgICAgIHB1dE15VmFyKFxcXCJrd1xcXCIsIGlucHV0KTtcXG4gICAgICAgICAgICByZXR1cm4gXFxcImhpa2VyOi8vcGFnZS9qdT9wPWZ5cGFnZSZrdz1cXFwiICsgaW5wdXRcXG4gICAgICAgIH0pLFxcbiAgICAgICAgY29sX3R5cGU6IFxcXCJpbnB1dFxcXCIsXFxuICAgICAgICBkZXNjOiBcXFwi6IGa5ZCI5pCc57Si77yM6K+36L6T5YWl5YWz6ZSu6K+NXFxcIixcXG4gICAgICAgIHBpY191cmw6IFxcXCJcXFwiLFxcbiAgICAgICAgZXh0cmE6IHtcXG4gICAgICAgICAgICBkZWZhdWx0VmFsdWU6IGdldE15VmFyKFxcXCJrd1xcXCIsIFxcXCJcXFwiKVxcbiAgICAgICAgfVxcbiAgICB9KTtcXG4gICAgbGV0IGxpc3QgPSBKU09OLnBhcnNlKGZldGNoKFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L1xcXCIgKyBtZDUoZ2V0TXlWYXIoXFxcInRhYlxcXCIsIGRhdGEudXJsc1swXS5uYW1lKSkgKyBcXFwiLmpzb25cXFwiKSlcXG4gICAgbGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xcbiAgICAgICAgbGV0IHMgPSBKU09OLnN0cmluZ2lmeShpdGVtKVxcbiAgICAgICAgaWYgKHMuaW5jbHVkZXMoXFxcIjxqcz5cXFwiKSB8fCBzLmluY2x1ZGVzKFxcXCJAanM6XFxcIikgfHwgcy5pbmNsdWRlcyhcXFwiJC5cXFwiKSB8fCBzLmluY2x1ZGVzKFxcXCLwn5SeXFxcIikpIHtcXG4gICAgICAgICAgICB2YXIgdXJsID0gXFxcInRvYXN0Oi8v5b2T5YmN5Lmm5rqQ5pqC5LiN5pSv5oyBXFxcIlxcbiAgICAgICAgICAgIHJldHVyblxcbiAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICB2YXIgdXJsID0gXFxcImhpa2VyOi8vcGFnZS9zb3VyY2U/cD1meXBhZ2VcXFwiXFxuICAgICAgICB9XFxuICAgICAgICBkLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLmJvb2tTb3VyY2VOYW1lICsgYCgke2l0ZW0uYm9va1NvdXJjZUdyb3VwfSlgLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF8yXFxcIixcXG4gICAgICAgICAgICB1cmw6IHVybCxcXG4gICAgICAgICAgICBleHRyYToge1xcbiAgICAgICAgICAgICAgICBcXFwicnVsZXNcXFwiOiBpdGVtXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSlcXG4gICAgfSlcXG59IGVsc2Uge1xcbiAgICBzZXRSZXN1bHQoW3tcXG4gICAgICAgIHRpdGxlOiBcXFwi5L2g6L+Y5rKh5pyJ5Lmm5ZOm772e772e54K55oiR6L+b5YWl6K6+572uXFxcIixcXG4gICAgICAgIHVybDogXFxcImhpa2VyOi8vcGFnZS9jb25maWdcXFwiLFxcbiAgICAgICAgY29sX3R5cGU6IFxcXCJ0ZXh0X2NlbnRlcl8xXFxcIlxcbiAgICB9XSlcXG59XFxuc2V0UmVzdWx0KGQpO1wifSx7XCJjb2xfdHlwZVwiOlwibW92aWVfMV92ZXJ0aWNhbF9waWNcIixcIm5hbWVcIjpcIuWIl+ihqFwiLFwicGF0aFwiOlwiYm9va3NcIixcInJ1bGVcIjpcImpzOlxcbnZhciBkID0gW107XFxudHJ5IHtcXG4gICAgdmFyIG0gPSBNWV9QQVJBTVMucnVsZXNcXG4gICAgLy8g6ZiF6K+7PT7op4bnlYxcXG4gICAgdmFyIHVybCA9IE1ZX1BBUkFNUy51LnJlcGxhY2UoXFxcInt7cGFnZX19XFxcIiwgTVlfUEFHRSlcXG4gICAgdmFyIGxpc3RydWxlID0gXFxcImJvZHkmJlxcXCIgKyBtLmJvb2tMaXN0LnJlcGxhY2UoL1xcXFwhWzAtOV0vZywgXFxcIlxcXCIpLnJlcGxhY2UoXFxcIiBcXFwiLCBcXFwiJiZcXFwiKS5zcGxpdChcXFwifHxcXFwiKVswXVxcbiAgICBpZiAobS5hdXRob3IpIHtcXG4gICAgICAgIHZhciBhdXRob3IgPSBtLmF1dGhvci5yZXBsYWNlKFxcXCJAXFxcIiwgXFxcIiYmXFxcIikucmVwbGFjZShcXFwidGV4dFxcXCIsIFxcXCJUZXh0XFxcIikucmVwbGFjZSgvXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxuICAgICAgICAgICAgcmV0dXJuIGEucmVwbGFjZShcXFwiLlxcXCIsIFxcXCIsXFxcIilcXG4gICAgICAgIH0pXFxuICAgIH0gZWxzZSB7XFxuICAgICAgICB2YXIgYXV0aG9yID0gZmFsc2VcXG4gICAgfVxcbiAgICBpZiAobS5jb3ZlclVybCkge1xcbiAgICAgICAgdmFyIGNvdmVyID0gbS5jb3ZlclVybC5yZXBsYWNlKFxcXCJAXFxcIiwgXFxcIiYmXFxcIikucmVwbGFjZSgvXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxuICAgICAgICAgICAgcmV0dXJuIGEucmVwbGFjZShcXFwiLlxcXCIsIFxcXCIsXFxcIilcXG4gICAgICAgIH0pXFxuICAgIH0gZWxzZSB7XFxuICAgICAgICB2YXIgY292ZXIgPSBmYWxzZVxcbiAgICB9XFxuICAgIHZhciBuYW1lID0gbS5uYW1lLnJlcGxhY2UoXFxcIkBcXFwiLCBcXFwiJiZcXFwiKS5yZXBsYWNlKFxcXCJ0ZXh0XFxcIiwgXFxcIlRleHRcXFwiKS5yZXBsYWNlKC9cXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXG4gICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcIi5cXFwiLCBcXFwiLFxcXCIpXFxuICAgIH0pXFxuICAgIHZhciBib29rdXJsID0gbS5ib29rVXJsLnJlcGxhY2UoXFxcIkBcXFwiLCBcXFwiJiZcXFwiKS5yZXBsYWNlKC9cXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXG4gICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcIi5cXFwiLCBcXFwiLFxcXCIpXFxuICAgIH0pXFxuICAgIGlmIChtLmludHJvKSB7XFxuICAgICAgICB2YXIgaW50cm8gPSBtLmludHJvLnJlcGxhY2UoXFxcIkBcXFwiLCBcXFwiJiZcXFwiKS5yZXBsYWNlKFxcXCJ0ZXh0XFxcIiwgXFxcIlRleHRcXFwiKS5yZXBsYWNlKC9cXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXG4gICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXCIuXFxcIiwgXFxcIixcXFwiKVxcbiAgICAgICAgfSlcXG4gICAgfSBlbHNlIHtcXG4gICAgICAgIHZhciBpbnRybyA9IGZhbHNlXFxuICAgIH1cXG4gICAgTVlfVVJMID0gdXJsO1xcbiAgICB2YXIgcmVzID0gcmVxdWVzdCh1cmwpXFxuICAgIGxldCBsaXN0ID0gcGRmYShyZXMsIGxpc3RydWxlKVxcbiAgICBpZiAobGlzdC5sZW5ndGggPiAwKSB7XFxuICAgICAgICBsaXN0LmZvckVhY2goaXRlbSA9PiB7XFxuICAgICAgICAgICAgZC5wdXNoKHtcXG4gICAgICAgICAgICAgICAgY29sX3R5cGU6IChjb3ZlciA/IFxcXCJtb3ZpZV8xX3ZlcnRpY2FsX3BpY1xcXCIgOiBcXFwidGV4dF8xXFxcIiksXFxuICAgICAgICAgICAgICAgIHRpdGxlOiBwYXJzZURvbUZvckh0bWwoaXRlbSwgbmFtZSksXFxuICAgICAgICAgICAgICAgIGltZzogKGNvdmVyID8gcGFyc2VEb20oaXRlbSwgY292ZXIpICsgXFxcIkBSZWZlcmVyPVxcXCIgOiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCIpLFxcbiAgICAgICAgICAgICAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvbWVudT91cmw9XFxcIiArIHBhcnNlRG9tKGl0ZW0sIGJvb2t1cmwpICsgXFxcIiNhdXRvQ2FjaGUjI2ltbWVyc2l2ZVRoZW1lI1xcXCIsXFxuICAgICAgICAgICAgICAgIGRlc2M6IChhdXRob3IgPyBwYXJzZURvbUZvckh0bWwoaXRlbSwgYXV0aG9yKSA6IFxcXCJcXFwiKSArIFxcXCJcXFxcblxcXCIgKyAoaW50cm8gPyBwYXJzZURvbUZvckh0bWwoaXRlbSwgaW50cm8pIDogXFxcIlxcXCIpLFxcbiAgICAgICAgICAgICAgICBleHRyYToge1xcbiAgICAgICAgICAgICAgICAgICAgXFxcImJvb2tOYW1lXFxcIjogcGFyc2VEb21Gb3JIdG1sKGl0ZW0sIG5hbWUpLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcImNvdmVyXFxcIjogKGNvdmVyID8gcGFyc2VEb20oaXRlbSwgY292ZXIpICsgXFxcIkBSZWZlcmVyPVxcXCIgOiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCIpLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcIlRvY1xcXCI6IE1ZX1BBUkFNUy5hbGwucnVsZVRvYyxcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJjb250ZW50XFxcIjogTVlfUEFSQU1TLmFsbC5ydWxlQ29udGVudFxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfSlcXG4gICAgICAgIH0pXFxuICAgIH0gZWxzZSB7XFxuICAgICAgICBkLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOiBcXFwi5YiX6KGo5Yqg6L295aSx6LSl77yaXFxcIiArIGxpc3RydWxlLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF9jZW50ZXJfMVxcXCIsXFxuICAgICAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCJcXG4gICAgICAgIH0pXFxuICAgIH1cXG59IGNhdGNoIChlKSB7XFxuICAgIGQucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuWKoOi9veWksei0pe+8mlxcXCIgKyBlLm1lc3NhZ2UsXFxuICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfY2VudGVyXzFcXFwiLFxcbiAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCJcXG4gICAgfSlcXG59XFxuc2V0UmVzdWx0KGQpO1wifSx7XCJjb2xfdHlwZVwiOlwidGV4dF9jZW50ZXJfMVwiLFwibmFtZVwiOlwi6K6+572uXCIsXCJwYXRoXCI6XCJjb25maWdcIixcInJ1bGVcIjpcImpzOlxcbnZhciBkID0gW107XFxudHJ5IHtcXG4gICAgaWYgKCFmaWxlRXhpc3QoXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcIikpIHtcXG4gICAgICAgIHdyaXRlRmlsZShcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFwiLCAne1xcXCJ1cmxzXFxcIjpbXX0nKVxcbiAgICB9XFxuICAgIGQucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIua3u+WKoOiuoumYhVxcXCIsXFxuICAgICAgICB1cmw6ICQoXFxcIlxcXCIsIFxcXCLorqLpmIXlkI3np7BcXFwiKS5pbnB1dCgoKSA9PiB7XFxuICAgICAgICAgICAgcmV0dXJuICQoXFxcIlxcXCIsIFxcXCLorqLpmIXpk77mjqVcXFwiKS5pbnB1dCgobmFtZSkgPT4ge1xcbiAgICAgICAgICAgICAgICBsZXQgbGlzdCA9IEpTT04ucGFyc2UoZmV0Y2goXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcIikpXFxuICAgICAgICAgICAgICAgIGxpc3QudXJscy5wdXNoKHtcXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXFxuICAgICAgICAgICAgICAgICAgICB1cmw6IGlucHV0XFxuICAgICAgICAgICAgICAgIH0pXFxuICAgICAgICAgICAgICAgIHdyaXRlRmlsZShcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFwiLCBKU09OLnN0cmluZ2lmeShsaXN0KSlcXG4gICAgICAgICAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ID0gZmV0Y2goaW5wdXQpXFxuICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKHQpXFxuICAgICAgICAgICAgICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvXFxcIiArIG1kNShuYW1lKSArIFxcXCIuanNvblxcXCIsIHQpXFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5a+85YWl5oiQ5YqfXFxcIlxcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5a+85YWl5aSx6LSlXFxcIlxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKClcXG4gICAgICAgICAgICB9LCBpbnB1dClcXG4gICAgICAgIH0pXFxuICAgIH0pXFxuICAgIGxldCBsaXN0ID0gSlNPTi5wYXJzZShmZXRjaChcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFwiKSlcXG4gICAgbGlzdC51cmxzLmZvckVhY2goKGl0ZW0sIGkpID0+IHtcXG4gICAgICAgIGQucHVzaCh7XFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW0ubmFtZSxcXG4gICAgICAgICAgICBkZXNjOiBpdGVtLnVybCxcXG4gICAgICAgICAgICB1cmw6ICQoW1xcXCLliKDpmaRcXFwiLCBcXFwi57yW6L6R5ZCN56ewXFxcIiwgXFxcIue8lui+keWcsOWdgFxcXCIsIFxcXCLmm7TmlrBcXFwiXSkuc2VsZWN0KChsaXMsIGkpID0+IHtcXG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSBsaXNcXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0ID09IFxcXCLliKDpmaRcXFwiKSB7XFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJChcXFwi56Gu6K6k5Yig6Zmk77yfXFxcIikuY29uZmlybSgobGlzdCwgaSkgPT4ge1xcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvXFxcIiArIG1kNShsaXN0LnVybHNbaV0ubmFtZSkgKyBcXFwiLmpzb25cXFwiKVxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QudXJscy5zcGxpY2UoaSwgMSlcXG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcIiwgSlNPTi5zdHJpbmdpZnkobGlzdCkpICAgICAgICAgICAgICAgICAgICAgICAgXFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKVxcbiAgICAgICAgICAgICAgICAgICAgfSwgbGlzdCwgaSlcXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9PSBcXFwi57yW6L6R5ZCN56ewXFxcIikge1xcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoXFxcIlxcXCIpLmlucHV0KChsaXN0LCBpKSA9PiB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC51cmxzW2ldLm5hbWUgPSBpbnB1dFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlRmlsZShcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFwiLCBKU09OLnN0cmluZ2lmeShsaXN0KSlcXG4gICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoUGFnZSgpXFxuICAgICAgICAgICAgICAgICAgICB9LCBsaXN0LCBpKVxcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0ID09IFxcXCLnvJbovpHlnLDlnYBcXFwiKSB7XFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJChcXFwiXFxcIikuaW5wdXQoKGxpc3QsIGkpID0+IHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LnVybHNbaV0udXJsID0gaW5wdXRcXG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcIiwgSlNPTi5zdHJpbmdpZnkobGlzdCkpXFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKVxcbiAgICAgICAgICAgICAgICAgICAgfSwgbGlzdCwgaSlcXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBmZXRjaChsaXN0LnVybHNbaV0udXJsKVxcbiAgICAgICAgICAgICAgICAgICAgICAgIEpTT04ucGFyc2UodClcXG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvXFxcIiArIG1kNShsaXN0LnVybHNbaV0ubmFtZSkgKyBcXFwiLmpzb25cXFwiLCB0KVxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKClcXG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdChcXFwi5pu05paw5oiQ5YqfXFxcIilcXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdChcXFwi5pu05paw5aSx6LSlXFxcIilcXG4gICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH0sIGxpc3QsIGkpLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF8xXFxcIlxcbiAgICAgICAgfSlcXG4gICAgfSlcXG59IGNhdGNoIChlKSB7XFxuICAgIGQucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIumUmeivr++8mlxcXCIgKyBlLm1lc3NhZ2UsXFxuICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfY2VudGVyXzFcXFwiLFxcbiAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCJcXG4gICAgfSlcXG59XFxuc2V0UmVzdWx0KGQpO1wifSx7XCJjb2xfdHlwZVwiOlwidGV4dF8xXCIsXCJuYW1lXCI6XCLnm67lvZVcIixcInBhdGhcIjpcIm1lbnVcIixcInJ1bGVcIjpcImpzOlxcbnZhciBkID0gW107XFxudmFyIHJlcyA9IGdldFJlc0NvZGUoKVxcbmxldCBUb2MgPSBNWV9QQVJBTVMuVG9jXFxubGV0IHtcXG4gICAgZ2V0QXJyYXksXFxuICAgIGdldFRleHQsXFxuICAgIGdldFVybDBcXG59ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvY29udmVydGVyXFxcIik7XFxuZ2V0QXJyYXkocmVzLCBUb2MuY2hhcHRlckxpc3QpLmZvckVhY2goaXRlbSA9PiB7XFxuICAgIC8vbG9nKGl0ZW0pOyAgICBcXG4gICAgdmFyIHRpdGxlID0gZ2V0VGV4dChpdGVtLCBUb2MuY2hhcHRlck5hbWUpXFxuICAgIGlmICh0aXRsZSAhPSBcXFwiXFxcIikge1xcbiAgICAgICAgZC5wdXNoKHtcXG4gICAgICAgICAgICB0aXRsZTogdGl0bGUsXFxuICAgICAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL2NvbnRlbnRcXFwiLFxcbiAgICAgICAgICAgIGV4dHJhOiB7XFxuICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcXG4gICAgICAgICAgICAgICAgY29udGVudDogTVlfUEFSQU1TLmNvbnRlbnQsXFxuICAgICAgICAgICAgICAgIHVybDogZ2V0VXJsMChpdGVtLCBUb2MuY2hhcHRlckxpc3QsIFRvYy5jaGFwdGVyVXJsKSArIFxcXCIjYXV0b1BhZ2UjI3JlYWRUaGVtZSNcXFwiXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSlcXG4gICAgfVxcbn0pXFxudmFyIGNwID0gZC5tYXAoZnVuY3Rpb24oaXRlbSkge1xcbiAgICByZXR1cm4ge1xcbiAgICAgICAgXFxcInRpdGxlXFxcIjogaXRlbS50aXRsZSxcXG4gICAgICAgIFxcXCJ1cmxcXFwiOiBpdGVtLmV4dHJhLnVybC5yZXBsYWNlKFxcXCIjYXV0b1BhZ2UjI3JlYWRUaGVtZSNcXFwiLCBcXFwiXFxcIilcXG4gICAgfVxcbn0pXFxuZC51bnNoaWZ0KHtcXG4gICAgdGl0bGU6IFxcXCLkuIvovb1cXFwiLFxcbiAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvZG93bmxvYWQudmlldyNub1JlY29yZEhpc3RvcnkjI25vUmVmcmVzaCMjbm9IaXN0b3J5Iz9ydWxlPeacrOWcsOi1hOa6kOeuoeeQhlxcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwidGV4dF9jZW50ZXJfMVxcXCIsXFxuICAgIGV4dHJhOiB7XFxuICAgICAgICBjaGFwdGVyTGlzdDogY3AsXFxuICAgICAgICBkZWZhdWx0VmlldzogXFxcIjFcXFwiLFxcbiAgICAgICAgaW5mbzoge1xcbiAgICAgICAgICAgIGJvb2tOYW1lOiBNWV9QQVJBTVMuYm9va05hbWUsXFxuICAgICAgICAgICAgYm9va1RvcFBpYzogTVlfUEFSQU1TLmNvdmVyLFxcbiAgICAgICAgICAgIHJ1bGVOYW1lOiBcXFwi5oKm6K+7XFxcIixcXG4gICAgICAgICAgICBwYXJzZUNvZGU6ICQudG9TdHJpbmcoKE1ZX1BBUkFNUykgPT4ge1xcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gcmVxdWVzdChpbnB1dCk7XFxuICAgICAgICAgICAgICAgIHZhciBydWxlID0gTVlfUEFSQU1TLmNvbnRlbnQ7XFxuICAgICAgICAgICAgICAgIGxldCByID0gcnVsZS5jb250ZW50LnJlcGxhY2UoXFxcIkBcXFwiLCBcXFwiJiZcXFwiKS5yZXBsYWNlKFxcXCJ0ZXh0XFxcIiwgXFxcIlRleHRcXFwiKS5yZXBsYWNlKC9cXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcIi5cXFwiLCBcXFwiLFxcXCIpXFxuICAgICAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgICAgICBsZXQgcjEgPSByLnNwbGl0KFxcXCImJlxcXCIpO1xcbiAgICAgICAgICAgICAgICBsZXQgcjIgPSByMS5zbGljZSgwLCByMS5sZW5ndGggLSAxKS5qb2luKFxcXCImJlxcXCIpO1xcbiAgICAgICAgICAgICAgICBsZXQgYXJyID0gcGRmYShyZXMsIFxcXCJib2R5JiZcXFwiICsgcjIpO1xcbiAgICAgICAgICAgICAgICAvL2xvZyhhcnIpO1xcbiAgICAgICAgICAgICAgICB2YXIgdHQgPSBcXFwiXFxcIlxcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpdCBvZiBhcnIpIHtcXG4gICAgICAgICAgICAgICAgICAgIGl0ID0gaXQucmVwbGFjZShuZXcgUmVnRXhwKFxcXCJcXFxcblxcXCIsIFxcXCJnXFxcIiksIFxcXCItLWJyLS1cXFwiKTtcXG4gICAgICAgICAgICAgICAgICAgIC8vbG9nKGl0KTtcXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ID0gcGRmaChpdCwgXFxcIlRleHRcXFwiKTtcXG4gICAgICAgICAgICAgICAgICAgIHQgPSB0LnJlcGxhY2UobmV3IFJlZ0V4cChcXFwiLS1ici0tXFxcIiwgXFxcImdcXFwiKSwgXFxcIjxicj5cXFwiKTtcXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ID09IFxcXCJcXFwiKSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcXG4gICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgIGxldCB0MiA9IHQuc3BsaXQoXFxcIjxicj5cXFwiKTtcXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0MiBvZiB0Mikge1xcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdDIgPT0gXFxcIlxcXCIgfHwgaXQyLmxlbmd0aCA9PSAxKSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXQyLnN0YXJ0c1dpdGgoXFxcIuOAgFxcXCIpICYmICFpdDIuc3RhcnRzV2l0aChcXFwiJm5ic3A7Jm5ic3A7XFxcIikpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXQyID0gXFxcIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwO1xcXCIgKyBpdDIudHJpbSgpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS5yZXBsYWNlUmVnZXgpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXQyID0gaXQyLnJlcGxhY2UobmV3IFJlZ0V4cChydWxlLnJlcGxhY2VSZWdleC5yZXBsYWNlKFxcXCIjI1xcXCIsIFxcXCJcXFwiKSwgXFxcImdcXFwiKSwgXFxcIlxcXCIpXFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdDIgPT0gXFxcIlxcXCIpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICAgICAgdHQgKz0gaXQyICsgXFxcIlxcXFxuXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIHJldHVybiB0dFxcbiAgICAgICAgICAgIH0sIE1ZX1BBUkFNUyksXFxuICAgICAgICAgICAgdHlwZTogXFxcIm5vdmVsXFxcIlxcbiAgICAgICAgfVxcbiAgICB9XFxufSlcXG5kLnVuc2hpZnQoe1xcbiAgICB0aXRsZTogTVlfUEFSQU1TLmJvb2tOYW1lLFxcbiAgICBpbWc6IE1ZX1BBUkFNUy5jb3ZlcixcXG4gICAgdXJsOiBNWV9VUkwsXFxuICAgIGNvbF90eXBlOiBcXFwibW92aWVfMV92ZXJ0aWNhbF9waWNfYmx1clxcXCJcXG59KVxcbnNldFJlc3VsdChkKTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuWGheWuuVwiLFwicGF0aFwiOlwiY29udGVudFwiLFwicnVsZVwiOlwianM6XFxudmFyIGQgPSBbXTtcXG52YXIgcmVzID0gZ2V0UmVzQ29kZSgpXFxudmFyIHJ1bGUgPSBNWV9QQVJBTVMuY29udGVudFxcbmxldCByID0gcnVsZS5jb250ZW50LnJlcGxhY2UoXFxcIkBcXFwiLCBcXFwiJiZcXFwiKS5yZXBsYWNlKFxcXCJ0ZXh0XFxcIiwgXFxcIlRleHRcXFwiKS5yZXBsYWNlKC9cXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXG4gICAgcmV0dXJuIGEucmVwbGFjZShcXFwiLlxcXCIsIFxcXCIsXFxcIilcXG59KTtcXG5sZXQgcjEgPSByLnNwbGl0KFxcXCImJlxcXCIpO1xcbmxldCByMiA9IHIxLnNsaWNlKDAsIHIxLmxlbmd0aCAtIDEpLmpvaW4oXFxcIiYmXFxcIik7XFxubGV0IGFyciA9IHBkZmEocmVzLCBcXFwiYm9keSYmXFxcIiArIHIyKTtcXG4vL2xvZyhhcnIpO1xcbmZvciAobGV0IGl0IG9mIGFycikge1xcbiAgICBpdCA9IGl0LnJlcGxhY2UobmV3IFJlZ0V4cChcXFwiXFxcXG5cXFwiLCBcXFwiZ1xcXCIpLCBcXFwiLS1ici0tXFxcIik7XFxuICAgIC8vbG9nKGl0KTtcXG4gICAgdmFyIHQgPSBwZGZoKGl0LCBcXFwiVGV4dFxcXCIpO1xcbiAgICB0ID0gdC5yZXBsYWNlKG5ldyBSZWdFeHAoXFxcIi0tYnItLVxcXCIsIFxcXCJnXFxcIiksIFxcXCI8YnI+XFxcIik7XFxuICAgIGlmICh0ID09IFxcXCJcXFwiKSB7XFxuICAgICAgICBjb250aW51ZVxcbiAgICB9XFxuICAgIGxldCB0MiA9IHQuc3BsaXQoXFxcIjxicj5cXFwiKTtcXG4gICAgZm9yIChsZXQgaXQyIG9mIHQyKSB7XFxuICAgICAgICBpZiAoaXQyID09IFxcXCJcXFwiIHx8IGl0Mi5sZW5ndGggPT0gMSkge1xcbiAgICAgICAgICAgIGNvbnRpbnVlXFxuICAgICAgICB9XFxuICAgICAgICBpZiAoIWl0Mi5zdGFydHNXaXRoKFxcXCLjgIBcXFwiKSAmJiAhaXQyLnN0YXJ0c1dpdGgoXFxcIiZuYnNwOyZuYnNwO1xcXCIpKSB7XFxuICAgICAgICAgICAgaXQyID0gXFxcIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwO1xcXCIgKyBpdDIudHJpbSgpO1xcbiAgICAgICAgfVxcbiAgICAgICAgaWYgKHJ1bGUucmVwbGFjZVJlZ2V4KSB7XFxuICAgICAgICAgICAgaXQyID0gaXQyLnJlcGxhY2UobmV3IFJlZ0V4cChydWxlLnJlcGxhY2VSZWdleC5yZXBsYWNlKFxcXCIjI1xcXCIsIFxcXCJcXFwiKSwgXFxcImdcXFwiKSwgXFxcIlxcXCIpXFxuICAgICAgICB9XFxuICAgICAgICBpZiAoaXQyID09IFxcXCJcXFwiIHx8IGl0MiA9PSBcXFwiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7XFxcIikge1xcbiAgICAgICAgICAgIGNvbnRpbnVlXFxuICAgICAgICB9XFxuICAgICAgICBkLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOiBpdDIsXFxuICAgICAgICAgICAgdXJsOiBcXFwiXFxcIixcXG4gICAgICAgICAgICBjb2xfdHlwZTogXFxcInJpY2hfdGV4dFxcXCIsXFxuICAgICAgICAgICAgZGVzYzogXFxcIlxcXCIsXFxuICAgICAgICAgICAgcGljX3VybDogXFxcIlxcXCJcXG4gICAgICAgIH0pO1xcbiAgICB9XFxufVxcbmQudW5zaGlmdCh7XFxuICAgIHRpdGxlOiBcXFwiPGJpZz5cXFwiICsgTVlfUEFSQU1TLnRpdGxlICsgXFxcIjwvYmlnPlxcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwicmljaF90ZXh0XFxcIlxcbn0pXFxuc2V0UmVzdWx0KGQpO1wifSx7XCJjb2xfdHlwZVwiOlwibW92aWVfMV92ZXJ0aWNhbF9waWNcIixcIm5hbWVcIjpcIuaQnOe0olwiLFwicGF0aFwiOlwic2VhcmNoXCIsXCJydWxlXCI6XCJqczpcXG5sZXQge1xcbiAgICBzZWFyY2hcXG59ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2Uvc3NcXFwiKTtcXG5sZXQgZCA9IFtdO1xcbmxldCBrdyA9IGdldFBhcmFtKFxcXCJrd1xcXCIpO1xcbmxldCBzID0ga3c7XFxuc2V0UGFnZVRpdGxlKFxcXCLmkJzntKJcXFwiICsga3cgKyBcXFwiIFxcXCIgKyBNWV9QQVJBTVMuYm9va1NvdXJjZU5hbWUpO1xcbmxldCBtYXRjaE11c3QgPSBnZXRJdGVtKFxcXCJtbVxcXCIsIFxcXCIwXFxcIik7XFxubGV0IHRpcCA9IFxcXCLnsr7noa7ljLnphY3vvJpcXFwiICsgKG1hdGNoTXVzdCA9PSBcXFwiMVxcXCIgPyBcXFwi5pivXFxcIiA6IFxcXCLlkKZcXFwiKTtcXG5pZiAoTVlfUEFHRSA9PSAxKSB7XFxuICAgIGQucHVzaCh7XFxuICAgICAgICB0aXRsZTogdGlwLFxcbiAgICAgICAgdXJsOiAkKFxcXCIjbm9Mb2FkaW5nI1xcXCIpLmxhenlSdWxlKCgpID0+IHtcXG4gICAgICAgICAgICBzZXRJdGVtKFxcXCJtbVxcXCIsIGdldEl0ZW0oXFxcIm1tXFxcIiwgXFxcIjBcXFwiKSA9PSBcXFwiMFxcXCIgPyBcXFwiMVxcXCIgOiBcXFwiMFxcXCIpO1xcbiAgICAgICAgICAgIHJlZnJlc2hQYWdlKCk7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL09LXFxcIjtcXG4gICAgICAgIH0pLFxcbiAgICAgICAgY29sX3R5cGU6IFxcXCJ0ZXh0XzFcXFwiLFxcbiAgICB9KTtcXG59XFxubGV0IGQyID0gc2VhcmNoKE1ZX1BBUkFNUy5ydWxlcywga3csIE1ZX1BBR0UpO1xcbmZvciAobGV0IGl0IG9mIGQyKSB7XFxuICAgIGlmIChtYXRjaE11c3QgPT0gXFxcIjBcXFwiIHx8IChpdC50aXRsZSAmJiBpdC50aXRsZS5pbmRleE9mKGt3KSA+PSAwKSkge1xcbiAgICAgICAgaXQudGl0bGUgPSBpdC50aXRsZS5pbmNsdWRlcyhcXFwi4oCc4oCc4oCd4oCdXFxcIikgPyBpdC50aXRsZSA6IFxcXCLigJzigJzigJ3igJ1cXFwiICsgaXQudGl0bGUucmVwbGFjZShuZXcgUmVnRXhwKFxcXCI8ZW0+fDwvZW0+XFxcIiwgXFxcImdcXFwiKSwgXFxcIlxcXCIpLnJlcGxhY2UobmV3IFJlZ0V4cChzLCBcXFwiZ1xcXCIpLCBcXFwiPHN0cm9uZz48c3BhbiBzdHlsZT1cXFxcXFxcImNvbG9yOiAjMUU5MEZGXFxcXFxcXCI+XFxcIiArIHMgKyBcXFwiPC9zcGFuPjwvc3Ryb25nPlxcXCIpXFxuICAgICAgICBkLnB1c2goaXQpO1xcbiAgICB9XFxufVxcblxcbnNldFJlc3VsdChkKTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIui9rOaNolwiLFwicGF0aFwiOlwiY29udmVydGVyXCIsXCJydWxlXCI6XCIkLmV4cG9ydHMgPSB7XFxuICAgIGdldEFycmF5OiAoaHRtbCwgcnVsZSkgPT4ge1xcbiAgICAgICAgbGV0IHIxID0gcnVsZS5zcGxpdChcXFwiIVxcXCIpWzBdLnNwbGl0KFxcXCJ8fFxcXCIpO1xcbiAgICAgICAgbGV0IGFyciA9IHBkZmEoaHRtbCwgXFxcImJvZHkmJlxcXCIgKyByMVswXS5yZXBsYWNlKFxcXCIgXFxcIiwgXFxcIiYmXFxcIikucmVwbGFjZShcXFwiQFxcXCIsIFxcXCImJlxcXCIpKTtcXG4gICAgICAgIGlmIChyMS5sZW5ndGggPiAxKSB7XFxuICAgICAgICAgICAgbGV0IHIyID0gcjFbMV0uc3BsaXQoXFxcIjpcXFwiKTtcXG4gICAgICAgICAgICBsZXQgcjMgPSBbXTtcXG4gICAgICAgICAgICBmb3IgKGxldCBpdCBvZiByMikge1xcbiAgICAgICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSBwYXJzZUludChpdCk7XFxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oaSkpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcXG4gICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgIHIzLnB1c2goaSk7XFxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGxldCBhcnIyID0gW107XFxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcXG4gICAgICAgICAgICAgICAgaWYgKHIzLmluZGV4T2YoaSkgPCAwKSB7XFxuICAgICAgICAgICAgICAgICAgICBhcnIyLnB1c2goYXJyW2ldKTtcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICByZXR1cm4gYXJyMjtcXG4gICAgICAgIH1cXG4gICAgICAgIGxvZyhcXFwi6I635Y+W5aSx6LSl77yM5aSx6LSl5a6a5L2N77yaXFxcIiArIHIxWzBdLnJlcGxhY2UoXFxcIiBcXFwiLCBcXFwiJiZcXFwiKS5yZXBsYWNlKFxcXCJAXFxcIiwgXFxcIiYmXFxcIikpXFxuICAgICAgICByZXR1cm4gYXJyO1xcbiAgICB9LFxcbiAgICBnZXRUZXh0OiAoaHRtbCwgcnVsZSkgPT4ge1xcbiAgICAgICAgdmFyIHJ1ID0gcnVsZS5yZXBsYWNlKFxcXCJAXFxcIiwgXFxcIiYmXFxcIikucmVwbGFjZShcXFwidGV4dFxcXCIsIFxcXCJUZXh0XFxcIikucmVwbGFjZSgvXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxuICAgICAgICAgICAgcmV0dXJuIGEucmVwbGFjZShcXFwiLlxcXCIsIFxcXCIsXFxcIilcXG4gICAgICAgIH0pLnNwbGl0KFxcXCIjI1xcXCIpXFxuICAgICAgICBpZiAocnUubGVuZ3RoID09IDEpIHtcXG4gICAgICAgICAgICB2YXIgciA9IHBkZmgoaHRtbCwgcnVbMF0pXFxuICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgIHZhciByID0gcGRmaChodG1sLCBydVswXSkucmVwbGFjZShuZXcgUmVnRXhwKHJ1WzFdLCBcXFwiZ1xcXCIpLCBcXFwiXFxcIilcXG4gICAgICAgIH1cXG4gICAgICAgIGlmIChyID09IFxcXCJcXFwiKSB7XFxuICAgICAgICAgICAgbG9nKFxcXCLov5Tlm57kuLrnqbrvvIzlj6/og73mmK/lrprkvY3lpLHotKXvvJpcXFwiICsgcnVsZS5yZXBsYWNlKFxcXCJAXFxcIiwgXFxcIiYmXFxcIikucmVwbGFjZShcXFwidGV4dFxcXCIsIFxcXCJUZXh0XFxcIikucmVwbGFjZSgvXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxuICAgICAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcIi5cXFwiLCBcXFwiLFxcXCIpXFxuICAgICAgICAgICAgfSkuc3BsaXQoXFxcIiMjXFxcIilbMF0pXFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gclxcbiAgICB9LFxcbiAgICBnZXRVcmwwOiAoaHRtbCwgcGFyZW50UnVsZSwgcnVsZSkgPT4ge1xcbiAgICAgICAgaWYgKHBhcmVudFJ1bGUgIT0gbnVsbCkge1xcbiAgICAgICAgICAgIHBhcmVudFJ1bGUgPSBwYXJlbnRSdWxlLnNwbGl0KFxcXCIhXFxcIilbMF07XFxuICAgICAgICB9XFxuICAgICAgICBsZXQgcCA9IHBhcmVudFJ1bGUgIT0gbnVsbCAmJiBwYXJlbnRSdWxlW3BhcmVudFJ1bGUubGVuZ3RoIC0gMV0gPT0gXFxcImFcXFwiID8gXFxcImEmJlxcXCIgOiBcXFwiXFxcIjtcXG4gICAgICAgIGxldCByID0gcGQoaHRtbCwgcCArIHJ1bGUucmVwbGFjZShcXFwiQFxcXCIsIFxcXCImJlxcXCIpLnJlcGxhY2UoXFxcInRleHRcXFwiLCBcXFwiVGV4dFxcXCIpLnJlcGxhY2UoL1xcXFwuWzAtOV0vZywgZnVuY3Rpb24oYSkge1xcbiAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcIi5cXFwiLCBcXFwiLFxcXCIpO1xcbiAgICAgICAgfSkuc3BsaXQoXFxcIiMjXFxcIilbMF0uc3BsaXQoXFxcIiMjXFxcIilbMF0pO1xcbiAgICAgICAgaWYgKHIgPT0gXFxcIlxcXCIpIHtcXG4gICAgICAgICAgICBsb2coXFxcIui/lOWbnuS4uuepuu+8jOWPr+iDveaYr+WumuS9jeWksei0pe+8mlxcXCIgKyBwICsgcnVsZS5yZXBsYWNlKFxcXCJAXFxcIiwgXFxcIiYmXFxcIikucmVwbGFjZShcXFwidGV4dFxcXCIsIFxcXCJUZXh0XFxcIikucmVwbGFjZSgvXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxuICAgICAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcIi5cXFwiLCBcXFwiLFxcXCIpO1xcbiAgICAgICAgICAgIH0pLnNwbGl0KFxcXCIjI1xcXCIpWzBdKVxcbiAgICAgICAgfVxcbiAgICAgICAgcmV0dXJuIHJcXG4gICAgfVxcbn1cIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuiBmuaQnFwiLFwicGF0aFwiOlwianVcIixcInJ1bGVcIjpcImpzOlxcbnZhciBkID0gW107XFxubGV0IHtcXG4gICAgc2VhcmNoLFxcbiAgICBsaXN0UnVsZXNcXG59ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2Uvc3NcXFwiKTtcXG5sZXQge1xcbiAgICBhbGwsXFxuICAgIHVzZSxcXG4gICAgZGF0YVxcbn0gPSBsaXN0UnVsZXMoTVlfUEFHRSk7XFxuZGF0YSA9IGRhdGEgfHwgW107XFxubGV0IHMgPSBnZXRQYXJhbShcXFwia3dcXFwiKTtcXG5zZXRQYWdlVGl0bGUoXFxcIuaQnOe0olxcXCIgKyBzKTtcXG5sZXQgbWF0Y2hNdXN0ID0gZ2V0SXRlbShcXFwibW1cXFwiLCBcXFwiMFxcXCIpO1xcbmxldCB0aXAgPSBcXFwi5pCc57Si5rqQ77yaXFxcIiArIHVzZSArIFxcXCIvXFxcIiArIGFsbCArIFxcXCIgIOeyvuehruWMuemFje+8mlxcXCIgKyAobWF0Y2hNdXN0ID09IFxcXCIxXFxcIiA/IFxcXCLmmK9cXFwiIDogXFxcIuWQplxcXCIpO1xcbmlmIChNWV9QQUdFID09IDEpIHtcXG4gICAgZC5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiB0aXAsXFxuICAgICAgICB1cmw6ICQoXFxcIiNub0xvYWRpbmcjXFxcIikubGF6eVJ1bGUoKCkgPT4ge1xcbiAgICAgICAgICAgIHNldEl0ZW0oXFxcIm1tXFxcIiwgZ2V0SXRlbShcXFwibW1cXFwiLCBcXFwiMFxcXCIpID09IFxcXCIwXFxcIiA/IFxcXCIxXFxcIiA6IFxcXCIwXFxcIik7XFxuICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKTtcXG4gICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8vT0tcXFwiO1xcbiAgICAgICAgfSksXFxuICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfMVxcXCIsXFxuICAgICAgICBleHRyYToge1xcbiAgICAgICAgICAgIGlkOiBcXFwieXVlZHUtcy1oXFxcIlxcbiAgICAgICAgfVxcbiAgICB9KTtcXG59IGVsc2UgaWYgKGRhdGEubGVuZ3RoID4gMCkge1xcbiAgICB1cGRhdGVJdGVtKFxcXCJ5dWVkdS1zLWhcXFwiLCB7XFxuICAgICAgICB0aXRsZTogdGlwXFxuICAgIH0pO1xcbn1cXG5sZXQgcCA9IE1ZX1BBR0U7XFxubGV0IHBhZ2VpZCA9IFxcXCJ5dWVkdS1wYWdlXFxcIiArIE1ZX1BBR0U7XFxuaWYgKGRhdGEubGVuZ3RoID4gMCkge1xcbiAgICBkLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCLliqDovb3nrKxcXFwiICsgTVlfUEFHRSArIFxcXCLpobXkuK3vvIzov5vluqbvvJoxL1xcXCIgKyBkYXRhLmxlbmd0aCxcXG4gICAgICAgIHVybDogXFxcImhpa2VyOi8vZW1wdHlcXFwiLFxcbiAgICAgICAgY29sX3R5cGU6IFxcXCJ0ZXh0X2NlbnRlcl8xXFxcIixcXG4gICAgICAgIGRlc2M6IFxcXCJcXFwiLFxcbiAgICAgICAgcGljX3VybDogXFxcIlxcXCIsXFxuICAgICAgICBleHRyYToge1xcbiAgICAgICAgICAgIGlkOiBwYWdlaWRcXG4gICAgICAgIH1cXG4gICAgfSk7XFxufVxcbnNldFJlc3VsdChkKTtcXG5pZiAoZGF0YS5sZW5ndGggPiAwKSB7XFxuICAgIC8v5aSa57q/56iL5Yqg6L29XFxuICAgIGxldCB0YXNrcyA9IGRhdGEubWFwKGl0ID0+IHtcXG4gICAgICAgIHJldHVybiB7XFxuICAgICAgICAgICAgZnVuYzogZnVuY3Rpb24ocnVsZSkge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VhcmNoKHJ1bGUsIHMsIDEpO1xcbiAgICAgICAgICAgIH0sXFxuICAgICAgICAgICAgcGFyYW06IGl0LFxcbiAgICAgICAgICAgIGlkOiBcXFwicnVsZUBcXFwiICsgaXQubmFtZVxcbiAgICAgICAgfVxcbiAgICB9KTtcXG5cXG4gICAgYmF0Y2hFeGVjdXRlKHRhc2tzLCB7XFxuICAgICAgICBmdW5jOiBmdW5jdGlvbihwYXJhbSwgaWQsIGVycm9yLCByZXN1bHQpIHtcXG4gICAgICAgICAgICAvL2xvZyhcXFwibGlzdGVuZXI6IFxcXCIgKyAocmVzdWx0IHx8IFtdKS5sZW5ndGgpXFxuICAgICAgICAgICAgcGFyYW0uaSA9IHBhcmFtLmkgKyAxO1xcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcXG4gICAgICAgICAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGl0IG9mIHJlc3VsdCkge1xcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtLmogPSBwYXJhbS5qICsgMTtcXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2hNdXN0ID09IFxcXCIxXFxcIikge1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWl0LnRpdGxlIHx8ICFpdC50aXRsZS5pbmNsdWRlcyhzKSkge1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGV4dHJhID0gaXQuZXh0cmEgfHwge307XFxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmEuaWQgPSBcXFwiX19hcHBcXFwiICsgTVlfUEFHRSArIFxcXCJAXFxcIiArIHBhcmFtLmo7XFxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmEuYm9va05hbWUgPSBpdC50aXRsZVxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhLmNvdmVyID0gaXQucGljX3VybCB8fCBpdC5pbWdcXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRJdGVtQmVmb3JlKHBhZ2VpZCwge1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogaXQudGl0bGUuaW5jbHVkZXMoXFxcIuKAnOKAnOKAneKAnVxcXCIpID8gaXQudGl0bGUgOiBcXFwi4oCc4oCc4oCd4oCdXFxcIiArIGl0LnRpdGxlLnJlcGxhY2UobmV3IFJlZ0V4cChcXFwiPGVtPnw8L2VtPlxcXCIsIFxcXCJnXFxcIiksIFxcXCJcXFwiKS5yZXBsYWNlKG5ldyBSZWdFeHAocywgXFxcImdcXFwiKSwgXFxcIjxzdHJvbmc+PHNwYW4gc3R5bGU9XFxcXFxcXCJjb2xvcjogIzFFOTBGRlxcXFxcXFwiPlxcXCIgKyBzICsgXFxcIjwvc3Bhbj48L3N0cm9uZz5cXFwiKSxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogaXQuZGVzYyxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBpdC51cmwsXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpY191cmw6IGl0LnBpY191cmwgfHwgaXQuaW1nLFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xfdHlwZTogaXQucGljX3VybCB8fCBpdC5pbWcgPyAnbW92aWVfMV92ZXJ0aWNhbF9waWMnIDogXFxcInRleHRfMVxcXCIsXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhOiBleHRyYVxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XFxuXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGlmIChwYXJhbS5pID49IHBhcmFtLmFsbCkge1xcbiAgICAgICAgICAgICAgICBkZWxldGVJdGVtKHBhZ2VpZClcXG4gICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICB1cGRhdGVJdGVtKHtcXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcXFwi5Yqg6L2956ysXFxcIiArIE1ZX1BBR0UgKyBcXFwi6aG15Lit77yM6L+b5bqm77yaXFxcIiArIChwYXJhbS5pICsgMSkgKyBcXFwiL1xcXCIgKyBwYXJhbS5hbGwsXFxuICAgICAgICAgICAgICAgICAgICB1cmw6IFxcXCJoaWtlcjovL2VtcHR5XFxcIixcXG4gICAgICAgICAgICAgICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF9jZW50ZXJfMVxcXCIsXFxuICAgICAgICAgICAgICAgICAgICBkZXNjOiBcXFwiXFxcIixcXG4gICAgICAgICAgICAgICAgICAgIHBpY191cmw6IFxcXCJcXFwiLFxcbiAgICAgICAgICAgICAgICAgICAgZXh0cmE6IHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogcGFnZWlkXFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH0pXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSxcXG4gICAgICAgIHBhcmFtOiB7XFxuICAgICAgICAgICAgYWxsOiBkYXRhLmxlbmd0aCxcXG4gICAgICAgICAgICBpOiAwLFxcbiAgICAgICAgICAgIGo6IC0xXFxuICAgICAgICB9XFxuICAgIH0pO1xcbn1cIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuaQnOe0oui+heWKqVwiLFwicGF0aFwiOlwic3NcIixcInJ1bGVcIjpcIiQuZXhwb3J0cyA9IHtcXG4gICAgc2VhcmNoOiAocnVsZSwga3csIHBhZ2UpID0+IHtcXG4gICAgICAgIGxldCBkID0gW107XFxuICAgICAgICBsZXQgbSA9IHJ1bGUucnVsZVNlYXJjaFxcbiAgICAgICAgLy8g6ZiF6K+7PT7op4bnlYxcXG4gICAgICAgIGxldCB1ID0gcnVsZS5ib29rU291cmNlVXJsICsgcnVsZS5zZWFyY2hVcmw7XFxuICAgICAgICBsZXQgdXJsID0gdS5yZXBsYWNlKFxcXCJ7e3BhZ2V9fVxcXCIsIHBhZ2UpLnJlcGxhY2UoXFxcInt7a2V5fX1cXFwiLCBrdylcXG4gICAgICAgIGxldCBsaXN0cnVsZSA9IFxcXCJib2R5JiZcXFwiICsgbS5ib29rTGlzdC5yZXBsYWNlKC8hWzAtOV0vZywgXFxcIlxcXCIpLnJlcGxhY2UoXFxcIiBcXFwiLCBcXFwiJiZcXFwiKS5zcGxpdChcXFwifHxcXFwiKVswXVxcbiAgICAgICAgbGV0IGF1dGhvciA9IG0uYXV0aG9yLnJlcGxhY2UoXFxcIkBcXFwiLCBcXFwiJiZcXFwiKS5yZXBsYWNlKFxcXCJ0ZXh0XFxcIiwgXFxcIlRleHRcXFwiKS5yZXBsYWNlKC9cXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXG4gICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXCIuXFxcIiwgXFxcIixcXFwiKVxcbiAgICAgICAgfSlcXG4gICAgICAgIGxldCBjb3ZlciA9IG0uY292ZXJVcmwucmVwbGFjZShcXFwiQFxcXCIsIFxcXCImJlxcXCIpLnJlcGxhY2UoL1xcXFwuWzAtOV0vZywgZnVuY3Rpb24oYSkge1xcbiAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcIi5cXFwiLCBcXFwiLFxcXCIpXFxuICAgICAgICB9KVxcbiAgICAgICAgbGV0IG5hbWUgPSBtLm5hbWUucmVwbGFjZShcXFwiQFxcXCIsIFxcXCImJlxcXCIpLnJlcGxhY2UoXFxcInRleHRcXFwiLCBcXFwiVGV4dFxcXCIpLnJlcGxhY2UoL1xcXFwuWzAtOV0vZywgZnVuY3Rpb24oYSkge1xcbiAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcIi5cXFwiLCBcXFwiLFxcXCIpXFxuICAgICAgICB9KVxcbiAgICAgICAgbGV0IGJvb2t1cmwgPSBtLmJvb2tVcmwucmVwbGFjZShcXFwiQFxcXCIsIFxcXCImJlxcXCIpLnJlcGxhY2UoL1xcXFwuWzAtOV0vZywgZnVuY3Rpb24oYSkge1xcbiAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcIi5cXFwiLCBcXFwiLFxcXCIpXFxuICAgICAgICB9KVxcbiAgICAgICAgbGV0IGludHJvID0gbS5pbnRyby5yZXBsYWNlKFxcXCJAXFxcIiwgXFxcIiYmXFxcIikucmVwbGFjZShcXFwidGV4dFxcXCIsIFxcXCJUZXh0XFxcIikucmVwbGFjZSgvXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxuICAgICAgICAgICAgcmV0dXJuIGEucmVwbGFjZShcXFwiLlxcXCIsIFxcXCIsXFxcIilcXG4gICAgICAgIH0pO1xcbiAgICAgICAgLy9zZXRQYWdlVGl0bGUoXFxcIuaQnOe0olxcXCIgKyBnZXRQYXJhbShcXFwia3dcXFwiKSArIFxcXCIgXFxcIiArIE1ZX1BBUkFNUy5ib29rU291cmNlTmFtZSk7XFxuICAgICAgICAvL01ZX1VSTCA9IHVybDtcXG4gICAgICAgIGxldCByZXMgPSByZXF1ZXN0KHVybClcXG4gICAgICAgIGxldCBsaXN0ID0gcGRmYShyZXMsIGxpc3RydWxlKVxcbiAgICAgICAgbGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xcbiAgICAgICAgICAgIGQucHVzaCh7XFxuICAgICAgICAgICAgICAgIHRpdGxlOiBwYXJzZURvbUZvckh0bWwoaXRlbSwgbmFtZSksXFxuICAgICAgICAgICAgICAgIGltZzogcGFyc2VEb20oaXRlbSwgY292ZXIsIHVybCksXFxuICAgICAgICAgICAgICAgIHVybDogXFxcImhpa2VyOi8vcGFnZS9tZW51P3VybD1cXFwiICsgcGFyc2VEb20oaXRlbSwgYm9va3VybCwgdXJsKSArIFxcXCIjYXV0b0NhY2hlIyNpbW1lcnNpdmVUaGVtZSNcXFwiLFxcbiAgICAgICAgICAgICAgICBkZXNjOiBydWxlLmJvb2tTb3VyY2VOYW1lICsgXFxcIlxcXFxuXFxcIiArIHBhcnNlRG9tRm9ySHRtbChpdGVtLCBhdXRob3IpICsgXFxcIlxcXFxuXFxcIiArIHBhcnNlRG9tRm9ySHRtbChpdGVtLCBpbnRybyksXFxuICAgICAgICAgICAgICAgIGV4dHJhOiB7XFxuICAgICAgICAgICAgICAgICAgICBcXFwiVG9jXFxcIjogcnVsZS5ydWxlVG9jLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcImNvbnRlbnRcXFwiOiBydWxlLnJ1bGVDb250ZW50LFxcbiAgICAgICAgICAgICAgICAgICAgXFxcImJvb2tOYW1lXFxcIjogcGFyc2VEb21Gb3JIdG1sKGl0ZW0sIG5hbWUpLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcImNvdmVyXFxcIjogcGFyc2VEb20oaXRlbSwgY292ZXIsIHVybClcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH0pXFxuICAgICAgICB9KTtcXG4gICAgICAgIHJldHVybiBkO1xcbiAgICB9LFxcbiAgICBsaXN0UnVsZXM6IChwYWdlLCBydWxlKSA9PiB7XFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIC8v5bm25Y+R5pWw6YePXFxuICAgICAgICAgICAgbGV0IHNpemUgPSAxMDtcXG4gICAgICAgICAgICBsZXQgZGF0YTEgPSBKU09OLnBhcnNlKGZldGNoKFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L2xpc3QuanNvblxcXCIpKVxcbiAgICAgICAgICAgIGxldCBsaXN0ID0gSlNPTi5wYXJzZShmZXRjaChcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9cXFwiICsgbWQ1KGdldE15VmFyKFxcXCJ0YWJcXFwiLCBkYXRhMS51cmxzWzBdLm5hbWUpKSArIFxcXCIuanNvblxcXCIpKVxcbiAgICAgICAgICAgIGxldCBydWxlcyA9IFtdO1xcbiAgICAgICAgICAgIGxpc3QuZm9yRWFjaChpdGVtID0+IHtcXG4gICAgICAgICAgICAgICAgbGV0IHMgPSBKU09OLnN0cmluZ2lmeShpdGVtKVxcbiAgICAgICAgICAgICAgICBpZiAocy5pbmNsdWRlcyhcXFwiPGpzPlxcXCIpIHx8IHMuaW5jbHVkZXMoXFxcIkBqczpcXFwiKSB8fCBzLmluY2x1ZGVzKFxcXCIkLlxcXCIpIHx8IHMuaW5jbHVkZXMoXFxcIvCflJ5cXFwiKSkge1xcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XFxuICAgICAgICAgICAgICAgICAgICBydWxlcy5wdXNoKGl0ZW0pO1xcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfSk7XFxuICAgICAgICAgICAgaWYgKCFwYWdlICYmICFydWxlKSB7XFxuICAgICAgICAgICAgICAgIHJldHVybiBydWxlcy5tYXAoaXQgPT4gaXQubmFtZSk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGlmIChydWxlICE9IG51bGwpIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGVzLmZpbHRlcihpID0+IGkubmFtZSA9PSBydWxlKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgbGV0IHN0YXJ0ID0gKHBhZ2UgLSAxKSAqIHNpemU7XFxuICAgICAgICAgICAgaWYgKHJ1bGVzLmxlbmd0aCA8IHN0YXJ0ICsgMSkge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGxldCBsZW4gPSBzaXplO1xcbiAgICAgICAgICAgIGlmIChydWxlcy5sZW5ndGggPCBwYWdlICogc2l6ZSkge1xcbiAgICAgICAgICAgICAgICBsZW4gPSBydWxlcy5sZW5ndGggLSBzdGFydFxcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBsZXQgYWxsID0gcnVsZXMubGVuZ3RoO1xcbiAgICAgICAgICAgIGxldCB1c2UgPSAocGFnZSAtIDEpICogc2l6ZSArIGxlbjtcXG4gICAgICAgICAgICByZXR1cm4ge1xcbiAgICAgICAgICAgICAgICBhbGw6IGFsbCxcXG4gICAgICAgICAgICAgICAgdXNlOiB1c2UsXFxuICAgICAgICAgICAgICAgIGRhdGE6IHJ1bGVzLnNsaWNlKHN0YXJ0LCBzdGFydCArIGxlbilcXG4gICAgICAgICAgICB9O1xcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcbiAgICAgICAgICAgIHJldHVybiB7XFxuICAgICAgICAgICAgICAgIGFsbDogMCxcXG4gICAgICAgICAgICAgICAgdXNlOiAwLFxcbiAgICAgICAgICAgICAgICBkYXRhOiBbXVxcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cXG4gICAgfVxcbn1cIn1dLFwic2F2ZWRcIjpmYWxzZSxcInRpdGxlXCI6XCLmgqbor7tcIixcInZlcnNpb25cIjowLFwidXJsXCI6XCJoaWtlcjovL3BhZ2UvY29uZmlnXCIsXCJjb2xfdHlwZVwiOlwidGV4dF9jZW50ZXJfMVwiLFwiZmluZF9ydWxlXCI6XCJqczpcXG52YXIgZCA9IFtdO1xcbnRyeSB7XFxuICAgIGlmICghZmlsZUV4aXN0KFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L2xpc3QuanNvblxcXCIpKSB7XFxuICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcIiwgJ3tcXFwidXJsc1xcXCI6W119JylcXG4gICAgfVxcbiAgICBkLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCLmt7vliqDorqLpmIVcXFwiLFxcbiAgICAgICAgdXJsOiAkKFxcXCJcXFwiLCBcXFwi6K6i6ZiF5ZCN56ewXFxcIikuaW5wdXQoKCkgPT4ge1xcbiAgICAgICAgICAgIHJldHVybiAkKFxcXCJcXFwiLCBcXFwi6K6i6ZiF6ZO+5o6lXFxcIikuaW5wdXQoKG5hbWUpID0+IHtcXG4gICAgICAgICAgICAgICAgbGV0IGxpc3QgPSBKU09OLnBhcnNlKGZldGNoKFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L2xpc3QuanNvblxcXCIpKVxcbiAgICAgICAgICAgICAgICBsaXN0LnVybHMucHVzaCh7XFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBpbnB1dFxcbiAgICAgICAgICAgICAgICB9KVxcbiAgICAgICAgICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcIiwgSlNPTi5zdHJpbmdpZnkobGlzdCkpXFxuICAgICAgICAgICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IGZldGNoKGlucHV0KVxcbiAgICAgICAgICAgICAgICAgICAgSlNPTi5wYXJzZSh0KVxcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVGaWxlKFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L1xcXCIgKyBtZDUobmFtZSkgKyBcXFwiLmpzb25cXFwiLCB0KVxcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+WvvOWFpeaIkOWKn1xcXCJcXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+WvvOWFpeWksei0pVxcXCJcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZSgpXFxuICAgICAgICAgICAgfSwgaW5wdXQpXFxuICAgICAgICB9KVxcbiAgICB9KVxcbiAgICBsZXQgbGlzdCA9IEpTT04ucGFyc2UoZmV0Y2goXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcIikpXFxuICAgIGxpc3QudXJscy5mb3JFYWNoKChpdGVtLCBpKSA9PiB7XFxuICAgICAgICBkLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLm5hbWUsXFxuICAgICAgICAgICAgZGVzYzogaXRlbS51cmwsXFxuICAgICAgICAgICAgdXJsOiAkKFtcXFwi5Yig6ZmkXFxcIiwgXFxcIue8lui+keWQjeensFxcXCIsIFxcXCLnvJbovpHlnLDlnYBcXFwiLCBcXFwi5pu05pawXFxcIl0pLnNlbGVjdCgobGlzLCBpKSA9PiB7XFxuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gbGlzXFxuICAgICAgICAgICAgICAgIGlmIChpbnB1dCA9PSBcXFwi5Yig6ZmkXFxcIikge1xcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoXFxcIuehruiupOWIoOmZpO+8n1xcXCIpLmNvbmZpcm0oKGxpc3QsIGkpID0+IHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVGaWxlKFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L1xcXCIgKyBtZDUobGlzdC51cmxzW2ldLm5hbWUpICsgXFxcIi5qc29uXFxcIilcXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LnVybHMuc3BsaWNlKGksIDEpXFxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVGaWxlKFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L2xpc3QuanNvblxcXCIsIEpTT04uc3RyaW5naWZ5KGxpc3QpKSAgICAgICAgICAgICAgICAgICAgICAgIFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKClcXG4gICAgICAgICAgICAgICAgICAgIH0sIGxpc3QsIGkpXFxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgPT0gXFxcIue8lui+keWQjeensFxcXCIpIHtcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkKFxcXCJcXFwiKS5pbnB1dCgobGlzdCwgaSkgPT4ge1xcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QudXJsc1tpXS5uYW1lID0gaW5wdXRcXG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcIiwgSlNPTi5zdHJpbmdpZnkobGlzdCkpXFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKVxcbiAgICAgICAgICAgICAgICAgICAgfSwgbGlzdCwgaSlcXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9PSBcXFwi57yW6L6R5Zyw5Z2AXFxcIikge1xcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoXFxcIlxcXCIpLmlucHV0KChsaXN0LCBpKSA9PiB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC51cmxzW2ldLnVybCA9IGlucHV0XFxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVGaWxlKFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L2xpc3QuanNvblxcXCIsIEpTT04uc3RyaW5naWZ5KGxpc3QpKVxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKClcXG4gICAgICAgICAgICAgICAgICAgIH0sIGxpc3QsIGkpXFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XFxuICAgICAgICAgICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ID0gZmV0Y2gobGlzdC51cmxzW2ldLnVybClcXG4gICAgICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKHQpXFxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVGaWxlKFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L1xcXCIgKyBtZDUobGlzdC51cmxzW2ldLm5hbWUpICsgXFxcIi5qc29uXFxcIiwgdClcXG4gICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoUGFnZSgpXFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3QoXFxcIuabtOaWsOaIkOWKn1xcXCIpXFxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3QoXFxcIuabtOaWsOWksei0pVxcXCIpXFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB9LCBsaXN0LCBpKSxcXG4gICAgICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfMVxcXCJcXG4gICAgICAgIH0pXFxuICAgIH0pXFxufSBjYXRjaCAoZSkge1xcbiAgICBkLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCLplJnor6/vvJpcXFwiICsgZS5tZXNzYWdlLFxcbiAgICAgICAgY29sX3R5cGU6IFxcXCJ0ZXh0X2NlbnRlcl8xXFxcIixcXG4gICAgICAgIHVybDogXFxcImhpa2VyOi8vZW1wdHlcXFwiXFxuICAgIH0pXFxufVxcbnNldFJlc3VsdChkKTtcIixcImdyb3VwXCI6XCLikafpmIXor7tcIixcInVhXCI6XCJtb2JpbGVcIixcInByZVJ1bGVcIjpcIlwiLFwicGFnZXNcIjpcIlt7XFxcImNvbF90eXBlXFxcIjpcXFwidGV4dF8xXFxcIixcXFwibmFtZVxcXCI6XFxcIua6kOebruW9lVxcXCIsXFxcInBhdGhcXFwiOlxcXCJzb3VyY2VcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG52YXIgZCA9IFtdO1xcXFxudmFyIG0gPSBNWV9QQVJBTVMucnVsZXNcXFxcbnZhciBiYXNldXJsID0gbS5ib29rU291cmNlVXJsXFxcXG5pZiAobS5ydWxlRXhwbG9yZS5ib29rTGlzdCkge1xcXFxuICAgIHZhciBydWxlID0gbS5ydWxlRXhwbG9yZVxcXFxufSBlbHNlIHtcXFxcbiAgICB2YXIgcnVsZSA9IG0ucnVsZVNlYXJjaFxcXFxufVxcXFxuZC5wdXNoKHtcXFxcbiAgICB0aXRsZTogXFxcXFxcXCLmkJzntKJcXFxcXFxcIixcXFxcbiAgICBkZXNjOiBcXFxcXFxcIuivt+i+k+WFpeaQnOe0ouWFs+mUruivjVxcXFxcXFwiLFxcXFxuICAgIHVybDogJC50b1N0cmluZygoKSA9PiB7XFxcXG4gICAgICAgIHB1dE15VmFyKFxcXFxcXFwia3dcXFxcXFxcIiwgaW5wdXQpO1xcXFxuICAgICAgICByZXR1cm4gXFxcXFxcXCJoaWtlcjovL3BhZ2Uvc2VhcmNoP3A9ZnlwYWdlJmt3PVxcXFxcXFwiICsgaW5wdXRcXFxcbiAgICB9KSxcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJpbnB1dFxcXFxcXFwiLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIFxcXFxcXFwidVxcXFxcXFwiOiBiYXNldXJsICsgbS5zZWFyY2hVcmwsXFxcXG4gICAgICAgIFxcXFxcXFwicnVsZXNcXFxcXFxcIjogbSxcXFxcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRNeVZhcihcXFxcXFxcImt3XFxcXFxcXCIsIFxcXFxcXFwiXFxcXFxcXCIpLFxcXFxuICAgICAgICBib29rU291cmNlTmFtZTogbS5ib29rU291cmNlTmFtZVxcXFxuICAgIH1cXFxcbn0pXFxcXG5pZiAobS5lbmFibGVkRXhwbG9yZSYmbS5leHBsb3JlVXJsKSB7XFxcXG4gICAgSlNPTi5wYXJzZShtLmV4cGxvcmVVcmwpLmZvckVhY2goaXRlbSA9PiB7XFxcXG4gICAgICAgIGQucHVzaCh7XFxcXG4gICAgICAgICAgICB0aXRsZTogaXRlbS50aXRsZSxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBpdGVtLnN0eWxlLmxheW91dF9mbGV4QmFzaXNQZXJjZW50ID09IDEgPyBcXFxcXFxcInRleHRfY2VudGVyXzFcXFxcXFxcIiA6IFxcXFxcXFwidGV4dF8zXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICB1cmw6IGl0ZW0udXJsID09IFxcXFxcXFwiXFxcXFxcXCIgPyBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIiA6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL2Jvb2tzP3A9ZnlwYWdlXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgICAgIFxcXFxcXFwiYWxsXFxcXFxcXCI6IG0sXFxcXG4gICAgICAgICAgICAgICAgXFxcXFxcXCJydWxlc1xcXFxcXFwiOiBydWxlLFxcXFxuICAgICAgICAgICAgICAgIFxcXFxcXFwidVxcXFxcXFwiOiBiYXNldXJsICsgaXRlbS51cmxcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfSlcXFxcbiAgICB9KVxcXFxufVxcXFxuc2V0UmVzdWx0KGQpO1xcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJtb3ZpZV8zXFxcIixcXFwibmFtZVxcXCI6XFxcIuS4u+mhtVxcXCIsXFxcInBhdGhcXFwiOlxcXCJob21lXFxcIixcXFwicnVsZVxcXCI6XFxcInZhciBkID0gW107XFxcXG5pZiAoZmlsZUV4aXN0KFxcXFxcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFxcXFxcIikgJiYgSlNPTi5wYXJzZShmZXRjaChcXFxcXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcXFxcXCIpKS51cmxzLmxlbmd0aCAhPSAwKSB7XFxcXG4gICAgZC5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6IFxcXFxcXFwi4pqZ77iP6K6+572uXFxcXFxcXCIsXFxcXG4gICAgICAgIHVybDogXFxcXFxcXCJoaWtlcjovL3BhZ2UvY29uZmlnXFxcXFxcXCIsXFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInNjcm9sbF9idXR0b25cXFxcXFxcIlxcXFxuICAgIH0pO1xcXFxuICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShmZXRjaChcXFxcXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcXFxcXCIpKVxcXFxuICAgIGRhdGEudXJscy5mb3JFYWNoKGl0ZW0gPT4ge1xcXFxuICAgICAgICBkLnB1c2goe1xcXFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW0ubmFtZSxcXFxcbiAgICAgICAgICAgIHVybDogJCgpLmxhenlSdWxlKChpKSA9PiB7XFxcXG4gICAgICAgICAgICAgICAgcHV0TXlWYXIoXFxcXFxcXCJ0YWJcXFxcXFxcIiwgaSlcXFxcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZSgpXFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/liIfmjaLmiJDlip9cXFxcXFxcIlxcXFxuICAgICAgICAgICAgfSwgaXRlbS5uYW1lKSxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInNjcm9sbF9idXR0b25cXFxcXFxcIlxcXFxuICAgICAgICB9KVxcXFxuICAgIH0pXFxcXG4gICAgZC5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6IFxcXFxcXFwi5pCc57SiXFxcXFxcXCIsXFxcXG4gICAgICAgIHVybDogJC50b1N0cmluZygoKSA9PiB7XFxcXG4gICAgICAgICAgICBwdXRNeVZhcihcXFxcXFxcImt3XFxcXFxcXCIsIGlucHV0KTtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcImhpa2VyOi8vcGFnZS9qdT9wPWZ5cGFnZSZrdz1cXFxcXFxcIiArIGlucHV0XFxcXG4gICAgICAgIH0pLFxcXFxuICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJpbnB1dFxcXFxcXFwiLFxcXFxuICAgICAgICBkZXNjOiBcXFxcXFxcIuiBmuWQiOaQnOe0ou+8jOivt+i+k+WFpeWFs+mUruivjVxcXFxcXFwiLFxcXFxuICAgICAgICBwaWNfdXJsOiBcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRNeVZhcihcXFxcXFxcImt3XFxcXFxcXCIsIFxcXFxcXFwiXFxcXFxcXCIpXFxcXG4gICAgICAgIH1cXFxcbiAgICB9KTtcXFxcbiAgICBsZXQgbGlzdCA9IEpTT04ucGFyc2UoZmV0Y2goXFxcXFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L1xcXFxcXFwiICsgbWQ1KGdldE15VmFyKFxcXFxcXFwidGFiXFxcXFxcXCIsIGRhdGEudXJsc1swXS5uYW1lKSkgKyBcXFxcXFxcIi5qc29uXFxcXFxcXCIpKVxcXFxuICAgIGxpc3QuZm9yRWFjaChpdGVtID0+IHtcXFxcbiAgICAgICAgbGV0IHMgPSBKU09OLnN0cmluZ2lmeShpdGVtKVxcXFxuICAgICAgICBpZiAocy5pbmNsdWRlcyhcXFxcXFxcIjxqcz5cXFxcXFxcIikgfHwgcy5pbmNsdWRlcyhcXFxcXFxcIkBqczpcXFxcXFxcIikgfHwgcy5pbmNsdWRlcyhcXFxcXFxcIiQuXFxcXFxcXCIpIHx8IHMuaW5jbHVkZXMoXFxcXFxcXCLwn5SeXFxcXFxcXCIpKSB7XFxcXG4gICAgICAgICAgICB2YXIgdXJsID0gXFxcXFxcXCJ0b2FzdDovL+W9k+WJjeS5pua6kOaaguS4jeaUr+aMgVxcXFxcXFwiXFxcXG4gICAgICAgICAgICByZXR1cm5cXFxcbiAgICAgICAgfSBlbHNlIHtcXFxcbiAgICAgICAgICAgIHZhciB1cmwgPSBcXFxcXFxcImhpa2VyOi8vcGFnZS9zb3VyY2U/cD1meXBhZ2VcXFxcXFxcIlxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGQucHVzaCh7XFxcXG4gICAgICAgICAgICB0aXRsZTogaXRlbS5ib29rU291cmNlTmFtZSArIGAoJHtpdGVtLmJvb2tTb3VyY2VHcm91cH0pYCxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfMlxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgdXJsOiB1cmwsXFxcXG4gICAgICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgICAgIFxcXFxcXFwicnVsZXNcXFxcXFxcIjogaXRlbVxcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9KVxcXFxuICAgIH0pXFxcXG59IGVsc2Uge1xcXFxuICAgIHNldFJlc3VsdChbe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLkvaDov5jmsqHmnInkuablk6bvvZ7vvZ7ngrnmiJHov5vlhaXorr7nva5cXFxcXFxcIixcXFxcbiAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9jb25maWdcXFxcXFxcIixcXFxcbiAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF9jZW50ZXJfMVxcXFxcXFwiXFxcXG4gICAgfV0pXFxcXG59XFxcXG5zZXRSZXN1bHQoZCk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzFfdmVydGljYWxfcGljXFxcIixcXFwibmFtZVxcXCI6XFxcIuWIl+ihqFxcXCIsXFxcInBhdGhcXFwiOlxcXCJib29rc1xcXCIsXFxcInJ1bGVcXFwiOlxcXCJqczpcXFxcbnZhciBkID0gW107XFxcXG50cnkge1xcXFxuICAgIHZhciBtID0gTVlfUEFSQU1TLnJ1bGVzXFxcXG4gICAgLy8g6ZiF6K+7PT7op4bnlYxcXFxcbiAgICB2YXIgdXJsID0gTVlfUEFSQU1TLnUucmVwbGFjZShcXFxcXFxcInt7cGFnZX19XFxcXFxcXCIsIE1ZX1BBR0UpXFxcXG4gICAgdmFyIGxpc3RydWxlID0gXFxcXFxcXCJib2R5JiZcXFxcXFxcIiArIG0uYm9va0xpc3QucmVwbGFjZSgvXFxcXFxcXFwhWzAtOV0vZywgXFxcXFxcXCJcXFxcXFxcIikucmVwbGFjZShcXFxcXFxcIiBcXFxcXFxcIiwgXFxcXFxcXCImJlxcXFxcXFwiKS5zcGxpdChcXFxcXFxcInx8XFxcXFxcXCIpWzBdXFxcXG4gICAgaWYgKG0uYXV0aG9yKSB7XFxcXG4gICAgICAgIHZhciBhdXRob3IgPSBtLmF1dGhvci5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpLnJlcGxhY2UoXFxcXFxcXCJ0ZXh0XFxcXFxcXCIsIFxcXFxcXFwiVGV4dFxcXFxcXFwiKS5yZXBsYWNlKC9cXFxcXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXFxcXFwiLlxcXFxcXFwiLCBcXFxcXFxcIixcXFxcXFxcIilcXFxcbiAgICAgICAgfSlcXFxcbiAgICB9IGVsc2Uge1xcXFxuICAgICAgICB2YXIgYXV0aG9yID0gZmFsc2VcXFxcbiAgICB9XFxcXG4gICAgaWYgKG0uY292ZXJVcmwpIHtcXFxcbiAgICAgICAgdmFyIGNvdmVyID0gbS5jb3ZlclVybC5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpLnJlcGxhY2UoL1xcXFxcXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXFxcbiAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcXFxcXCIuXFxcXFxcXCIsIFxcXFxcXFwiLFxcXFxcXFwiKVxcXFxuICAgICAgICB9KVxcXFxuICAgIH0gZWxzZSB7XFxcXG4gICAgICAgIHZhciBjb3ZlciA9IGZhbHNlXFxcXG4gICAgfVxcXFxuICAgIHZhciBuYW1lID0gbS5uYW1lLnJlcGxhY2UoXFxcXFxcXCJAXFxcXFxcXCIsIFxcXFxcXFwiJiZcXFxcXFxcIikucmVwbGFjZShcXFxcXFxcInRleHRcXFxcXFxcIiwgXFxcXFxcXCJUZXh0XFxcXFxcXCIpLnJlcGxhY2UoL1xcXFxcXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXFxcbiAgICAgICAgcmV0dXJuIGEucmVwbGFjZShcXFxcXFxcIi5cXFxcXFxcIiwgXFxcXFxcXCIsXFxcXFxcXCIpXFxcXG4gICAgfSlcXFxcbiAgICB2YXIgYm9va3VybCA9IG0uYm9va1VybC5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpLnJlcGxhY2UoL1xcXFxcXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXFxcbiAgICAgICAgcmV0dXJuIGEucmVwbGFjZShcXFxcXFxcIi5cXFxcXFxcIiwgXFxcXFxcXCIsXFxcXFxcXCIpXFxcXG4gICAgfSlcXFxcbiAgICBpZiAobS5pbnRybykge1xcXFxuICAgICAgICB2YXIgaW50cm8gPSBtLmludHJvLnJlcGxhY2UoXFxcXFxcXCJAXFxcXFxcXCIsIFxcXFxcXFwiJiZcXFxcXFxcIikucmVwbGFjZShcXFxcXFxcInRleHRcXFxcXFxcIiwgXFxcXFxcXCJUZXh0XFxcXFxcXCIpLnJlcGxhY2UoL1xcXFxcXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXFxcbiAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcXFxcXCIuXFxcXFxcXCIsIFxcXFxcXFwiLFxcXFxcXFwiKVxcXFxuICAgICAgICB9KVxcXFxuICAgIH0gZWxzZSB7XFxcXG4gICAgICAgIHZhciBpbnRybyA9IGZhbHNlXFxcXG4gICAgfVxcXFxuICAgIE1ZX1VSTCA9IHVybDtcXFxcbiAgICB2YXIgcmVzID0gcmVxdWVzdCh1cmwpXFxcXG4gICAgbGV0IGxpc3QgPSBwZGZhKHJlcywgbGlzdHJ1bGUpXFxcXG4gICAgaWYgKGxpc3QubGVuZ3RoID4gMCkge1xcXFxuICAgICAgICBsaXN0LmZvckVhY2goaXRlbSA9PiB7XFxcXG4gICAgICAgICAgICBkLnB1c2goe1xcXFxuICAgICAgICAgICAgICAgIGNvbF90eXBlOiAoY292ZXIgPyBcXFxcXFxcIm1vdmllXzFfdmVydGljYWxfcGljXFxcXFxcXCIgOiBcXFxcXFxcInRleHRfMVxcXFxcXFwiKSxcXFxcbiAgICAgICAgICAgICAgICB0aXRsZTogcGFyc2VEb21Gb3JIdG1sKGl0ZW0sIG5hbWUpLFxcXFxuICAgICAgICAgICAgICAgIGltZzogKGNvdmVyID8gcGFyc2VEb20oaXRlbSwgY292ZXIpICsgXFxcXFxcXCJAUmVmZXJlcj1cXFxcXFxcIiA6IFxcXFxcXFwiaGlrZXI6Ly9lbXB0eVxcXFxcXFwiKSxcXFxcbiAgICAgICAgICAgICAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL21lbnU/dXJsPVxcXFxcXFwiICsgcGFyc2VEb20oaXRlbSwgYm9va3VybCkgKyBcXFxcXFxcIiNhdXRvQ2FjaGUjI2ltbWVyc2l2ZVRoZW1lI1xcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgIGRlc2M6IChhdXRob3IgPyBwYXJzZURvbUZvckh0bWwoaXRlbSwgYXV0aG9yKSA6IFxcXFxcXFwiXFxcXFxcXCIpICsgXFxcXFxcXCJcXFxcXFxcXG5cXFxcXFxcIiArIChpbnRybyA/IHBhcnNlRG9tRm9ySHRtbChpdGVtLCBpbnRybykgOiBcXFxcXFxcIlxcXFxcXFwiKSxcXFxcbiAgICAgICAgICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcImJvb2tOYW1lXFxcXFxcXCI6IHBhcnNlRG9tRm9ySHRtbChpdGVtLCBuYW1lKSxcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJjb3ZlclxcXFxcXFwiOiAoY292ZXIgPyBwYXJzZURvbShpdGVtLCBjb3ZlcikgKyBcXFxcXFxcIkBSZWZlcmVyPVxcXFxcXFwiIDogXFxcXFxcXCJoaWtlcjovL2VtcHR5XFxcXFxcXCIpLFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcIlRvY1xcXFxcXFwiOiBNWV9QQVJBTVMuYWxsLnJ1bGVUb2MsXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwiY29udGVudFxcXFxcXFwiOiBNWV9QQVJBTVMuYWxsLnJ1bGVDb250ZW50XFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgfSlcXFxcbiAgICAgICAgfSlcXFxcbiAgICB9IGVsc2Uge1xcXFxuICAgICAgICBkLnB1c2goe1xcXFxuICAgICAgICAgICAgdGl0bGU6IFxcXFxcXFwi5YiX6KGo5Yqg6L295aSx6LSl77yaXFxcXFxcXCIgKyBsaXN0cnVsZSxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfY2VudGVyXzFcXFxcXFxcIixcXFxcbiAgICAgICAgICAgIHVybDogXFxcXFxcXCJoaWtlcjovL2VtcHR5XFxcXFxcXCJcXFxcbiAgICAgICAgfSlcXFxcbiAgICB9XFxcXG59IGNhdGNoIChlKSB7XFxcXG4gICAgZC5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6IFxcXFxcXFwi5Yqg6L295aSx6LSl77yaXFxcXFxcXCIgKyBlLm1lc3NhZ2UsXFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfY2VudGVyXzFcXFxcXFxcIixcXFxcbiAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIlxcXFxuICAgIH0pXFxcXG59XFxcXG5zZXRSZXN1bHQoZCk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcInRleHRfY2VudGVyXzFcXFwiLFxcXCJuYW1lXFxcIjpcXFwi6K6+572uXFxcIixcXFwicGF0aFxcXCI6XFxcImNvbmZpZ1xcXCIsXFxcInJ1bGVcXFwiOlxcXCJqczpcXFxcbnZhciBkID0gW107XFxcXG50cnkge1xcXFxuICAgIGlmICghZmlsZUV4aXN0KFxcXFxcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFxcXFxcIikpIHtcXFxcbiAgICAgICAgd3JpdGVGaWxlKFxcXFxcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFxcXFxcIiwgJ3tcXFxcXFxcInVybHNcXFxcXFxcIjpbXX0nKVxcXFxuICAgIH1cXFxcbiAgICBkLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLmt7vliqDorqLpmIVcXFxcXFxcIixcXFxcbiAgICAgICAgdXJsOiAkKFxcXFxcXFwiXFxcXFxcXCIsIFxcXFxcXFwi6K6i6ZiF5ZCN56ewXFxcXFxcXCIpLmlucHV0KCgpID0+IHtcXFxcbiAgICAgICAgICAgIHJldHVybiAkKFxcXFxcXFwiXFxcXFxcXCIsIFxcXFxcXFwi6K6i6ZiF6ZO+5o6lXFxcXFxcXCIpLmlucHV0KChuYW1lKSA9PiB7XFxcXG4gICAgICAgICAgICAgICAgbGV0IGxpc3QgPSBKU09OLnBhcnNlKGZldGNoKFxcXFxcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFxcXFxcIikpXFxcXG4gICAgICAgICAgICAgICAgbGlzdC51cmxzLnB1c2goe1xcXFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxcXFxuICAgICAgICAgICAgICAgICAgICB1cmw6IGlucHV0XFxcXG4gICAgICAgICAgICAgICAgfSlcXFxcbiAgICAgICAgICAgICAgICB3cml0ZUZpbGUoXFxcXFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L2xpc3QuanNvblxcXFxcXFwiLCBKU09OLnN0cmluZ2lmeShsaXN0KSlcXFxcbiAgICAgICAgICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IGZldGNoKGlucHV0KVxcXFxuICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKHQpXFxcXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlRmlsZShcXFxcXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvXFxcXFxcXCIgKyBtZDUobmFtZSkgKyBcXFxcXFxcIi5qc29uXFxcXFxcXCIsIHQpXFxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5a+85YWl5oiQ5YqfXFxcXFxcXCJcXFxcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5a+85YWl5aSx6LSlXFxcXFxcXCJcXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKVxcXFxuICAgICAgICAgICAgfSwgaW5wdXQpXFxcXG4gICAgICAgIH0pXFxcXG4gICAgfSlcXFxcbiAgICBsZXQgbGlzdCA9IEpTT04ucGFyc2UoZmV0Y2goXFxcXFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L2xpc3QuanNvblxcXFxcXFwiKSlcXFxcbiAgICBsaXN0LnVybHMuZm9yRWFjaCgoaXRlbSwgaSkgPT4ge1xcXFxuICAgICAgICBkLnB1c2goe1xcXFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW0ubmFtZSxcXFxcbiAgICAgICAgICAgIGRlc2M6IGl0ZW0udXJsLFxcXFxuICAgICAgICAgICAgdXJsOiAkKFtcXFxcXFxcIuWIoOmZpFxcXFxcXFwiLCBcXFxcXFxcIue8lui+keWQjeensFxcXFxcXFwiLCBcXFxcXFxcIue8lui+keWcsOWdgFxcXFxcXFwiLCBcXFxcXFxcIuabtOaWsFxcXFxcXFwiXSkuc2VsZWN0KChsaXMsIGkpID0+IHtcXFxcbiAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IGxpc1xcXFxuICAgICAgICAgICAgICAgIGlmIChpbnB1dCA9PSBcXFxcXFxcIuWIoOmZpFxcXFxcXFwiKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkKFxcXFxcXFwi56Gu6K6k5Yig6Zmk77yfXFxcXFxcXCIpLmNvbmZpcm0oKGxpc3QsIGkpID0+IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZUZpbGUoXFxcXFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L1xcXFxcXFwiICsgbWQ1KGxpc3QudXJsc1tpXS5uYW1lKSArIFxcXFxcXFwiLmpzb25cXFxcXFxcIilcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QudXJscy5zcGxpY2UoaSwgMSlcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlRmlsZShcXFxcXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcXFxcXCIsIEpTT04uc3RyaW5naWZ5KGxpc3QpKSAgICAgICAgICAgICAgICAgICAgICAgIFxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKVxcXFxuICAgICAgICAgICAgICAgICAgICB9LCBsaXN0LCBpKVxcXFxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgPT0gXFxcXFxcXCLnvJbovpHlkI3np7BcXFxcXFxcIikge1xcXFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJChcXFxcXFxcIlxcXFxcXFwiKS5pbnB1dCgobGlzdCwgaSkgPT4ge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC51cmxzW2ldLm5hbWUgPSBpbnB1dFxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVGaWxlKFxcXFxcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9saXN0Lmpzb25cXFxcXFxcIiwgSlNPTi5zdHJpbmdpZnkobGlzdCkpXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoUGFnZSgpXFxcXG4gICAgICAgICAgICAgICAgICAgIH0sIGxpc3QsIGkpXFxcXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9PSBcXFxcXFxcIue8lui+keWcsOWdgFxcXFxcXFwiKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkKFxcXFxcXFwiXFxcXFxcXCIpLmlucHV0KChsaXN0LCBpKSA9PiB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LnVybHNbaV0udXJsID0gaW5wdXRcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlRmlsZShcXFxcXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcXFxcXCIsIEpTT04uc3RyaW5naWZ5KGxpc3QpKVxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKVxcXFxuICAgICAgICAgICAgICAgICAgICB9LCBsaXN0LCBpKVxcXFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XFxcXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IGZldGNoKGxpc3QudXJsc1tpXS51cmwpXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKHQpXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZUZpbGUoXFxcXFxcXCJoaWtlcjovL2ZpbGVzL3l1ZWR1L1xcXFxcXFwiICsgbWQ1KGxpc3QudXJsc1tpXS5uYW1lKSArIFxcXFxcXFwiLmpzb25cXFxcXFxcIiwgdClcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKClcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0KFxcXFxcXFwi5pu05paw5oiQ5YqfXFxcXFxcXCIpXFxcXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0KFxcXFxcXFwi5pu05paw5aSx6LSlXFxcXFxcXCIpXFxcXG4gICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICB9LCBsaXN0LCBpKSxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfMVxcXFxcXFwiXFxcXG4gICAgICAgIH0pXFxcXG4gICAgfSlcXFxcbn0gY2F0Y2ggKGUpIHtcXFxcbiAgICBkLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLplJnor6/vvJpcXFxcXFxcIiArIGUubWVzc2FnZSxcXFxcbiAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF9jZW50ZXJfMVxcXFxcXFwiLFxcXFxuICAgICAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9lbXB0eVxcXFxcXFwiXFxcXG4gICAgfSlcXFxcbn1cXFxcbnNldFJlc3VsdChkKTtcXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwidGV4dF8xXFxcIixcXFwibmFtZVxcXCI6XFxcIuebruW9lVxcXCIsXFxcInBhdGhcXFwiOlxcXCJtZW51XFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxudmFyIGQgPSBbXTtcXFxcbnZhciByZXMgPSBnZXRSZXNDb2RlKClcXFxcbmxldCBUb2MgPSBNWV9QQVJBTVMuVG9jXFxcXG5sZXQge1xcXFxuICAgIGdldEFycmF5LFxcXFxuICAgIGdldFRleHQsXFxcXG4gICAgZ2V0VXJsMFxcXFxufSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS9jb252ZXJ0ZXJcXFxcXFxcIik7XFxcXG5nZXRBcnJheShyZXMsIFRvYy5jaGFwdGVyTGlzdCkuZm9yRWFjaChpdGVtID0+IHtcXFxcbiAgICAvL2xvZyhpdGVtKTsgICAgXFxcXG4gICAgdmFyIHRpdGxlID0gZ2V0VGV4dChpdGVtLCBUb2MuY2hhcHRlck5hbWUpXFxcXG4gICAgaWYgKHRpdGxlICE9IFxcXFxcXFwiXFxcXFxcXCIpIHtcXFxcbiAgICAgICAgZC5wdXNoKHtcXFxcbiAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcXFxcbiAgICAgICAgICAgIHVybDogXFxcXFxcXCJoaWtlcjovL3BhZ2UvY29udGVudFxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgZXh0cmE6IHtcXFxcbiAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsXFxcXG4gICAgICAgICAgICAgICAgY29udGVudDogTVlfUEFSQU1TLmNvbnRlbnQsXFxcXG4gICAgICAgICAgICAgICAgdXJsOiBnZXRVcmwwKGl0ZW0sIFRvYy5jaGFwdGVyTGlzdCwgVG9jLmNoYXB0ZXJVcmwpICsgXFxcXFxcXCIjYXV0b1BhZ2UjI3JlYWRUaGVtZSNcXFxcXFxcIlxcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9KVxcXFxuICAgIH1cXFxcbn0pXFxcXG52YXIgY3AgPSBkLm1hcChmdW5jdGlvbihpdGVtKSB7XFxcXG4gICAgcmV0dXJuIHtcXFxcbiAgICAgICAgXFxcXFxcXCJ0aXRsZVxcXFxcXFwiOiBpdGVtLnRpdGxlLFxcXFxuICAgICAgICBcXFxcXFxcInVybFxcXFxcXFwiOiBpdGVtLmV4dHJhLnVybC5yZXBsYWNlKFxcXFxcXFwiI2F1dG9QYWdlIyNyZWFkVGhlbWUjXFxcXFxcXCIsIFxcXFxcXFwiXFxcXFxcXCIpXFxcXG4gICAgfVxcXFxufSlcXFxcbmQudW5zaGlmdCh7XFxcXG4gICAgdGl0bGU6IFxcXFxcXFwi5LiL6L29XFxcXFxcXCIsXFxcXG4gICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9kb3dubG9hZC52aWV3I25vUmVjb3JkSGlzdG9yeSMjbm9SZWZyZXNoIyNub0hpc3RvcnkjP3J1bGU95pys5Zyw6LWE5rqQ566h55CGXFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF9jZW50ZXJfMVxcXFxcXFwiLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIGNoYXB0ZXJMaXN0OiBjcCxcXFxcbiAgICAgICAgZGVmYXVsdFZpZXc6IFxcXFxcXFwiMVxcXFxcXFwiLFxcXFxuICAgICAgICBpbmZvOiB7XFxcXG4gICAgICAgICAgICBib29rTmFtZTogTVlfUEFSQU1TLmJvb2tOYW1lLFxcXFxuICAgICAgICAgICAgYm9va1RvcFBpYzogTVlfUEFSQU1TLmNvdmVyLFxcXFxuICAgICAgICAgICAgcnVsZU5hbWU6IFxcXFxcXFwi5oKm6K+7XFxcXFxcXCIsXFxcXG4gICAgICAgICAgICBwYXJzZUNvZGU6ICQudG9TdHJpbmcoKE1ZX1BBUkFNUykgPT4ge1xcXFxuICAgICAgICAgICAgICAgIHZhciByZXMgPSByZXF1ZXN0KGlucHV0KTtcXFxcbiAgICAgICAgICAgICAgICB2YXIgcnVsZSA9IE1ZX1BBUkFNUy5jb250ZW50O1xcXFxuICAgICAgICAgICAgICAgIGxldCByID0gcnVsZS5jb250ZW50LnJlcGxhY2UoXFxcXFxcXCJAXFxcXFxcXCIsIFxcXFxcXFwiJiZcXFxcXFxcIikucmVwbGFjZShcXFxcXFxcInRleHRcXFxcXFxcIiwgXFxcXFxcXCJUZXh0XFxcXFxcXCIpLnJlcGxhY2UoL1xcXFxcXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEucmVwbGFjZShcXFxcXFxcIi5cXFxcXFxcIiwgXFxcXFxcXCIsXFxcXFxcXCIpXFxcXG4gICAgICAgICAgICAgICAgfSk7XFxcXG4gICAgICAgICAgICAgICAgbGV0IHIxID0gci5zcGxpdChcXFxcXFxcIiYmXFxcXFxcXCIpO1xcXFxuICAgICAgICAgICAgICAgIGxldCByMiA9IHIxLnNsaWNlKDAsIHIxLmxlbmd0aCAtIDEpLmpvaW4oXFxcXFxcXCImJlxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgICAgICBsZXQgYXJyID0gcGRmYShyZXMsIFxcXFxcXFwiYm9keSYmXFxcXFxcXCIgKyByMik7XFxcXG4gICAgICAgICAgICAgICAgLy9sb2coYXJyKTtcXFxcbiAgICAgICAgICAgICAgICB2YXIgdHQgPSBcXFxcXFxcIlxcXFxcXFwiXFxcXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaXQgb2YgYXJyKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgIGl0ID0gaXQucmVwbGFjZShuZXcgUmVnRXhwKFxcXFxcXFwiXFxcXFxcXFxuXFxcXFxcXCIsIFxcXFxcXFwiZ1xcXFxcXFwiKSwgXFxcXFxcXCItLWJyLS1cXFxcXFxcIik7XFxcXG4gICAgICAgICAgICAgICAgICAgIC8vbG9nKGl0KTtcXFxcbiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBwZGZoKGl0LCBcXFxcXFxcIlRleHRcXFxcXFxcIik7XFxcXG4gICAgICAgICAgICAgICAgICAgIHQgPSB0LnJlcGxhY2UobmV3IFJlZ0V4cChcXFxcXFxcIi0tYnItLVxcXFxcXFwiLCBcXFxcXFxcImdcXFxcXFxcIiksIFxcXFxcXFwiPGJyPlxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT0gXFxcXFxcXCJcXFxcXFxcIikge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcXFxcbiAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgICAgICBsZXQgdDIgPSB0LnNwbGl0KFxcXFxcXFwiPGJyPlxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaXQyIG9mIHQyKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXQyID09IFxcXFxcXFwiXFxcXFxcXCIgfHwgaXQyLmxlbmd0aCA9PSAxKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXQyLnN0YXJ0c1dpdGgoXFxcXFxcXCLjgIBcXFxcXFxcIikgJiYgIWl0Mi5zdGFydHNXaXRoKFxcXFxcXFwiJm5ic3A7Jm5ic3A7XFxcXFxcXCIpKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXQyID0gXFxcXFxcXCImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDtcXFxcXFxcIiArIGl0Mi50cmltKCk7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS5yZXBsYWNlUmVnZXgpIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdDIgPSBpdDIucmVwbGFjZShuZXcgUmVnRXhwKHJ1bGUucmVwbGFjZVJlZ2V4LnJlcGxhY2UoXFxcXFxcXCIjI1xcXFxcXFwiLCBcXFxcXFxcIlxcXFxcXFwiKSwgXFxcXFxcXCJnXFxcXFxcXCIpLCBcXFxcXFxcIlxcXFxcXFwiKVxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0MiA9PSBcXFxcXFxcIlxcXFxcXFwiKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR0ICs9IGl0MiArIFxcXFxcXFwiXFxcXFxcXFxuXFxcXFxcXCJcXFxcbiAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gdHRcXFxcbiAgICAgICAgICAgIH0sIE1ZX1BBUkFNUyksXFxcXG4gICAgICAgICAgICB0eXBlOiBcXFxcXFxcIm5vdmVsXFxcXFxcXCJcXFxcbiAgICAgICAgfVxcXFxuICAgIH1cXFxcbn0pXFxcXG5kLnVuc2hpZnQoe1xcXFxuICAgIHRpdGxlOiBNWV9QQVJBTVMuYm9va05hbWUsXFxcXG4gICAgaW1nOiBNWV9QQVJBTVMuY292ZXIsXFxcXG4gICAgdXJsOiBNWV9VUkwsXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwibW92aWVfMV92ZXJ0aWNhbF9waWNfYmx1clxcXFxcXFwiXFxcXG59KVxcXFxuc2V0UmVzdWx0KGQpO1xcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJtb3ZpZV8zXFxcIixcXFwibmFtZVxcXCI6XFxcIuWGheWuuVxcXCIsXFxcInBhdGhcXFwiOlxcXCJjb250ZW50XFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxudmFyIGQgPSBbXTtcXFxcbnZhciByZXMgPSBnZXRSZXNDb2RlKClcXFxcbnZhciBydWxlID0gTVlfUEFSQU1TLmNvbnRlbnRcXFxcbmxldCByID0gcnVsZS5jb250ZW50LnJlcGxhY2UoXFxcXFxcXCJAXFxcXFxcXCIsIFxcXFxcXFwiJiZcXFxcXFxcIikucmVwbGFjZShcXFxcXFxcInRleHRcXFxcXFxcIiwgXFxcXFxcXCJUZXh0XFxcXFxcXCIpLnJlcGxhY2UoL1xcXFxcXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXFxcbiAgICByZXR1cm4gYS5yZXBsYWNlKFxcXFxcXFwiLlxcXFxcXFwiLCBcXFxcXFxcIixcXFxcXFxcIilcXFxcbn0pO1xcXFxubGV0IHIxID0gci5zcGxpdChcXFxcXFxcIiYmXFxcXFxcXCIpO1xcXFxubGV0IHIyID0gcjEuc2xpY2UoMCwgcjEubGVuZ3RoIC0gMSkuam9pbihcXFxcXFxcIiYmXFxcXFxcXCIpO1xcXFxubGV0IGFyciA9IHBkZmEocmVzLCBcXFxcXFxcImJvZHkmJlxcXFxcXFwiICsgcjIpO1xcXFxuLy9sb2coYXJyKTtcXFxcbmZvciAobGV0IGl0IG9mIGFycikge1xcXFxuICAgIGl0ID0gaXQucmVwbGFjZShuZXcgUmVnRXhwKFxcXFxcXFwiXFxcXFxcXFxuXFxcXFxcXCIsIFxcXFxcXFwiZ1xcXFxcXFwiKSwgXFxcXFxcXCItLWJyLS1cXFxcXFxcIik7XFxcXG4gICAgLy9sb2coaXQpO1xcXFxuICAgIHZhciB0ID0gcGRmaChpdCwgXFxcXFxcXCJUZXh0XFxcXFxcXCIpO1xcXFxuICAgIHQgPSB0LnJlcGxhY2UobmV3IFJlZ0V4cChcXFxcXFxcIi0tYnItLVxcXFxcXFwiLCBcXFxcXFxcImdcXFxcXFxcIiksIFxcXFxcXFwiPGJyPlxcXFxcXFwiKTtcXFxcbiAgICBpZiAodCA9PSBcXFxcXFxcIlxcXFxcXFwiKSB7XFxcXG4gICAgICAgIGNvbnRpbnVlXFxcXG4gICAgfVxcXFxuICAgIGxldCB0MiA9IHQuc3BsaXQoXFxcXFxcXCI8YnI+XFxcXFxcXCIpO1xcXFxuICAgIGZvciAobGV0IGl0MiBvZiB0Mikge1xcXFxuICAgICAgICBpZiAoaXQyID09IFxcXFxcXFwiXFxcXFxcXCIgfHwgaXQyLmxlbmd0aCA9PSAxKSB7XFxcXG4gICAgICAgICAgICBjb250aW51ZVxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGlmICghaXQyLnN0YXJ0c1dpdGgoXFxcXFxcXCLjgIBcXFxcXFxcIikgJiYgIWl0Mi5zdGFydHNXaXRoKFxcXFxcXFwiJm5ic3A7Jm5ic3A7XFxcXFxcXCIpKSB7XFxcXG4gICAgICAgICAgICBpdDIgPSBcXFxcXFxcIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwO1xcXFxcXFwiICsgaXQyLnRyaW0oKTtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBpZiAocnVsZS5yZXBsYWNlUmVnZXgpIHtcXFxcbiAgICAgICAgICAgIGl0MiA9IGl0Mi5yZXBsYWNlKG5ldyBSZWdFeHAocnVsZS5yZXBsYWNlUmVnZXgucmVwbGFjZShcXFxcXFxcIiMjXFxcXFxcXCIsIFxcXFxcXFwiXFxcXFxcXCIpLCBcXFxcXFxcImdcXFxcXFxcIiksIFxcXFxcXFwiXFxcXFxcXCIpXFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgaWYgKGl0MiA9PSBcXFxcXFxcIlxcXFxcXFwiIHx8IGl0MiA9PSBcXFxcXFxcIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwO1xcXFxcXFwiKSB7XFxcXG4gICAgICAgICAgICBjb250aW51ZVxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGQucHVzaCh7XFxcXG4gICAgICAgICAgICB0aXRsZTogaXQyLFxcXFxuICAgICAgICAgICAgdXJsOiBcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwicmljaF90ZXh0XFxcXFxcXCIsXFxcXG4gICAgICAgICAgICBkZXNjOiBcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgcGljX3VybDogXFxcXFxcXCJcXFxcXFxcIlxcXFxuICAgICAgICB9KTtcXFxcbiAgICB9XFxcXG59XFxcXG5kLnVuc2hpZnQoe1xcXFxuICAgIHRpdGxlOiBcXFxcXFxcIjxiaWc+XFxcXFxcXCIgKyBNWV9QQVJBTVMudGl0bGUgKyBcXFxcXFxcIjwvYmlnPlxcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiBcXFxcXFxcInJpY2hfdGV4dFxcXFxcXFwiXFxcXG59KVxcXFxuc2V0UmVzdWx0KGQpO1xcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJtb3ZpZV8xX3ZlcnRpY2FsX3BpY1xcXCIsXFxcIm5hbWVcXFwiOlxcXCLmkJzntKJcXFwiLFxcXCJwYXRoXFxcIjpcXFwic2VhcmNoXFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxubGV0IHtcXFxcbiAgICBzZWFyY2hcXFxcbn0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2Uvc3NcXFxcXFxcIik7XFxcXG5sZXQgZCA9IFtdO1xcXFxubGV0IGt3ID0gZ2V0UGFyYW0oXFxcXFxcXCJrd1xcXFxcXFwiKTtcXFxcbmxldCBzID0ga3c7XFxcXG5zZXRQYWdlVGl0bGUoXFxcXFxcXCLmkJzntKJcXFxcXFxcIiArIGt3ICsgXFxcXFxcXCIgXFxcXFxcXCIgKyBNWV9QQVJBTVMuYm9va1NvdXJjZU5hbWUpO1xcXFxubGV0IG1hdGNoTXVzdCA9IGdldEl0ZW0oXFxcXFxcXCJtbVxcXFxcXFwiLCBcXFxcXFxcIjBcXFxcXFxcIik7XFxcXG5sZXQgdGlwID0gXFxcXFxcXCLnsr7noa7ljLnphY3vvJpcXFxcXFxcIiArIChtYXRjaE11c3QgPT0gXFxcXFxcXCIxXFxcXFxcXCIgPyBcXFxcXFxcIuaYr1xcXFxcXFwiIDogXFxcXFxcXCLlkKZcXFxcXFxcIik7XFxcXG5pZiAoTVlfUEFHRSA9PSAxKSB7XFxcXG4gICAgZC5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6IHRpcCxcXFxcbiAgICAgICAgdXJsOiAkKFxcXFxcXFwiI25vTG9hZGluZyNcXFxcXFxcIikubGF6eVJ1bGUoKCkgPT4ge1xcXFxuICAgICAgICAgICAgc2V0SXRlbShcXFxcXFxcIm1tXFxcXFxcXCIsIGdldEl0ZW0oXFxcXFxcXCJtbVxcXFxcXFwiLCBcXFxcXFxcIjBcXFxcXFxcIikgPT0gXFxcXFxcXCIwXFxcXFxcXCIgPyBcXFxcXFxcIjFcXFxcXFxcIiA6IFxcXFxcXFwiMFxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgIHJlZnJlc2hQYWdlKCk7XFxcXG4gICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL09LXFxcXFxcXCI7XFxcXG4gICAgICAgIH0pLFxcXFxuICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJ0ZXh0XzFcXFxcXFxcIixcXFxcbiAgICB9KTtcXFxcbn1cXFxcbmxldCBkMiA9IHNlYXJjaChNWV9QQVJBTVMucnVsZXMsIGt3LCBNWV9QQUdFKTtcXFxcbmZvciAobGV0IGl0IG9mIGQyKSB7XFxcXG4gICAgaWYgKG1hdGNoTXVzdCA9PSBcXFxcXFxcIjBcXFxcXFxcIiB8fCAoaXQudGl0bGUgJiYgaXQudGl0bGUuaW5kZXhPZihrdykgPj0gMCkpIHtcXFxcbiAgICAgICAgaXQudGl0bGUgPSBpdC50aXRsZS5pbmNsdWRlcyhcXFxcXFxcIuKAnOKAnOKAneKAnVxcXFxcXFwiKSA/IGl0LnRpdGxlIDogXFxcXFxcXCLigJzigJzigJ3igJ1cXFxcXFxcIiArIGl0LnRpdGxlLnJlcGxhY2UobmV3IFJlZ0V4cChcXFxcXFxcIjxlbT58PC9lbT5cXFxcXFxcIiwgXFxcXFxcXCJnXFxcXFxcXCIpLCBcXFxcXFxcIlxcXFxcXFwiKS5yZXBsYWNlKG5ldyBSZWdFeHAocywgXFxcXFxcXCJnXFxcXFxcXCIpLCBcXFxcXFxcIjxzdHJvbmc+PHNwYW4gc3R5bGU9XFxcXFxcXFxcXFxcXFxcImNvbG9yOiAjMUU5MEZGXFxcXFxcXFxcXFxcXFxcIj5cXFxcXFxcIiArIHMgKyBcXFxcXFxcIjwvc3Bhbj48L3N0cm9uZz5cXFxcXFxcIilcXFxcbiAgICAgICAgZC5wdXNoKGl0KTtcXFxcbiAgICB9XFxcXG59XFxcXG5cXFxcbnNldFJlc3VsdChkKTtcXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwibW92aWVfM1xcXCIsXFxcIm5hbWVcXFwiOlxcXCLovazmjaJcXFwiLFxcXCJwYXRoXFxcIjpcXFwiY29udmVydGVyXFxcIixcXFwicnVsZVxcXCI6XFxcIiQuZXhwb3J0cyA9IHtcXFxcbiAgICBnZXRBcnJheTogKGh0bWwsIHJ1bGUpID0+IHtcXFxcbiAgICAgICAgbGV0IHIxID0gcnVsZS5zcGxpdChcXFxcXFxcIiFcXFxcXFxcIilbMF0uc3BsaXQoXFxcXFxcXCJ8fFxcXFxcXFwiKTtcXFxcbiAgICAgICAgbGV0IGFyciA9IHBkZmEoaHRtbCwgXFxcXFxcXCJib2R5JiZcXFxcXFxcIiArIHIxWzBdLnJlcGxhY2UoXFxcXFxcXCIgXFxcXFxcXCIsIFxcXFxcXFwiJiZcXFxcXFxcIikucmVwbGFjZShcXFxcXFxcIkBcXFxcXFxcIiwgXFxcXFxcXCImJlxcXFxcXFwiKSk7XFxcXG4gICAgICAgIGlmIChyMS5sZW5ndGggPiAxKSB7XFxcXG4gICAgICAgICAgICBsZXQgcjIgPSByMVsxXS5zcGxpdChcXFxcXFxcIjpcXFxcXFxcIik7XFxcXG4gICAgICAgICAgICBsZXQgcjMgPSBbXTtcXFxcbiAgICAgICAgICAgIGZvciAobGV0IGl0IG9mIHIyKSB7XFxcXG4gICAgICAgICAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSBwYXJzZUludChpdCk7XFxcXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihpKSkge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XFxcXG4gICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICAgICAgcjMucHVzaChpKTtcXFxcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgbGV0IGFycjIgPSBbXTtcXFxcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XFxcXG4gICAgICAgICAgICAgICAgaWYgKHIzLmluZGV4T2YoaSkgPCAwKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgIGFycjIucHVzaChhcnJbaV0pO1xcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIHJldHVybiBhcnIyO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGxvZyhcXFxcXFxcIuiOt+WPluWksei0pe+8jOWksei0peWumuS9je+8mlxcXFxcXFwiICsgcjFbMF0ucmVwbGFjZShcXFxcXFxcIiBcXFxcXFxcIiwgXFxcXFxcXCImJlxcXFxcXFwiKS5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpKVxcXFxuICAgICAgICByZXR1cm4gYXJyO1xcXFxuICAgIH0sXFxcXG4gICAgZ2V0VGV4dDogKGh0bWwsIHJ1bGUpID0+IHtcXFxcbiAgICAgICAgdmFyIHJ1ID0gcnVsZS5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpLnJlcGxhY2UoXFxcXFxcXCJ0ZXh0XFxcXFxcXCIsIFxcXFxcXFwiVGV4dFxcXFxcXFwiKS5yZXBsYWNlKC9cXFxcXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXFxcXFwiLlxcXFxcXFwiLCBcXFxcXFxcIixcXFxcXFxcIilcXFxcbiAgICAgICAgfSkuc3BsaXQoXFxcXFxcXCIjI1xcXFxcXFwiKVxcXFxuICAgICAgICBpZiAocnUubGVuZ3RoID09IDEpIHtcXFxcbiAgICAgICAgICAgIHZhciByID0gcGRmaChodG1sLCBydVswXSlcXFxcbiAgICAgICAgfSBlbHNlIHtcXFxcbiAgICAgICAgICAgIHZhciByID0gcGRmaChodG1sLCBydVswXSkucmVwbGFjZShuZXcgUmVnRXhwKHJ1WzFdLCBcXFxcXFxcImdcXFxcXFxcIiksIFxcXFxcXFwiXFxcXFxcXCIpXFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgaWYgKHIgPT0gXFxcXFxcXCJcXFxcXFxcIikge1xcXFxuICAgICAgICAgICAgbG9nKFxcXFxcXFwi6L+U5Zue5Li656m677yM5Y+v6IO95piv5a6a5L2N5aSx6LSl77yaXFxcXFxcXCIgKyBydWxlLnJlcGxhY2UoXFxcXFxcXCJAXFxcXFxcXCIsIFxcXFxcXFwiJiZcXFxcXFxcIikucmVwbGFjZShcXFxcXFxcInRleHRcXFxcXFxcIiwgXFxcXFxcXCJUZXh0XFxcXFxcXCIpLnJlcGxhY2UoL1xcXFxcXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXFxcXFwiLlxcXFxcXFwiLCBcXFxcXFxcIixcXFxcXFxcIilcXFxcbiAgICAgICAgICAgIH0pLnNwbGl0KFxcXFxcXFwiIyNcXFxcXFxcIilbMF0pXFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgcmV0dXJuIHJcXFxcbiAgICB9LFxcXFxuICAgIGdldFVybDA6IChodG1sLCBwYXJlbnRSdWxlLCBydWxlKSA9PiB7XFxcXG4gICAgICAgIGlmIChwYXJlbnRSdWxlICE9IG51bGwpIHtcXFxcbiAgICAgICAgICAgIHBhcmVudFJ1bGUgPSBwYXJlbnRSdWxlLnNwbGl0KFxcXFxcXFwiIVxcXFxcXFwiKVswXTtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBsZXQgcCA9IHBhcmVudFJ1bGUgIT0gbnVsbCAmJiBwYXJlbnRSdWxlW3BhcmVudFJ1bGUubGVuZ3RoIC0gMV0gPT0gXFxcXFxcXCJhXFxcXFxcXCIgPyBcXFxcXFxcImEmJlxcXFxcXFwiIDogXFxcXFxcXCJcXFxcXFxcIjtcXFxcbiAgICAgICAgbGV0IHIgPSBwZChodG1sLCBwICsgcnVsZS5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpLnJlcGxhY2UoXFxcXFxcXCJ0ZXh0XFxcXFxcXCIsIFxcXFxcXFwiVGV4dFxcXFxcXFwiKS5yZXBsYWNlKC9cXFxcXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXFxcXFwiLlxcXFxcXFwiLCBcXFxcXFxcIixcXFxcXFxcIik7XFxcXG4gICAgICAgIH0pLnNwbGl0KFxcXFxcXFwiIyNcXFxcXFxcIilbMF0uc3BsaXQoXFxcXFxcXCIjI1xcXFxcXFwiKVswXSk7XFxcXG4gICAgICAgIGlmIChyID09IFxcXFxcXFwiXFxcXFxcXCIpIHtcXFxcbiAgICAgICAgICAgIGxvZyhcXFxcXFxcIui/lOWbnuS4uuepuu+8jOWPr+iDveaYr+WumuS9jeWksei0pe+8mlxcXFxcXFwiICsgcCArIHJ1bGUucmVwbGFjZShcXFxcXFxcIkBcXFxcXFxcIiwgXFxcXFxcXCImJlxcXFxcXFwiKS5yZXBsYWNlKFxcXFxcXFwidGV4dFxcXFxcXFwiLCBcXFxcXFxcIlRleHRcXFxcXFxcIikucmVwbGFjZSgvXFxcXFxcXFwuWzAtOV0vZywgZnVuY3Rpb24oYSkge1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcXFxcXCIuXFxcXFxcXCIsIFxcXFxcXFwiLFxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgIH0pLnNwbGl0KFxcXFxcXFwiIyNcXFxcXFxcIilbMF0pXFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgcmV0dXJuIHJcXFxcbiAgICB9XFxcXG59XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi6IGa5pCcXFxcIixcXFwicGF0aFxcXCI6XFxcImp1XFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxudmFyIGQgPSBbXTtcXFxcbmxldCB7XFxcXG4gICAgc2VhcmNoLFxcXFxuICAgIGxpc3RSdWxlc1xcXFxufSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS9zc1xcXFxcXFwiKTtcXFxcbmxldCB7XFxcXG4gICAgYWxsLFxcXFxuICAgIHVzZSxcXFxcbiAgICBkYXRhXFxcXG59ID0gbGlzdFJ1bGVzKE1ZX1BBR0UpO1xcXFxuZGF0YSA9IGRhdGEgfHwgW107XFxcXG5sZXQgcyA9IGdldFBhcmFtKFxcXFxcXFwia3dcXFxcXFxcIik7XFxcXG5zZXRQYWdlVGl0bGUoXFxcXFxcXCLmkJzntKJcXFxcXFxcIiArIHMpO1xcXFxubGV0IG1hdGNoTXVzdCA9IGdldEl0ZW0oXFxcXFxcXCJtbVxcXFxcXFwiLCBcXFxcXFxcIjBcXFxcXFxcIik7XFxcXG5sZXQgdGlwID0gXFxcXFxcXCLmkJzntKLmupDvvJpcXFxcXFxcIiArIHVzZSArIFxcXFxcXFwiL1xcXFxcXFwiICsgYWxsICsgXFxcXFxcXCIgIOeyvuehruWMuemFje+8mlxcXFxcXFwiICsgKG1hdGNoTXVzdCA9PSBcXFxcXFxcIjFcXFxcXFxcIiA/IFxcXFxcXFwi5pivXFxcXFxcXCIgOiBcXFxcXFxcIuWQplxcXFxcXFwiKTtcXFxcbmlmIChNWV9QQUdFID09IDEpIHtcXFxcbiAgICBkLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogdGlwLFxcXFxuICAgICAgICB1cmw6ICQoXFxcXFxcXCIjbm9Mb2FkaW5nI1xcXFxcXFwiKS5sYXp5UnVsZSgoKSA9PiB7XFxcXG4gICAgICAgICAgICBzZXRJdGVtKFxcXFxcXFwibW1cXFxcXFxcIiwgZ2V0SXRlbShcXFxcXFxcIm1tXFxcXFxcXCIsIFxcXFxcXFwiMFxcXFxcXFwiKSA9PSBcXFxcXFxcIjBcXFxcXFxcIiA/IFxcXFxcXFwiMVxcXFxcXFwiIDogXFxcXFxcXCIwXFxcXFxcXCIpO1xcXFxuICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKTtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8vT0tcXFxcXFxcIjtcXFxcbiAgICAgICAgfSksXFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfMVxcXFxcXFwiLFxcXFxuICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgaWQ6IFxcXFxcXFwieXVlZHUtcy1oXFxcXFxcXCJcXFxcbiAgICAgICAgfVxcXFxuICAgIH0pO1xcXFxufSBlbHNlIGlmIChkYXRhLmxlbmd0aCA+IDApIHtcXFxcbiAgICB1cGRhdGVJdGVtKFxcXFxcXFwieXVlZHUtcy1oXFxcXFxcXCIsIHtcXFxcbiAgICAgICAgdGl0bGU6IHRpcFxcXFxuICAgIH0pO1xcXFxufVxcXFxubGV0IHAgPSBNWV9QQUdFO1xcXFxubGV0IHBhZ2VpZCA9IFxcXFxcXFwieXVlZHUtcGFnZVxcXFxcXFwiICsgTVlfUEFHRTtcXFxcbmlmIChkYXRhLmxlbmd0aCA+IDApIHtcXFxcbiAgICBkLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLliqDovb3nrKxcXFxcXFxcIiArIE1ZX1BBR0UgKyBcXFxcXFxcIumhteS4re+8jOi/m+W6pu+8mjEvXFxcXFxcXCIgKyBkYXRhLmxlbmd0aCxcXFxcbiAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIixcXFxcbiAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF9jZW50ZXJfMVxcXFxcXFwiLFxcXFxuICAgICAgICBkZXNjOiBcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICBwaWNfdXJsOiBcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgaWQ6IHBhZ2VpZFxcXFxuICAgICAgICB9XFxcXG4gICAgfSk7XFxcXG59XFxcXG5zZXRSZXN1bHQoZCk7XFxcXG5pZiAoZGF0YS5sZW5ndGggPiAwKSB7XFxcXG4gICAgLy/lpJrnur/nqIvliqDovb1cXFxcbiAgICBsZXQgdGFza3MgPSBkYXRhLm1hcChpdCA9PiB7XFxcXG4gICAgICAgIHJldHVybiB7XFxcXG4gICAgICAgICAgICBmdW5jOiBmdW5jdGlvbihydWxlKSB7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlYXJjaChydWxlLCBzLCAxKTtcXFxcbiAgICAgICAgICAgIH0sXFxcXG4gICAgICAgICAgICBwYXJhbTogaXQsXFxcXG4gICAgICAgICAgICBpZDogXFxcXFxcXCJydWxlQFxcXFxcXFwiICsgaXQubmFtZVxcXFxuICAgICAgICB9XFxcXG4gICAgfSk7XFxcXG5cXFxcbiAgICBiYXRjaEV4ZWN1dGUodGFza3MsIHtcXFxcbiAgICAgICAgZnVuYzogZnVuY3Rpb24ocGFyYW0sIGlkLCBlcnJvciwgcmVzdWx0KSB7XFxcXG4gICAgICAgICAgICAvL2xvZyhcXFxcXFxcImxpc3RlbmVyOiBcXFxcXFxcIiArIChyZXN1bHQgfHwgW10pLmxlbmd0aClcXFxcbiAgICAgICAgICAgIHBhcmFtLmkgPSBwYXJhbS5pICsgMTtcXFxcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcXFxcbiAgICAgICAgICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpdCBvZiByZXN1bHQpIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtLmogPSBwYXJhbS5qICsgMTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaE11c3QgPT0gXFxcXFxcXCIxXFxcXFxcXCIpIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWl0LnRpdGxlIHx8ICFpdC50aXRsZS5pbmNsdWRlcyhzKSkge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZXh0cmEgPSBpdC5leHRyYSB8fCB7fTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhLmlkID0gXFxcXFxcXCJfX2FwcFxcXFxcXFwiICsgTVlfUEFHRSArIFxcXFxcXFwiQFxcXFxcXFwiICsgcGFyYW0uajtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhLmJvb2tOYW1lID0gaXQudGl0bGVcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhLmNvdmVyID0gaXQucGljX3VybCB8fCBpdC5pbWdcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEl0ZW1CZWZvcmUocGFnZWlkLCB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGl0LnRpdGxlLmluY2x1ZGVzKFxcXFxcXFwi4oCc4oCc4oCd4oCdXFxcXFxcXCIpID8gaXQudGl0bGUgOiBcXFxcXFxcIuKAnOKAnOKAneKAnVxcXFxcXFwiICsgaXQudGl0bGUucmVwbGFjZShuZXcgUmVnRXhwKFxcXFxcXFwiPGVtPnw8L2VtPlxcXFxcXFwiLCBcXFxcXFxcImdcXFxcXFxcIiksIFxcXFxcXFwiXFxcXFxcXCIpLnJlcGxhY2UobmV3IFJlZ0V4cChzLCBcXFxcXFxcImdcXFxcXFxcIiksIFxcXFxcXFwiPHN0cm9uZz48c3BhbiBzdHlsZT1cXFxcXFxcXFxcXFxcXFwiY29sb3I6ICMxRTkwRkZcXFxcXFxcXFxcXFxcXFwiPlxcXFxcXFwiICsgcyArIFxcXFxcXFwiPC9zcGFuPjwvc3Ryb25nPlxcXFxcXFwiKSxcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjOiBpdC5kZXNjLFxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogaXQudXJsLFxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpY191cmw6IGl0LnBpY191cmwgfHwgaXQuaW1nLFxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbF90eXBlOiBpdC5waWNfdXJsIHx8IGl0LmltZyA/ICdtb3ZpZV8xX3ZlcnRpY2FsX3BpYycgOiBcXFxcXFxcInRleHRfMVxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhOiBleHRyYVxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcXFxcbiAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XFxcXG5cXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIGlmIChwYXJhbS5pID49IHBhcmFtLmFsbCkge1xcXFxuICAgICAgICAgICAgICAgIGRlbGV0ZUl0ZW0ocGFnZWlkKVxcXFxuICAgICAgICAgICAgfSBlbHNlIHtcXFxcbiAgICAgICAgICAgICAgICB1cGRhdGVJdGVtKHtcXFxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFxcXFxcXFwi5Yqg6L2956ysXFxcXFxcXCIgKyBNWV9QQUdFICsgXFxcXFxcXCLpobXkuK3vvIzov5vluqbvvJpcXFxcXFxcIiArIChwYXJhbS5pICsgMSkgKyBcXFxcXFxcIi9cXFxcXFxcIiArIHBhcmFtLmFsbCxcXFxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIixcXFxcbiAgICAgICAgICAgICAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF9jZW50ZXJfMVxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgICAgICBkZXNjOiBcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgICAgICBwaWNfdXJsOiBcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHBhZ2VpZFxcXFxuICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgfSlcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfSxcXFxcbiAgICAgICAgcGFyYW06IHtcXFxcbiAgICAgICAgICAgIGFsbDogZGF0YS5sZW5ndGgsXFxcXG4gICAgICAgICAgICBpOiAwLFxcXFxuICAgICAgICAgICAgajogLTFcXFxcbiAgICAgICAgfVxcXFxuICAgIH0pO1xcXFxufVxcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJtb3ZpZV8zXFxcIixcXFwibmFtZVxcXCI6XFxcIuaQnOe0oui+heWKqVxcXCIsXFxcInBhdGhcXFwiOlxcXCJzc1xcXCIsXFxcInJ1bGVcXFwiOlxcXCIkLmV4cG9ydHMgPSB7XFxcXG4gICAgc2VhcmNoOiAocnVsZSwga3csIHBhZ2UpID0+IHtcXFxcbiAgICAgICAgbGV0IGQgPSBbXTtcXFxcbiAgICAgICAgbGV0IG0gPSBydWxlLnJ1bGVTZWFyY2hcXFxcbiAgICAgICAgLy8g6ZiF6K+7PT7op4bnlYxcXFxcbiAgICAgICAgbGV0IHUgPSBydWxlLmJvb2tTb3VyY2VVcmwgKyBydWxlLnNlYXJjaFVybDtcXFxcbiAgICAgICAgbGV0IHVybCA9IHUucmVwbGFjZShcXFxcXFxcInt7cGFnZX19XFxcXFxcXCIsIHBhZ2UpLnJlcGxhY2UoXFxcXFxcXCJ7e2tleX19XFxcXFxcXCIsIGt3KVxcXFxuICAgICAgICBsZXQgbGlzdHJ1bGUgPSBcXFxcXFxcImJvZHkmJlxcXFxcXFwiICsgbS5ib29rTGlzdC5yZXBsYWNlKC8hWzAtOV0vZywgXFxcXFxcXCJcXFxcXFxcIikucmVwbGFjZShcXFxcXFxcIiBcXFxcXFxcIiwgXFxcXFxcXCImJlxcXFxcXFwiKS5zcGxpdChcXFxcXFxcInx8XFxcXFxcXCIpWzBdXFxcXG4gICAgICAgIGxldCBhdXRob3IgPSBtLmF1dGhvci5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpLnJlcGxhY2UoXFxcXFxcXCJ0ZXh0XFxcXFxcXCIsIFxcXFxcXFwiVGV4dFxcXFxcXFwiKS5yZXBsYWNlKC9cXFxcXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXFxcXFwiLlxcXFxcXFwiLCBcXFxcXFxcIixcXFxcXFxcIilcXFxcbiAgICAgICAgfSlcXFxcbiAgICAgICAgbGV0IGNvdmVyID0gbS5jb3ZlclVybC5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpLnJlcGxhY2UoL1xcXFxcXFxcLlswLTldL2csIGZ1bmN0aW9uKGEpIHtcXFxcbiAgICAgICAgICAgIHJldHVybiBhLnJlcGxhY2UoXFxcXFxcXCIuXFxcXFxcXCIsIFxcXFxcXFwiLFxcXFxcXFwiKVxcXFxuICAgICAgICB9KVxcXFxuICAgICAgICBsZXQgbmFtZSA9IG0ubmFtZS5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpLnJlcGxhY2UoXFxcXFxcXCJ0ZXh0XFxcXFxcXCIsIFxcXFxcXFwiVGV4dFxcXFxcXFwiKS5yZXBsYWNlKC9cXFxcXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXFxcXFwiLlxcXFxcXFwiLCBcXFxcXFxcIixcXFxcXFxcIilcXFxcbiAgICAgICAgfSlcXFxcbiAgICAgICAgbGV0IGJvb2t1cmwgPSBtLmJvb2tVcmwucmVwbGFjZShcXFxcXFxcIkBcXFxcXFxcIiwgXFxcXFxcXCImJlxcXFxcXFwiKS5yZXBsYWNlKC9cXFxcXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXFxcXFwiLlxcXFxcXFwiLCBcXFxcXFxcIixcXFxcXFxcIilcXFxcbiAgICAgICAgfSlcXFxcbiAgICAgICAgbGV0IGludHJvID0gbS5pbnRyby5yZXBsYWNlKFxcXFxcXFwiQFxcXFxcXFwiLCBcXFxcXFxcIiYmXFxcXFxcXCIpLnJlcGxhY2UoXFxcXFxcXCJ0ZXh0XFxcXFxcXCIsIFxcXFxcXFwiVGV4dFxcXFxcXFwiKS5yZXBsYWNlKC9cXFxcXFxcXC5bMC05XS9nLCBmdW5jdGlvbihhKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gYS5yZXBsYWNlKFxcXFxcXFwiLlxcXFxcXFwiLCBcXFxcXFxcIixcXFxcXFxcIilcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgICAgIC8vc2V0UGFnZVRpdGxlKFxcXFxcXFwi5pCc57SiXFxcXFxcXCIgKyBnZXRQYXJhbShcXFxcXFxcImt3XFxcXFxcXCIpICsgXFxcXFxcXCIgXFxcXFxcXCIgKyBNWV9QQVJBTVMuYm9va1NvdXJjZU5hbWUpO1xcXFxuICAgICAgICAvL01ZX1VSTCA9IHVybDtcXFxcbiAgICAgICAgbGV0IHJlcyA9IHJlcXVlc3QodXJsKVxcXFxuICAgICAgICBsZXQgbGlzdCA9IHBkZmEocmVzLCBsaXN0cnVsZSlcXFxcbiAgICAgICAgbGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xcXFxuICAgICAgICAgICAgZC5wdXNoKHtcXFxcbiAgICAgICAgICAgICAgICB0aXRsZTogcGFyc2VEb21Gb3JIdG1sKGl0ZW0sIG5hbWUpLFxcXFxuICAgICAgICAgICAgICAgIGltZzogcGFyc2VEb20oaXRlbSwgY292ZXIsIHVybCksXFxcXG4gICAgICAgICAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9tZW51P3VybD1cXFxcXFxcIiArIHBhcnNlRG9tKGl0ZW0sIGJvb2t1cmwsIHVybCkgKyBcXFxcXFxcIiNhdXRvQ2FjaGUjI2ltbWVyc2l2ZVRoZW1lI1xcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgIGRlc2M6IHJ1bGUuYm9va1NvdXJjZU5hbWUgKyBcXFxcXFxcIlxcXFxcXFxcblxcXFxcXFwiICsgcGFyc2VEb21Gb3JIdG1sKGl0ZW0sIGF1dGhvcikgKyBcXFxcXFxcIlxcXFxcXFxcblxcXFxcXFwiICsgcGFyc2VEb21Gb3JIdG1sKGl0ZW0sIGludHJvKSxcXFxcbiAgICAgICAgICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcIlRvY1xcXFxcXFwiOiBydWxlLnJ1bGVUb2MsXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwiY29udGVudFxcXFxcXFwiOiBydWxlLnJ1bGVDb250ZW50LFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcImJvb2tOYW1lXFxcXFxcXCI6IHBhcnNlRG9tRm9ySHRtbChpdGVtLCBuYW1lKSxcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJjb3ZlclxcXFxcXFwiOiBwYXJzZURvbShpdGVtLCBjb3ZlciwgdXJsKVxcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIH0pXFxcXG4gICAgICAgIH0pO1xcXFxuICAgICAgICByZXR1cm4gZDtcXFxcbiAgICB9LFxcXFxuICAgIGxpc3RSdWxlczogKHBhZ2UsIHJ1bGUpID0+IHtcXFxcbiAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgIC8v5bm25Y+R5pWw6YePXFxcXG4gICAgICAgICAgICBsZXQgc2l6ZSA9IDEwO1xcXFxuICAgICAgICAgICAgbGV0IGRhdGExID0gSlNPTi5wYXJzZShmZXRjaChcXFxcXFxcImhpa2VyOi8vZmlsZXMveXVlZHUvbGlzdC5qc29uXFxcXFxcXCIpKVxcXFxuICAgICAgICAgICAgbGV0IGxpc3QgPSBKU09OLnBhcnNlKGZldGNoKFxcXFxcXFwiaGlrZXI6Ly9maWxlcy95dWVkdS9cXFxcXFxcIiArIG1kNShnZXRNeVZhcihcXFxcXFxcInRhYlxcXFxcXFwiLCBkYXRhMS51cmxzWzBdLm5hbWUpKSArIFxcXFxcXFwiLmpzb25cXFxcXFxcIikpXFxcXG4gICAgICAgICAgICBsZXQgcnVsZXMgPSBbXTtcXFxcbiAgICAgICAgICAgIGxpc3QuZm9yRWFjaChpdGVtID0+IHtcXFxcbiAgICAgICAgICAgICAgICBsZXQgcyA9IEpTT04uc3RyaW5naWZ5KGl0ZW0pXFxcXG4gICAgICAgICAgICAgICAgaWYgKHMuaW5jbHVkZXMoXFxcXFxcXCI8anM+XFxcXFxcXCIpIHx8IHMuaW5jbHVkZXMoXFxcXFxcXCJAanM6XFxcXFxcXCIpIHx8IHMuaW5jbHVkZXMoXFxcXFxcXCIkLlxcXFxcXFwiKSB8fCBzLmluY2x1ZGVzKFxcXFxcXFwi8J+UnlxcXFxcXFwiKSkge1xcXFxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cXFxcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xcXFxuICAgICAgICAgICAgICAgICAgICBydWxlcy5wdXNoKGl0ZW0pO1xcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIH0pO1xcXFxuICAgICAgICAgICAgaWYgKCFwYWdlICYmICFydWxlKSB7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJ1bGVzLm1hcChpdCA9PiBpdC5uYW1lKTtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIGlmIChydWxlICE9IG51bGwpIHtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gcnVsZXMuZmlsdGVyKGkgPT4gaS5uYW1lID09IHJ1bGUpO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgbGV0IHN0YXJ0ID0gKHBhZ2UgLSAxKSAqIHNpemU7XFxcXG4gICAgICAgICAgICBpZiAocnVsZXMubGVuZ3RoIDwgc3RhcnQgKyAxKSB7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgbGV0IGxlbiA9IHNpemU7XFxcXG4gICAgICAgICAgICBpZiAocnVsZXMubGVuZ3RoIDwgcGFnZSAqIHNpemUpIHtcXFxcbiAgICAgICAgICAgICAgICBsZW4gPSBydWxlcy5sZW5ndGggLSBzdGFydFxcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgbGV0IGFsbCA9IHJ1bGVzLmxlbmd0aDtcXFxcbiAgICAgICAgICAgIGxldCB1c2UgPSAocGFnZSAtIDEpICogc2l6ZSArIGxlbjtcXFxcbiAgICAgICAgICAgIHJldHVybiB7XFxcXG4gICAgICAgICAgICAgICAgYWxsOiBhbGwsXFxcXG4gICAgICAgICAgICAgICAgdXNlOiB1c2UsXFxcXG4gICAgICAgICAgICAgICAgZGF0YTogcnVsZXMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbGVuKVxcXFxuICAgICAgICAgICAgfTtcXFxcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcXFxuICAgICAgICAgICAgcmV0dXJuIHtcXFxcbiAgICAgICAgICAgICAgICBhbGw6IDAsXFxcXG4gICAgICAgICAgICAgICAgdXNlOiAwLFxcXFxuICAgICAgICAgICAgICAgIGRhdGE6IFtdXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH1cXFxcbiAgICB9XFxcXG59XFxcIn1dXCIsXCJwcm94eVwiOlwiXCJ9IiwidGl0bGUiOiLkvaDov5jmsqHmnInkuablk6bvvZ7vvZ7ngrnmiJHov5vlhaXorr7nva4ifQ==